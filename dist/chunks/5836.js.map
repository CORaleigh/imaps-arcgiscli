{"version":3,"sources":["webpack://imaps/./node_modules/@arcgis/core/core/asyncUtils.js","webpack://imaps/./node_modules/@arcgis/core/layers/support/ElevationSampler.js","webpack://imaps/./node_modules/@arcgis/core/layers/support/ElevationTile.js","webpack://imaps/./node_modules/@arcgis/core/layers/support/ElevationQuery.js"],"names":["n","t","e","map","r","apply","then","value","o","ok","catch","error","l","c","h","spatialReference","type","z","elevationAt","f","s","hasM","hasZ","i","paths","length","x","y","a","points","u","clone","this","m","super","tile","noDataValue","extent","lodAt","level","resolution","demResolution","min","max","projectIfRequired","contains","xmin","ymin","xmax","ymax","warn","sample","p","samplers","union","Math","equals","wkid","samplerData","pixelData","values","width","height","safeWidth","dx","dy","x0","y1","d","floor","D","w","v","ignoreInvisibleLayers","filter","visible","slice","fromGeometry","returnSampleInfo","R","query","_queryAllContinue","geometry","export","sampleInfo","signal","load","_createGeometryDescriptor","_selectTiles","_populateElevationTiles","_sampleGeometryWithElevation","_createQueryResult","_createSampler","_createSamplerAllContinue","tileInfo","source","dest","_","elevationTiles","layer","options","pop","concat","coordinates","push","forEach","project","outSpatialReference","_extractSampleInfo","elevationTile","_preselectOutsideLayerExtent","_selectTilesClosestResolution","_selectTilesFinestContiguous","_selectTilesAuto","outsideExtentTile","fullExtent","_findNearestDemResolutionLODIndex","selectTilesAtLOD","lods","abs","E","minDemResolution","_selectTilesFinestContiguousAt","tilemapCache","getTilesToFetch","fetchAvailability","row","col","allElevationTilesFetched","clearElevationTiles","cache","async","uid","id","get","fetchTile","put","populateElevationTiles","_selectTilesAutoFinest","_reduceTilesForMaximumRequests","_selectTilesAutoPrefetchUpsample","fetchAvailabilityUpsample","remapTiles","forEachTileToFetch","maximumAutoTileRequests","upsampleTile","_exporter","_cloneCoordinate","spatiaReference","g","tileAt","some","candidateTiles","fetchedCandidates","Set","intersection","maskExtents","_maximumLodForRequests","_selectCandidateTilesCoveringExtentAt","size","ceil","clear","add","_uniqueNonOverlappingTiles","has","sort","updateTileInfo","_tileIsMasked","findIndex"],"mappings":"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","file":"chunks/5836.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{eachAlways as r,throwIfAbortError as t}from\"./promiseUtils.js\";function n(t,n,e){return r(t.map(((r,t)=>n.apply(e,[r,t]))))}function e(t,n,e){return r(t.map(((r,t)=>n.apply(e,[r,t])))).then((r=>r.map((r=>r.value))))}function o(r){return r.then((r=>({ok:!0,value:r}))).catch((r=>({ok:!1,error:r})))}function u(r){return r.then((r=>({ok:!0,value:r}))).catch((r=>{t(r);return{ok:!1,error:r}}))}function a(r){if(!0===r.ok)return r.value;throw r.error}export{a as assertResult,n as forEach,e as map,o as result,u as resultOrAbort};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport\"../../core/has.js\";import e from\"../../core/Logger.js\";import{canProject as t,project as n}from\"../../geometry/support/webMercatorUtils.js\";import s from\"../../geometry/Point.js\";import{extentContainsPoint as i}from\"../../geometry/support/contains.js\";import\"../../geometry.js\";import{getMetersPerUnitForSR as o}from\"../../core/unitUtils.js\";import{toExtent as r,create as a}from\"../../geometry/support/aaBoundingRect.js\";const l=e.getLogger(\"esri.layers.support.ElevationSampler\");class c{queryElevation(e){return u(e.clone(),this)}on(){return x}projectIfRequired(e,t){return h(e,t)}}class m extends c{constructor(e,t,n){super(),this.tile=e,this.noDataValue=n,this.extent=r(e.tile.extent,t.spatialReference);const s=o(t.spatialReference),i=t.lodAt(e.tile.level).resolution*s;this.demResolution={min:i,max:i}}get spatialReference(){return this.extent.spatialReference}contains(e){const t=this.projectIfRequired(e,this.spatialReference);return i(this.extent,t)}elevationAt(e){const t=this.projectIfRequired(e,this.spatialReference);if(!t)return null;if(!this.contains(e)){const t=this.extent,n=`${t.xmin}, ${t.ymin}, ${t.xmax}, ${t.ymax}`;l.warn(\"#elevationAt()\",`Point used to sample elevation (${e.x}, ${e.y}) is outside of the sampler extent (${n})`)}return this.tile.sample(t.x,t.y)}}class p extends c{constructor(e,t,n){let s;super(),\"number\"==typeof t?(this.noDataValue=t,s=null):(s=t,this.noDataValue=n),this.samplers=s?e.map((e=>new m(e,s,this.noDataValue))):e;const i=this.samplers[0];if(i){this.extent=i.extent.clone();const{min:e,max:t}=i.demResolution;this.demResolution={min:e,max:t};for(let e=1;e<this.samplers.length;e++){const t=this.samplers[e];this.extent.union(t.extent),this.demResolution.min=Math.min(this.demResolution.min,t.demResolution.min),this.demResolution.max=Math.max(this.demResolution.max,t.demResolution.max)}}else this.extent=r(a(),s.spatialReference),this.demResolution={min:0,max:0}}get spatialReference(){return this.extent.spatialReference}elevationAt(e){const t=this.projectIfRequired(e,this.spatialReference);if(!t)return null;for(const e of this.samplers)if(e.contains(t))return e.elevationAt(t);return l.warn(\"#elevationAt()\",`Point used to sample elevation (${e.x}, ${e.y}) is outside of the sampler`),null}}function u(e,t){const n=h(e,t.spatialReference);if(!n)return null;switch(e.type){case\"point\":!function(e,t,n){e.z=n.elevationAt(t)||0}(e,n,t);break;case\"polyline\":!function(e,t,n){f.spatialReference=t.spatialReference;const s=e.hasM&&!e.hasZ;for(let i=0;i<e.paths.length;i++){const o=e.paths[i],r=t.paths[i];for(let e=0;e<o.length;e++){const t=o[e],i=r[e];f.x=i[0],f.y=i[1];const a=n.elevationAt(f)||0;s&&(t[3]=t[2]),t[2]=a}}e.hasZ=!0}(e,n,t);break;case\"multipoint\":!function(e,t,n){f.spatialReference=t.spatialReference;const s=e.hasM&&!e.hasZ;for(let i=0;i<e.points.length;i++){const o=e.points[i],r=t.points[i];f.x=r[0],f.y=r[1];const a=n.elevationAt(f)||0;s&&(o[3]=o[2]),o[2]=a}e.hasZ=!0}(e,n,t)}return e}function h(e,s){const i=e.spatialReference;return i.equals(s)?e:t(i,s)?n(e,s):(l.error(`Cannot project geometry spatial reference (wkid:${i.wkid}) to elevation sampler spatial reference (wkid:${s.wkid})`),null)}const f=new s,x={remove(){}};export{c as ElevationSamplerBase,p as MultiTileElevationSampler,m as TileElevationSampler,u as updateGeometryElevation};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass t{constructor(t,a){if(this.tile=t,!a)return void(this.samplerData=null);const e=this.tile.extent;this.samplerData={pixelData:a.values,width:a.width,height:a.height,safeWidth:.99999999*(a.width-1),noDataValue:a.noDataValue,dx:(a.width-1)/(e[2]-e[0]),dy:(a.width-1)/(e[3]-e[1]),x0:e[0],y1:e[3]}}sample(t,e){if(this.samplerData)return function(t,e,i){const{safeWidth:h,width:r,pixelData:s,noDataValue:l}=t,n=a(t.dy*(t.y1-i),0,h),o=a(t.dx*(e-t.x0),0,h),d=Math.floor(n),u=Math.floor(o),f=d*r+u,p=f+r,x=s[f],D=s[p],c=s[f+1],w=s[p+1];if(x!==l&&D!==l&&c!==l&&w!==l){const t=o-u,a=x+(c-x)*t;return a+(D+(w-D)*t-a)*(n-d)}return}(this.samplerData,t,e)}}function a(t,a,e){return t<a?a:t>e?e:t}export default t;export{t as ElevationTile};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../core/maybe.js\";import t from\"../../core/Error.js\";import{whenOrAbort as i,all as o,throwIfAbortError as s,eachAlways as l}from\"../../core/promiseUtils.js\";import n from\"../../geometry/Point.js\";import a from\"../../geometry/Multipoint.js\";import r from\"../../geometry/Polyline.js\";import{result as c}from\"../../core/asyncUtils.js\";import{getMetersPerUnitForSR as u}from\"../../core/unitUtils.js\";import{fromExtent as h,create as p,contains as m}from\"../../geometry/support/aaBoundingRect.js\";import{initializeProjection as f,project as d}from\"../../geometry/projection.js\";import{MultiTileElevationSampler as y}from\"./ElevationSampler.js\";import{ElevationTile as T}from\"./ElevationTile.js\";class v{async queryAll(e,i,o){if(!(e=o&&o.ignoreInvisibleLayers?e.filter((e=>e.visible)):e.slice()).length)throw new t(\"elevation-query:invalid-layer\",\"Elevation queries require at least one elevation layer to fetch tiles from\");const s=x.fromGeometry(i);let l=!1;o&&o.returnSampleInfo||(l=!0);const n={...R,...o,returnSampleInfo:!0},a=await this.query(e[e.length-1],s,n),r=await this._queryAllContinue(e,a,n);return r.geometry=r.geometry.export(),l&&delete r.sampleInfo,r}async query(e,i,o){if(!e)throw new t(\"elevation-query:invalid-layer\",\"Elevation queries require an elevation layer to fetch tiles from\");if(!i||!(i instanceof x)&&\"point\"!==i.type&&\"multipoint\"!==i.type&&\"polyline\"!==i.type)throw new t(\"elevation-query:invalid-geometry\",\"Only point, polyline and multipoint geometries can be used to query elevation\");const s={...R,...o},l=new w(e,i.spatialReference,s),n=s.signal;return await e.load({signal:n}),await this._createGeometryDescriptor(l,i,n),await this._selectTiles(l,n),await this._populateElevationTiles(l,n),this._sampleGeometryWithElevation(l),this._createQueryResult(l,n)}async createSampler(e,i,o){if(!e)throw new t(\"elevation-query:invalid-layer\",\"Elevation queries require an elevation layer to fetch tiles from\");if(!i||\"extent\"!==i.type)throw new t(\"elevation-query:invalid-extent\",\"Invalid or undefined extent\");const s={...R,...o};return this._createSampler(e,i,s)}async createSamplerAll(e,i,o){if(!(e=o&&o.ignoreInvisibleLayers?e.filter((e=>e.visible)):e.slice()).length)throw new t(\"elevation-query:invalid-layer\",\"Elevation queries require at least one elevation layer to fetch tiles from\");if(!i||\"extent\"!==i.type)throw new t(\"elevation-query:invalid-extent\",\"Invalid or undefined extent\");const s={...R,...o,returnSampleInfo:!0},l=await this._createSampler(e[e.length-1],i,s);return this._createSamplerAllContinue(e,i,l,s)}async _createSampler(e,t,i,o){const s=i.signal;await e.load({signal:s});const l=t.spatialReference,n=e.tileInfo.spatialReference;l.equals(n)||(await f([{source:l,dest:n}],{signal:s}),t=d(t,n));const a=new _(e,t,i,o);return await this._selectTiles(a,s),await this._populateElevationTiles(a,s),new y(a.elevationTiles,a.layer.tileInfo,a.options.noDataValue)}async _createSamplerAllContinue(e,t,i,o){if(e.pop(),!e.length)return i;const s=i.samplers.map((e=>h(e.extent))),l=await this._createSampler(e[e.length-1],t,o,s);if(0===l.samplers.length)return i;const n=i.samplers.concat(l.samplers),a=new y(n,o.noDataValue);return this._createSamplerAllContinue(e,t,a,o)}async _queryAllContinue(e,t,i){const o=e.pop(),s=t.geometry.coordinates,l=[],n=[];for(let i=0;i<s.length;i++){const a=t.sampleInfo[i];a.demResolution>=0?a.source||(a.source=o):e.length&&(l.push(s[i]),n.push(i))}if(!e.length||0===l.length)return t;const a=t.geometry.clone(l),r=await this.query(e[e.length-1],a,i);return n.forEach(((e,i)=>{s[e].z=r.geometry.coordinates[i].z,t.sampleInfo[e].demResolution=r.sampleInfo[i].demResolution})),this._queryAllContinue(e,t,i)}async _createQueryResult(e,t){const i={geometry:(await e.geometry.project(e.outSpatialReference,t)).export(),noDataValue:e.options.noDataValue};return e.options.returnSampleInfo&&(i.sampleInfo=this._extractSampleInfo(e)),e.geometry.coordinates.forEach((e=>{e.tile=null,e.elevationTile=null})),i}async _createGeometryDescriptor(e,i,o){let s;const l=e.layer.tileInfo.spatialReference;if(i instanceof x?s=await i.project(l,o):(await f([{source:i.spatialReference,dest:l}],{signal:o}),s=d(i,l)),!s)throw new t(\"elevation-query:spatial-reference-mismatch\",`Cannot query elevation in '${i.spatialReference.wkid}' on an elevation service in '${l.wkid}'`);e.geometry=x.fromGeometry(s)}async _selectTiles(e,i){const o=e.options.demResolution;if(\"geometry\"===e.type&&this._preselectOutsideLayerExtent(e),\"number\"==typeof o)this._selectTilesClosestResolution(e);else if(\"finest-contiguous\"===o)await this._selectTilesFinestContiguous(e,i);else{if(\"auto\"!==o)throw new t(\"elevation-query:invalid-dem-resolution\",`Invalid dem resolution value '${o}', expected a number, \"finest-contiguous\" or \"auto\"`);await this._selectTilesAuto(e,i)}}_preselectOutsideLayerExtent(e){const t=new T(null);t.sample=()=>e.options.noDataValue,e.outsideExtentTile=t;const i=e.layer.fullExtent;e.geometry.coordinates.forEach((e=>{const o=e.x,s=e.y;(o<i.xmin||o>i.xmax||s<i.ymin||s>i.ymax)&&(e.elevationTile=t)}))}_selectTilesClosestResolution(e){const t=e.layer.tileInfo,i=this._findNearestDemResolutionLODIndex(t,e.options.demResolution);e.selectTilesAtLOD(i)}_findNearestDemResolutionLODIndex(e,t){const i=t/u(e.spatialReference);let o=e.lods[0],s=0;for(let t=1;t<e.lods.length;t++){const l=e.lods[t];Math.abs(l.resolution-i)<Math.abs(o.resolution-i)&&(o=l,s=t)}return s}async _selectTilesFinestContiguous(e,t){const i=E(e.layer.tileInfo,e.options.minDemResolution);await this._selectTilesFinestContiguousAt(e,i,t)}async _selectTilesFinestContiguousAt(e,l,n){const a=e.layer;if(e.selectTilesAtLOD(l),l<0)return;const r=a.tilemapCache,c=e.getTilesToFetch();try{if(r)await i(o(c.map((e=>r.fetchAvailability(e.level,e.row,e.col,{signal:n})))),n);else if(await this._populateElevationTiles(e,n),!e.allElevationTilesFetched())throw e.clearElevationTiles(),new t(\"elevation-query:has-unavailable-tiles\")}catch(t){s(t),await this._selectTilesFinestContiguousAt(e,l-1,n)}}async _populateElevationTiles(t,o){const s=t.getTilesToFetch(),n={},a=t.options.cache,r=t.options.noDataValue,c=s.map((async i=>{const s=`${t.layer.uid}:${i.id}:${r}`,l=e(a)?a.get(s):null,c=e(l)?l:await t.layer.fetchTile(i.level,i.row,i.col,{noDataValue:r,signal:o});e(a)&&a.put(s,c),n[i.id]=new T(i,c)}));await i(l(c),o),t.populateElevationTiles(n)}async _selectTilesAuto(e,t){this._selectTilesAutoFinest(e),this._reduceTilesForMaximumRequests(e);const l=e.layer.tilemapCache;if(!l)return this._selectTilesAutoPrefetchUpsample(e,t);const n=e.getTilesToFetch(),a={},r=n.map((async e=>{const i={id:null,level:0,row:0,col:0,extent:p()},o=await c(l.fetchAvailabilityUpsample(e.level,e.row,e.col,i,{signal:t}));!1===o.ok?s(o.error):a[e.id]=i}));await i(o(r),t),e.remapTiles(a)}_reduceTilesForMaximumRequests(e){const t=e.layer.tileInfo;let i=0;const o={},s=e=>{e.id in o?o[e.id]++:(o[e.id]=1,i++)},l=e=>{const t=o[e.id];1===t?(delete o[e.id],i--):o[e.id]=t-1};e.forEachTileToFetch(s,l);let n=!0;for(;n&&(n=!1,e.forEachTileToFetch((o=>{i<=e.options.maximumAutoTileRequests||(l(o),t.upsampleTile(o)&&(n=!0),s(o))}),l),n););}_selectTilesAutoFinest(e){const t=E(e.layer.tileInfo,e.options.minDemResolution);e.selectTilesAtLOD(t,e.options.maximumAutoTileRequests)}async _selectTilesAutoPrefetchUpsample(e,t){const i=e.layer.tileInfo;await this._populateElevationTiles(e,t);let o=!1;e.forEachTileToFetch(((e,t)=>{i.upsampleTile(e)?o=!0:t()})),o&&await this._selectTilesAutoPrefetchUpsample(e,t)}_sampleGeometryWithElevation(e){e.geometry.coordinates.forEach((t=>{const i=t.elevationTile;let o=e.options.noDataValue;if(i){const e=i.sample(t.x,t.y);void 0!==e?o=e:t.elevationTile=null}t.z=o}))}_extractSampleInfo(e){const t=e.layer.tileInfo,i=u(t.spatialReference);return e.geometry.coordinates.map((o=>{let s=-1;if(o.elevationTile&&o.elevationTile!==e.outsideExtentTile){s=t.lodAt(o.elevationTile.tile.level).resolution*i}return{demResolution:s}}))}}class x{export(){return this._exporter(this.coordinates,this.spatialReference)}clone(e){const t=new x;return t.geometry=this.geometry,t.spatialReference=this.spatialReference,t.coordinates=e||this.coordinates.map((e=>this._cloneCoordinate(e))),t._exporter=this._exporter,t}async project(e,t){if(this.spatialReference.equals(e))return this.clone();await f([{source:this.spatialReference,dest:e}],{signal:t});const i=new a({spatialReference:this.spatialReference,points:this.coordinates.map((e=>[e.x,e.y]))}),o=d(i,e);if(!o)return null;const s=this.coordinates.map(((e,t)=>{const i=this._cloneCoordinate(e),s=o.points[t];return i.x=s[0],i.y=s[1],i})),l=this.clone(s);return l.spatialReference=e,l}_cloneCoordinate(e){return{x:e.x,y:e.y,z:e.z,m:e.m,tile:null,elevationTile:null}}static fromGeometry(e){const t=new x;if(t.geometry=e,t.spatialReference=e.spatialReference,e instanceof x)t.coordinates=e.coordinates.map((e=>t._cloneCoordinate(e))),t._exporter=(t,i)=>{const o=e.clone(t);return o.spatialReference=i,o};else switch(e.type){case\"point\":{const i=e,{hasZ:o,hasM:s}=i;t.coordinates=o&&s?[{x:i.x,y:i.y,z:i.z,m:i.m}]:o?[{x:i.x,y:i.y,z:i.z}]:s?[{x:i.x,y:i.y,m:i.m}]:[{x:i.x,y:i.y}],t._exporter=(t,i)=>e.hasM?new n(t[0].x,t[0].y,t[0].z,t[0].m,i):new n(t[0].x,t[0].y,t[0].z,i);break}case\"multipoint\":{const i=e,{hasZ:o,hasM:s}=i;t.coordinates=o&&s?i.points.map((e=>({x:e[0],y:e[1],z:e[2],m:e[3]}))):o?i.points.map((e=>({x:e[0],y:e[1],z:e[2]}))):s?i.points.map((e=>({x:e[0],y:e[1],m:e[2]}))):i.points.map((e=>({x:e[0],y:e[1]}))),t._exporter=(t,i)=>e.hasM?new a({points:t.map((e=>[e.x,e.y,e.z,e.m])),hasZ:!0,hasM:!0,spatiaReference:i}):new a(t.map((e=>[e.x,e.y,e.z])),i);break}case\"polyline\":{const i=e,o=[],s=[],{hasZ:l,hasM:n}=e;let a=0;for(const e of i.paths)if(s.push([a,a+e.length]),a+=e.length,l&&n)for(const t of e)o.push({x:t[0],y:t[1],z:t[2],m:t[3]});else if(l)for(const t of e)o.push({x:t[0],y:t[1],z:t[2]});else if(n)for(const t of e)o.push({x:t[0],y:t[1],m:t[2]});else for(const t of e)o.push({x:t[0],y:t[1]});t.coordinates=o,t._exporter=(t,i)=>{const o=e.hasM?t.map((e=>[e.x,e.y,e.z,e.m])):t.map((e=>[e.x,e.y,e.z])),l=s.map((e=>o.slice(e[0],e[1])));return new r({paths:l,hasM:e.hasM,hasZ:!0,spatialReference:i})};break}}return t}}class g{constructor(e,t){this.layer=e,this.options=t}}class w extends g{constructor(e,t,i){super(e,i),this.type=\"geometry\",this.outSpatialReference=t}selectTilesAtLOD(e){if(e<0)this.geometry.coordinates.forEach((e=>e.tile=null));else{const t=this.layer.tileInfo,i=t.lods[e].level;this.geometry.coordinates.forEach((e=>{e.tile=t.tileAt(i,e.x,e.y)}))}}allElevationTilesFetched(){return!this.geometry.coordinates.some((e=>!e.elevationTile))}clearElevationTiles(){for(const e of this.geometry.coordinates)e.elevationTile!==this.outsideExtentTile&&(e.elevationTile=null)}populateElevationTiles(e){for(const t of this.geometry.coordinates)!t.elevationTile&&t.tile&&(t.elevationTile=e[t.tile.id])}remapTiles(e){for(const t of this.geometry.coordinates)t.tile=e[t.tile.id]}getTilesToFetch(){const e={},t=[];for(const i of this.geometry.coordinates){const o=i.tile;i.elevationTile||!i.tile||e[o.id]||(e[o.id]=o,t.push(o))}return t}forEachTileToFetch(e){for(const t of this.geometry.coordinates)t.tile&&!t.elevationTile&&e(t.tile,(()=>t.tile=null))}}class _ extends g{constructor(e,t,i,o){super(e,i),this.type=\"extent\",this.elevationTiles=[],this.candidateTiles=[],this.fetchedCandidates=new Set,this.extent=t.intersection(e.fullExtent),this.maskExtents=o}selectTilesAtLOD(e,t){const i=this._maximumLodForRequests(t),o=Math.min(i,e);o<0?this.candidateTiles.length=0:this._selectCandidateTilesCoveringExtentAt(o)}_maximumLodForRequests(e){const t=this.layer.tileInfo;if(!e)return t.lods.length-1;const i=this.extent;for(let o=t.lods.length-1;o>=0;o--){const s=t.lods[o],l=s.resolution*t.size[0],n=s.resolution*t.size[1];if(Math.ceil(i.width/l)*Math.ceil(i.height/n)<=e)return o}return-1}allElevationTilesFetched(){return this.candidateTiles.length===this.elevationTiles.length}clearElevationTiles(){this.elevationTiles.length=0,this.fetchedCandidates.clear()}populateElevationTiles(e){for(const t of this.candidateTiles){const i=e[t.id];i&&(this.fetchedCandidates.add(t),this.elevationTiles.push(i))}}remapTiles(e){this.candidateTiles=this._uniqueNonOverlappingTiles(this.candidateTiles.map((t=>e[t.id])))}getTilesToFetch(){return this.candidateTiles}forEachTileToFetch(e,t){const i=this.candidateTiles;this.candidateTiles=[],i.forEach((i=>{if(this.fetchedCandidates.has(i))return void(t&&t(i));let o=!1;e(i,(()=>o=!0)),o?t&&t(i):this.candidateTiles.push(i)})),this.candidateTiles=this._uniqueNonOverlappingTiles(this.candidateTiles,t)}_uniqueNonOverlappingTiles(e,t){const i={},o=[];for(const s of e)i[s.id]?t&&t(s):(i[s.id]=s,o.push(s));const s=o.sort(((e,t)=>e.level-t.level));return s.filter(((e,i)=>{for(let o=0;o<i;o++)if(m(s[o].extent,e.extent))return t&&t(e),!1;return!0}))}_selectCandidateTilesCoveringExtentAt(e){this.candidateTiles.length=0;const t=this.layer.tileInfo,i=t.lods[e],o=this.extent,s=t.tileAt(i.level,o.xmin,o.ymin),l=i.resolution*t.size[0],n=i.resolution*t.size[1],a=Math.ceil((o.xmax-s.extent[0])/l),r=Math.ceil((o.ymax-s.extent[1])/n);for(let e=0;e<r;e++)for(let i=0;i<a;i++){const o={id:null,level:s.level,row:s.row-e,col:s.col+i};t.updateTileInfo(o),this._tileIsMasked(o)||this.candidateTiles.push(o)}}_tileIsMasked(e){return!!this.maskExtents&&this.maskExtents.some((t=>m(t,e.extent)))}}function E(e,t){let i=e.lods.length-1;if(t>0){const o=e.lods.findIndex((e=>e.resolution<t));0===o?i=0:o>0&&(i=o-1)}return i}const R={maximumAutoTileRequests:20,noDataValue:0,returnSampleInfo:!1,demResolution:\"auto\",minDemResolution:0};export default v;export{v as ElevationQuery,x as GeometryDescriptor,E as getFinestLodIndex};\n"],"sourceRoot":""}