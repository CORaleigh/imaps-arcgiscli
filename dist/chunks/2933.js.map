{"version":3,"sources":["webpack://imaps/./node_modules/@arcgis/core/layers/MapImageLayer.js","webpack://imaps/./node_modules/@arcgis/core/layers/mixins/TemporalLayer.js","webpack://imaps/./node_modules/@arcgis/core/layers/support/TimeReference.js","webpack://imaps/./node_modules/@arcgis/core/layers/support/TimeInfo.js"],"names":["U","e","super","this","alwaysRefetch","dpi","gdbVersion","imageFormat","imageMaxHeight","imageMaxWidth","imageTransparency","labelsVisible","isReference","operationalLayerType","sourceJSON","sublayers","type","url","r","t","signal","addResolvingPromise","loadFromPortal","supportedTypes","then","_fetchService","supportedImageFormatTypes","indexOf","s","loaded","o","slice","reverse","flatten","toArray","i","capabilities","operations","supportsExportMap","exportMap","supportsDynamicLayers","origin","createSublayersForOrigin","a","p","writeSublayerStructure","n","forEach","write","push","originOf","some","Object","keys","length","layers","visibleLayers","filter","visible","map","id","pixelRatio","version","clone","shiftCentralMeridian","layer","scale","extent","width","toJSON","destroy","rotation","m","spatialReference","wkid","JSON","stringify","l","timeExtent","start","end","time","timeInfo","hasLiveData","bbox","xmin","ymin","xmax","ymax","bboxSR","imageSR","size","responseType","timestamp","query","_ts","customParameters","parsedUrl","path","createExportImageParameters","f","Date","now","dynamicLayers","data","catch","error","returnUpdates","fullExtent","allSublayers","read","ssl","replace","prototype","json","origins","service","source","Boolean","enabled","overridePolicy","ignoreOrigin","readOnly","value","u","arguments","timeOffset","useViewTime","exportOptions","timeOffsetUnits","unit","fields","_set","target","respectsDaylightSaving","timezone","respectDaylightSaving","String","d","cumulative","endField","fullTimeExtent","interval","startField","timeReference","trackIdField","useTime","Array","isArray","getTime","timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits","allowNull"],"mappings":"ihBAIu7D,IAAIA,EAAE,eAAc,QAAE,QAAE,QAAE,QAAE,QAAE,QAAE,QAAE,QAAE,QAAE,QAAE,QAAE,OAAE,iBAAe,eAAeC,GAAGC,SAASD,GAAGE,KAAKC,eAAc,EAAGD,KAAKE,IAAI,GAAGF,KAAKG,WAAW,KAAKH,KAAKI,YAAY,QAAQJ,KAAKK,eAAe,KAAKL,KAAKM,cAAc,KAAKN,KAAKO,mBAAkB,EAAGP,KAAKQ,eAAc,EAAGR,KAAKS,YAAY,KAAKT,KAAKU,qBAAqB,wBAAwBV,KAAKW,WAAW,KAAKX,KAAKY,UAAU,KAAKZ,KAAKa,KAAK,YAAYb,KAAKc,IAAI,KAAK,kBAAkBhB,EAAEiB,GAAG,MAAM,iBAAiBjB,EAAE,CAACgB,IAAIhB,KAAKiB,GAAGjB,EAAE,KAAKA,GAAG,MAAMkB,GAAE,QAAElB,GAAGA,EAAEmB,OAAO,KAAK,OAAOjB,KAAKkB,oBAAoBlB,KAAKmB,eAAe,CAACC,eAAe,CAAC,gBAAgBtB,GAAGuB,MAAK,IAAKrB,KAAKsB,cAAcN,KAAI,IAAKhB,KAAKsB,cAAcN,OAAM,aAAEhB,MAAM,gBAAgBF,EAAEiB,GAAG,MAAMC,EAAED,EAAEQ,0BAA0B,OAAOP,GAAGA,EAAEQ,QAAQ,UAAU,EAAE,QAAQ,QAAQ,eAAe1B,EAAEiB,EAAEC,EAAES,GAAG,IAAIzB,KAAK0B,SAAS5B,EAAE,OAAO,MAAM6B,EAAE7B,EAAE8B,QAAQC,UAAUC,SAAQ,EAAGlB,UAAUd,KAAKA,GAAGA,EAAEiC,UAAUF,YAAYE,UAAU,IAAIC,GAAE,EAAG,GAAGhC,KAAKiC,cAAcjC,KAAKiC,aAAaC,WAAWC,mBAAmBnC,KAAKiC,aAAaG,UAAUC,sBAAsB,CAAC,MAAMvC,GAAE,QAAE2B,EAAEa,QAAQ,GAAG,IAAIxC,EAAE,CAAC,MAAMA,EAAEE,KAAKuC,yBAAyB,WAAW3B,UAAUoB,GAAE,QAAEL,EAAE7B,EAAE,QAAQ,GAAGA,EAAE,EAAE,CAAC,MAAMA,EAAEE,KAAKuC,yBAAyB,eAAeP,GAAE,QAAEL,EAAE7B,EAAEc,WAAU,QAAEd,EAAEwC,UAAU,MAAME,EAAE,GAAGC,EAAE,CAACC,uBAAuBV,KAAKP,GAAG,IAAIkB,EAAEX,EAAEL,EAAEiB,SAAS9C,IAAI,MAAMiB,EAAEjB,EAAE+C,MAAM,GAAGJ,GAAGD,EAAEM,KAAK/B,GAAG4B,EAAEA,GAAG,SAAS7C,EAAEiD,SAAS,cAAcP,EAAEQ,MAAMlD,GAAGmD,OAAOC,KAAKpD,GAAGqD,OAAO,MAAMpC,EAAEqC,OAAOZ,GAAGG,IAAI5B,EAAEsC,cAAc1B,EAAE2B,QAAQxD,GAAGA,EAAEyD,UAAUC,KAAK1D,GAAGA,EAAE2D,MAAM,4BAA4B3D,EAAEiB,EAAEC,EAAES,GAAG,MAAME,EAAEF,GAAGA,EAAEiC,YAAY,EAAE5D,GAAGE,KAAK2D,SAAS,KAAK7D,EAAEA,EAAE8D,QAAQC,wBAAwB,MAAM7B,EAAE,IAAI,IAAE,CAAC8B,MAAM9D,KAAK+D,OAAM,QAAE,CAACC,OAAOlE,EAAEmE,MAAMlD,IAAIY,IAAIa,EAAER,EAAEkC,SAASlC,EAAEmC,UAAU,MAAM1B,GAAGhB,IAAIA,EAAE2C,UAAUpE,KAAK2D,QAAQ,KAAK,GAAG,CAACS,UAAU3C,EAAE2C,UAAUC,EAAEvE,GAAGA,EAAEwE,iBAAiB3B,EAAE0B,EAAEE,MAAMC,KAAKC,UAAUJ,EAAEH,UAAU1B,EAAEtC,KAAKyB,EAAE,MAAM+C,EAAE,GAAG,GAAG,MAAMjD,GAAGA,EAAEkD,WAAW,CAAC,MAAMC,MAAM9E,EAAE+E,IAAI9D,GAAGU,EAAEkD,WAAWT,SAASQ,EAAEI,KAAKhF,GAAGiB,GAAGjB,IAAIiB,EAAE,GAAGjB,EAAE,GAAG,MAAMA,EAAE,OAAOA,KAAK,MAAMiB,EAAE,OAAOA,SAASf,KAAK+E,WAAW/E,KAAK+E,SAASC,cAAcN,EAAEI,KAAK,aAAa,MAAM,CAACG,KAAKnF,GAAGA,EAAEoF,KAAK,IAAIpF,EAAEqF,KAAK,IAAIrF,EAAEsF,KAAK,IAAItF,EAAEuF,KAAKC,OAAO3C,EAAE4C,QAAQ5C,EAAE6C,KAAKzE,EAAE,IAAIC,KAAKwB,KAAKC,KAAKiC,GAAG,iBAAiB5E,EAAEiB,EAAEC,EAAES,GAAG,MAAME,EAAE,CAAC8D,aAAa,SAAShE,GAAGA,EAAEiE,YAAY/D,EAAEgE,MAAM,IAAIhE,EAAEgE,MAAMC,IAAInE,EAAEiE,YAAYjE,GAAGA,EAAER,SAASU,EAAEV,OAAOQ,EAAER,QAAQjB,KAAK6F,kBAAkB5C,OAAOC,KAAKlD,KAAK6F,kBAAkB1C,SAASxB,EAAEgE,MAAM,IAAI3F,KAAK6F,oBAAoBlE,EAAEgE,QAAQ,MAAM3D,EAAEhC,KAAK8F,UAAUC,KAAK,UAAUvD,EAAE,IAAIxC,KAAK8F,UAAUH,SAAS3F,KAAKgG,4BAA4BlG,EAAEiB,EAAEC,EAAES,GAAGwE,EAAE,QAAQL,IAAI5F,KAAKC,cAAciG,KAAKC,MAAM,MAAM,OAAG,MAAM3D,EAAE4D,eAAgBpG,KAAKiC,aAAaG,UAAUC,uBAA8OV,EAAEgE,MAAMhE,EAAEgE,MAAM,IAAInD,KAAKb,EAAEgE,OAAOhE,EAAEgE,MAAMnD,GAAS,aAAER,EAAEL,GAAGN,MAAMvB,GAAGA,EAAEuG,OAAOC,OAAOxG,IAAI,IAAG,kBAAEA,GAAG,MAAMA,EAAE,MAAM,IAAI,IAAE,kCAAkC,yBAAyBkC,IAAI,CAACuE,MAAMzG,SAA1Y,YAAE,IAAI,IAAE,2CAA2C,WAAWE,KAAKc,kIAAkI,CAAC6E,MAAMnD,KAAqM,6BAA6B1C,EAAE,IAAI,MAAMiB,EAAE,IAAIjB,EAAE6F,MAAM,CAACa,eAAc,EAAGP,EAAE,UAAUI,KAAKrF,SAAS,aAAEhB,KAAKc,IAAIC,IAAIiD,OAAOvC,EAAEgF,WAAW9E,EAAEgD,WAAW3C,GAAGhB,EAAEwB,EAAEf,GAAGE,EAAE,MAAM,CAAC8E,WAAWjE,GAAG,aAAWA,GAAGmC,WAAW3C,GAAG,aAAW,CAAC4C,MAAM5C,EAAE,GAAG6C,IAAI7C,EAAE,MAAM,UAAU,OAAO,QAAEhC,MAAMF,IAAIA,EAAEE,KAAK0G,iBAAiB,oBAAoB5G,GAAG,GAAGE,KAAKW,WAAW,YAAYX,KAAK2G,KAAK3G,KAAKW,WAAW,CAAC2B,OAAO,UAAUxB,IAAId,KAAK8F,YAAY,MAAMO,KAAKtF,EAAE6F,IAAI5F,SAAS,aAAEhB,KAAK8F,UAAUC,KAAK,CAACJ,MAAM,CAACM,EAAE,UAAUjG,KAAK8F,UAAUH,SAAS3F,KAAK6F,kBAAkB5E,OAAOnB,IAAIkB,IAAIhB,KAAKc,IAAId,KAAKc,IAAI+F,QAAQ,UAAU,WAAW7G,KAAKW,WAAWI,EAAEf,KAAK2G,KAAK5F,EAAE,CAACuB,OAAO,UAAUxB,IAAId,KAAK8F,eAAc,OAAE,EAAC,WAAKjG,EAAEiH,UAAU,qBAAgB,IAAQ,OAAE,EAAC,WAAKjH,EAAEiH,UAAU,WAAM,IAAQ,OAAE,EAAC,WAAKjH,EAAEiH,UAAU,kBAAa,IAAQ,OAAE,EAAC,QAAE,CAACC,KAAK,CAACJ,MAAK,EAAG9D,OAAM,MAAOhD,EAAEiH,UAAU,oBAAe,IAAQ,OAAE,EAAC,WAAKjH,EAAEiH,UAAU,mBAAc,IAAQ,OAAE,EAAC,OAAE,cAAc,CAAC,+BAA+BjH,EAAEiH,UAAU,kBAAkB,OAAM,OAAE,EAAC,QAAE,CAACC,KAAK,CAACC,QAAQ,CAACC,QAAQ,CAACN,KAAK,CAACO,OAAO,wBAAwBrH,EAAEiH,UAAU,sBAAiB,IAAQ,OAAE,EAAC,QAAE,CAACC,KAAK,CAACC,QAAQ,CAACC,QAAQ,CAACN,KAAK,CAACO,OAAO,uBAAuBrH,EAAEiH,UAAU,qBAAgB,IAAQ,OAAE,EAAC,WAAKjH,EAAEiH,UAAU,yBAAoB,IAAQ,OAAE,EAAC,QAAE,CAACC,KAAK,CAACJ,MAAK,EAAG9D,OAAM,MAAOhD,EAAEiH,UAAU,qBAAgB,IAAQ,OAAE,EAAC,QAAE,CAACjG,KAAKsG,QAAQJ,KAAK,CAACJ,MAAK,EAAG9D,MAAM,CAACuE,SAAQ,EAAGC,eAAe,KAAI,CAAED,SAAQ,SAAUvH,EAAEiH,UAAU,mBAAc,IAAQ,OAAE,EAAC,QAAE,CAACjG,KAAK,CAAC,4BAA4BhB,EAAEiH,UAAU,4BAAuB,IAAQ,OAAE,EAAC,WAAKjH,EAAEiH,UAAU,kBAAa,IAAQ,OAAE,EAAC,QAAE,CAACC,KAAK,CAAClE,MAAM,CAACyE,cAAa,OAAQzH,EAAEiH,UAAU,iBAAY,IAAQ,OAAE,EAAC,OAAE,YAAY,CAAC1D,OAAO,CAACvC,KAAK,CAAC,MAAIwC,cAAc,CAACxC,KAAK,CAAC,UAAOhB,EAAEiH,UAAU,iBAAiB,OAAM,OAAE,EAAC,QAAE,CAACjG,KAAK,CAAC,OAAO,OAAO,oBAAoBhB,EAAEiH,UAAU,gBAAW,IAAQ,OAAE,EAAC,QAAE,CAACC,KAAK,CAACJ,MAAK,GAAIY,UAAS,EAAGC,MAAM,eAAe3H,EAAEiH,UAAU,YAAO,IAAQ,OAAE,EAAC,QAAE,OAAIjH,EAAEiH,UAAU,WAAM,GAAQjH,GAAE,OAAE,EAAC,OAAE,8BAA8BA,GAAW,QAAFA,G,6MCA5lM,MAAMoG,EAAEwB,IAAI,IAAIxB,EAAE,cAAcwB,EAAE,cAAc1H,SAAS2H,WAAW1H,KAAK2E,WAAW,KAAK3E,KAAK2H,WAAW,KAAK3H,KAAK4H,aAAY,EAAG,WAAW9H,EAAEkB,GAAG,MAAMW,EAAEX,EAAE+D,SAAS8C,cAAc,IAAIlG,EAAE,OAAO,KAAK,MAAMZ,EAAEY,EAAEgG,WAAWlG,EAAE,cAAWE,EAAEmG,iBAAiB,OAAO/G,GAAGU,EAAE,IAAI,IAAE,CAAC+F,MAAMzG,EAAEgH,KAAKtG,IAAI,KAAK,aAAa3B,IAAG,QAAEA,EAAEE,KAAKgI,QAAQhI,KAAKiI,KAAK,WAAWnI,KAAK,OAAO,OAAE,EAAC,QAAE,CAACe,KAAK,IAAEkG,KAAK,CAAClE,OAAM,MAAOoD,EAAEa,UAAU,kBAAa,IAAQ,OAAE,EAAC,QAAE,CAACjG,KAAK,OAAKoF,EAAEa,UAAU,kBAAa,IAAQ,OAAE,EAAC,OAAE,UAAU,aAAa,CAAC,4BAA4Bb,EAAEa,UAAU,aAAa,OAAM,OAAE,EAAC,QAAE,CAACU,MAAM,KAAK3G,KAAK,IAAEkG,KAAK,CAAClE,OAAM,EAAGmE,QAAQ,CAAC,eAAe,CAACL,MAAK,EAAG9D,OAAM,QAASoD,EAAEa,UAAU,WAAW,OAAM,OAAE,EAAC,QAAE,CAACjG,KAAKsG,QAAQJ,KAAK,CAACJ,KAAK,CAACO,OAAO,iBAAiBrE,MAAM,CAACqF,OAAO,iBAAiBlB,QAAQ,CAAC,YAAY,CAACL,MAAK,EAAG9D,OAAM,QAASoD,EAAEa,UAAU,mBAAc,GAAQb,GAAE,OAAE,EAAC,OAAE,qCAAqCA,GAAGA,I,kDCAjlCjE,E,0KAAE,IAAIS,EAAET,EAAE,cAAc,KAAE,YAAYlC,GAAGC,MAAMD,GAAGE,KAAKmI,wBAAuB,EAAGnI,KAAKoI,SAAS,KAAK,2BAA2BtI,EAAEiB,GAAG,YAAO,IAASA,EAAEoH,uBAAuBpH,EAAEoH,4BAAuB,IAASpH,EAAEsH,uBAAuBtH,EAAEsH,sBAAsB,QAAQ,MAAMF,uBAAuBrI,EAAEsI,SAASrH,GAAGf,KAAK,OAAO,IAAIgC,EAAE,CAACmG,uBAAuBrI,EAAEsI,SAASrH,OAAM,OAAE,EAAC,QAAE,CAACF,KAAKsG,QAAQJ,KAAK,CAAClE,OAAM,MAAOJ,EAAEqE,UAAU,8BAAyB,IAAQ,OAAE,EAAC,OAAE,yBAAyB,CAAC,yBAAyB,2BAA2BrE,EAAEqE,UAAU,6BAA6B,OAAM,OAAE,EAAC,QAAE,CAACjG,KAAKyH,OAAOvB,KAAK,CAACJ,KAAK,CAACO,OAAO,YAAYrE,MAAM,CAACqF,OAAO,gBAAgBzF,EAAEqE,UAAU,gBAAW,GAAQrE,EAAET,GAAE,OAAE,EAAC,OAAE,sCAAsCS,GAAW,QAAFA,ECAtd,IAAI,EAAE,IAAI8F,EAAE,EAAE,cAAc,KAAE,YAAYzI,GAAGC,MAAMD,GAAGE,KAAKwI,YAAW,EAAGxI,KAAKyI,SAAS,KAAKzI,KAAK0I,eAAe,KAAK1I,KAAKgF,aAAY,EAAGhF,KAAK2I,SAAS,KAAK3I,KAAK4I,WAAW,KAAK5I,KAAK6I,cAAc,KAAK7I,KAAK8I,aAAa,KAAK9I,KAAK+I,SAAQ,EAAG,mBAAmBjJ,EAAEkB,GAAG,IAAIA,EAAE2D,aAAaqE,MAAMC,QAAQjI,EAAE2D,aAAa,IAAI3D,EAAE2D,WAAWxB,OAAO,OAAO,KAAK,MAAMpC,EAAE,IAAImF,KAAKlF,EAAE2D,WAAW,IAAI3C,EAAE,IAAIkE,KAAKlF,EAAE2D,WAAW,IAAI,OAAO,IAAI,IAAE,CAACC,MAAM7D,EAAE8D,IAAI7C,IAAI,oBAAoBlC,EAAEkB,GAAGlB,GAAGA,EAAE8E,OAAO9E,EAAE+E,IAAI7D,EAAE2D,WAAW,CAAC7E,EAAE8E,MAAMsE,UAAUpJ,EAAE+E,IAAIqE,WAAWlI,EAAE2D,WAAW,KAAK,aAAa7E,EAAEkB,GAAG,OAAOA,EAAEmI,cAAcnI,EAAEoI,kBAAkB,IAAI,IAAE,CAAC5B,MAAMxG,EAAEmI,aAAapB,KAAK,cAAW/G,EAAEoI,qBAAqBpI,EAAEqI,qBAAqBrI,EAAEsI,yBAAyB,IAAI,IAAE,CAAC9B,MAAMxG,EAAEqI,oBAAoBtB,KAAK,cAAW/G,EAAEsI,4BAA4B,KAAK,cAAcxJ,EAAEkB,GAAG,GAAGlB,EAAE,CAAC,MAAMiB,EAAEjB,EAAEoE,SAASlD,EAAEmI,aAAapI,EAAEyG,MAAMxG,EAAEoI,kBAAkBrI,EAAEgH,UAAU/G,EAAEmI,aAAa,KAAKnI,EAAEoI,kBAAkB,KAAK,QAAQ,MAAMZ,WAAW1I,EAAE2I,SAAS1H,EAAEiE,YAAYhD,EAAE2G,SAASjE,EAAEkE,WAAWjH,EAAEkH,cAAclG,EAAE+F,eAAelG,EAAEsG,aAAarH,EAAEsH,QAAQ1E,GAAGrE,KAAK,OAAO,IAAI,EAAE,CAACwI,WAAW1I,EAAE2I,SAAS1H,EAAEiE,YAAYhD,EAAE2G,SAASjE,EAAEkE,WAAWjH,EAAEkH,eAAc,QAAElG,GAAG+F,gBAAe,QAAElG,GAAGsG,aAAarH,EAAEsH,QAAQ1E,OAAM,OAAE,EAAC,QAAE,CAACxD,KAAKsG,QAAQJ,KAAK,CAACJ,KAAK,CAACO,OAAO,oCAAoCrE,MAAM,CAACqF,OAAO,wCAAwCK,EAAEzB,UAAU,kBAAa,IAAQ,OAAE,EAAC,QAAE,CAACjG,KAAKyH,OAAOvB,KAAK,CAACJ,KAAK,CAACO,OAAO,gBAAgBrE,MAAM,CAACqF,OAAO,eAAeqB,WAAU,OAAQhB,EAAEzB,UAAU,gBAAW,IAAQ,OAAE,EAAC,QAAE,CAACjG,KAAK,IAAEkG,KAAK,CAAClE,MAAM,CAACuE,SAAQ,EAAGmC,WAAU,OAAQhB,EAAEzB,UAAU,sBAAiB,IAAQ,OAAE,EAAC,OAAE,iBAAiB,CAAC,gBAAgByB,EAAEzB,UAAU,qBAAqB,OAAM,OAAE,EAAC,OAAE,mBAAmByB,EAAEzB,UAAU,sBAAsB,OAAM,OAAE,EAAC,QAAE,CAACjG,KAAKsG,QAAQJ,KAAK,CAAClE,OAAM,MAAO0F,EAAEzB,UAAU,mBAAc,IAAQ,OAAE,EAAC,QAAE,CAACjG,KAAK,IAAEkG,KAAK,CAAClE,MAAM,CAACuE,SAAQ,EAAGmC,WAAU,OAAQhB,EAAEzB,UAAU,gBAAW,IAAQ,OAAE,EAAC,OAAE,WAAW,CAAC,eAAe,oBAAoB,sBAAsB,8BAA8ByB,EAAEzB,UAAU,eAAe,OAAM,OAAE,EAAC,OAAE,aAAayB,EAAEzB,UAAU,gBAAgB,OAAM,OAAE,EAAC,QAAE,CAACjG,KAAKyH,OAAOvB,KAAK,CAACJ,KAAK,CAACO,OAAO,kBAAkBrE,MAAM,CAACqF,OAAO,iBAAiBqB,WAAU,OAAQhB,EAAEzB,UAAU,kBAAa,IAAQ,OAAE,EAAC,QAAE,CAACjG,KAAK,EAAEkG,KAAK,CAAClE,MAAM,CAACuE,SAAQ,EAAGmC,WAAU,OAAQhB,EAAEzB,UAAU,qBAAgB,IAAQ,OAAE,EAAC,QAAE,CAACjG,KAAKyH,OAAOvB,KAAK,CAAClE,MAAM,CAACuE,SAAQ,EAAGmC,WAAU,OAAQhB,EAAEzB,UAAU,oBAAe,IAAQ,OAAE,EAAC,QAAE,CAACjG,KAAKsG,QAAQJ,KAAK,CAACJ,KAAK,CAACO,OAAO,yBAAyBrE,MAAM,CAACqF,OAAO,6BAA6BK,EAAEzB,UAAU,eAAU,GAAQyB,EAAE,GAAE,OAAE,EAAC,OAAE,iCAAiCA,GAAW,QAAFA","file":"chunks/2933.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import{isSome as r}from\"../core/maybe.js\";import\"../core/Logger.js\";import{Integer as t}from\"../core/accessorSupport/ensureType.js\";import{property as s}from\"../core/accessorSupport/decorators/property.js\";import{reader as o}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as i}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as a}from\"../core/accessorSupport/decorators/writer.js\";import p from\"../core/Error.js\";import\"../core/urlUtils.js\";import\"../core/uuid.js\";import{nameToId as m}from\"../core/accessorSupport/PropertyOrigin.js\";import\"../portal/support/resourceExtension.js\";import{resolve as n,reject as l,isAbortError as c}from\"../core/promiseUtils.js\";import u from\"../geometry/Extent.js\";import y from\"../request.js\";import{loadAll as h}from\"../core/loadAll.js\";import d from\"./Layer.js\";import f from\"../TimeExtent.js\";import{MultiOriginJSONMixin as g}from\"../core/MultiOriginJSONSupport.js\";import{url as j}from\"./support/commonProperties.js\";import{OperationalLayer as b}from\"./mixins/OperationalLayer.js\";import{ArcGISService as x}from\"./mixins/ArcGISService.js\";import{BlendLayer as v}from\"./mixins/BlendLayer.js\";import{CustomParametersMixin as S}from\"./mixins/CustomParametersMixin.js\";import{PortalLayer as w}from\"./mixins/PortalLayer.js\";import{RefreshableLayer as O}from\"./mixins/RefreshableLayer.js\";import{ScaleRangeLayer as L}from\"./mixins/ScaleRangeLayer.js\";import{TemporalLayer as E}from\"./mixins/TemporalLayer.js\";import{HandleOwnerMixin as I}from\"../core/HandleOwner.js\";import{getScale as M}from\"../geometry/support/scaleUtils.js\";import{ArcGISMapService as q}from\"./mixins/ArcGISMapService.js\";import P from\"./support/Sublayer.js\";import{shouldWriteSublayerStructure as N}from\"./support/sublayerUtils.js\";import{SublayersOwner as R}from\"./mixins/SublayersOwner.js\";import{ExportImageParameters as J}from\"./support/ExportImageParameters.js\";let U=class extends(v(E(L(O(R(q(x(b(w(g(S(I(d))))))))))))){constructor(...e){super(...e),this.alwaysRefetch=!1,this.dpi=96,this.gdbVersion=null,this.imageFormat=\"png24\",this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.labelsVisible=!1,this.isReference=null,this.operationalLayerType=\"ArcGISMapServiceLayer\",this.sourceJSON=null,this.sublayers=null,this.type=\"map-image\",this.url=null}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}load(e){const t=r(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Map Service\"]},e).then((()=>this._fetchService(t)),(()=>this._fetchService(t)))),n(this)}readImageFormat(e,r){const t=r.supportedImageFormatTypes;return t&&t.indexOf(\"PNG32\")>-1?\"png32\":\"png24\"}writeSublayers(e,r,t,s){if(!this.loaded||!e)return;const o=e.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).toArray();let i=!1;if(this.capabilities&&this.capabilities.operations.supportsExportMap&&this.capabilities.exportMap.supportsDynamicLayers){const e=m(s.origin);if(3===e){const e=this.createSublayersForOrigin(\"service\").sublayers;i=N(o,e,2)}else if(e>3){const e=this.createSublayersForOrigin(\"portal-item\");i=N(o,e.sublayers,m(e.origin))}}const a=[],p={writeSublayerStructure:i,...s};let n=i;o.forEach((e=>{const r=e.write({},p);a.push(r),n=n||\"user\"===e.originOf(\"visible\")}));a.some((e=>Object.keys(e).length>1))&&(r.layers=a),n&&(r.visibleLayers=o.filter((e=>e.visible)).map((e=>e.id)))}createExportImageParameters(e,r,t,s){const o=s&&s.pixelRatio||1;e&&this.version>=10&&(e=e.clone().shiftCentralMeridian());const i=new J({layer:this,scale:M({extent:e,width:r})*o}),a=i.toJSON();i.destroy();const p=!s||!s.rotation||this.version<10.3?{}:{rotation:-s.rotation},m=e&&e.spatialReference,n=m.wkid||JSON.stringify(m.toJSON());a.dpi*=o;const l={};if(null!=s&&s.timeExtent){const{start:e,end:r}=s.timeExtent.toJSON();l.time=e&&r&&e===r?\"\"+e:`${null==e?\"null\":e},${null==r?\"null\":r}`}else this.timeInfo&&!this.timeInfo.hasLiveData&&(l.time=\"null,null\");return{bbox:e&&e.xmin+\",\"+e.ymin+\",\"+e.xmax+\",\"+e.ymax,bboxSR:n,imageSR:n,size:r+\",\"+t,...a,...p,...l}}async fetchImage(e,r,t,s){const o={responseType:\"image\"};s&&s.timestamp&&(o.query={...o.query,_ts:s.timestamp}),s&&s.signal&&(o.signal=s.signal),this.customParameters&&Object.keys(this.customParameters).length&&(o.query={...this.customParameters,...o.query});const i=this.parsedUrl.path+\"/export\",a={...this.parsedUrl.query,...this.createExportImageParameters(e,r,t,s),f:\"image\",_ts:this.alwaysRefetch?Date.now():null};if(null!=a.dynamicLayers&&!this.capabilities.exportMap.supportsDynamicLayers)return l(new p(\"mapimagelayer:dynamiclayer-not-supported\",`service ${this.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`,{query:a}));o.query?o.query={...a,...o.query}:o.query=a;return y(i,o).then((e=>e.data)).catch((e=>{if(c(e))throw e;throw new p(\"mapimagelayer:image-fetch-error\",`Unable to load image: ${i}`,{error:e})}))}async fetchRecomputedExtents(e={}){const r={...e,query:{returnUpdates:!0,f:\"json\"}},{data:t}=await y(this.url,r),{extent:s,fullExtent:o,timeExtent:i}=t,a=s||o;return{fullExtent:a&&u.fromJSON(a),timeExtent:i&&f.fromJSON({start:i[0],end:i[1]})}}loadAll(){return h(this,(e=>{e(this.allSublayers)}))}async _fetchService(e){if(this.sourceJSON)return void this.read(this.sourceJSON,{origin:\"service\",url:this.parsedUrl});const{data:r,ssl:t}=await y(this.parsedUrl.path,{query:{f:\"json\",...this.parsedUrl.query,...this.customParameters},signal:e});t&&(this.url=this.url.replace(/^http:/i,\"https:\")),this.sourceJSON=r,this.read(r,{origin:\"service\",url:this.parsedUrl})}};e([s()],U.prototype,\"alwaysRefetch\",void 0),e([s()],U.prototype,\"dpi\",void 0),e([s()],U.prototype,\"gdbVersion\",void 0),e([s({json:{read:!1,write:!1}})],U.prototype,\"popupEnabled\",void 0),e([s()],U.prototype,\"imageFormat\",void 0),e([o(\"imageFormat\",[\"supportedImageFormatTypes\"])],U.prototype,\"readImageFormat\",null),e([s({json:{origins:{service:{read:{source:\"maxImageHeight\"}}}}})],U.prototype,\"imageMaxHeight\",void 0),e([s({json:{origins:{service:{read:{source:\"maxImageWidth\"}}}}})],U.prototype,\"imageMaxWidth\",void 0),e([s()],U.prototype,\"imageTransparency\",void 0),e([s({json:{read:!1,write:!1}})],U.prototype,\"labelsVisible\",void 0),e([s({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],U.prototype,\"isReference\",void 0),e([s({type:[\"ArcGISMapServiceLayer\"]})],U.prototype,\"operationalLayerType\",void 0),e([s()],U.prototype,\"sourceJSON\",void 0),e([s({json:{write:{ignoreOrigin:!0}}})],U.prototype,\"sublayers\",void 0),e([a(\"sublayers\",{layers:{type:[P]},visibleLayers:{type:[t]}})],U.prototype,\"writeSublayers\",null),e([s({type:[\"show\",\"hide\",\"hide-children\"]})],U.prototype,\"listMode\",void 0),e([s({json:{read:!1},readOnly:!0,value:\"map-image\"})],U.prototype,\"type\",void 0),e([s(j)],U.prototype,\"url\",void 0),U=e([i(\"esri.layers.MapImageLayer\")],U);var T=U;export default T;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import{reader as o}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as r}from\"../../core/accessorSupport/decorators/subclass.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import{fixTimeInfoFields as s}from\"../support/fieldUtils.js\";import{timeUnitKebabDictionary as i}from\"../support/timeUtils.js\";import p from\"../../TimeExtent.js\";import m from\"../../TimeInterval.js\";import n from\"../support/TimeInfo.js\";function u(e){return void 0!==e.timeInfo}const f=u=>{let f=class extends u{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(e,t){const o=t.timeInfo.exportOptions;if(!o)return null;const r=o.timeOffset,s=i.fromJSON(o.timeOffsetUnits);return r&&s?new m({value:r,unit:s}):null}set timeInfo(e){s(e,this.fields),this._set(\"timeInfo\",e)}};return e([t({type:p,json:{write:!1}})],f.prototype,\"timeExtent\",void 0),e([t({type:m})],f.prototype,\"timeOffset\",void 0),e([o(\"service\",\"timeOffset\",[\"timeInfo.exportOptions\"])],f.prototype,\"readOffset\",null),e([t({value:null,type:n,json:{write:!0,origins:{\"web-document\":{read:!1,write:!1}}}})],f.prototype,\"timeInfo\",null),e([t({type:Boolean,json:{read:{source:\"timeAnimation\"},write:{target:\"timeAnimation\"},origins:{\"web-scene\":{read:!1,write:!1}}}})],f.prototype,\"useViewTime\",void 0),f=e([r(\"esri.layers.mixins.TemporalLayer\")],f),f};export{f as TemporalLayer,u as isTemporalLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import{reader as t}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import{JSONSupport as s}from\"../../core/JSONSupport.js\";var i;let p=i=class extends s{constructor(e){super(e),this.respectsDaylightSaving=!1,this.timezone=null}readRespectsDaylightSaving(e,r){return void 0!==r.respectsDaylightSaving?r.respectsDaylightSaving:void 0!==r.respectDaylightSaving&&r.respectDaylightSaving}clone(){const{respectsDaylightSaving:e,timezone:r}=this;return new i({respectsDaylightSaving:e,timezone:r})}};e([r({type:Boolean,json:{write:!0}})],p.prototype,\"respectsDaylightSaving\",void 0),e([t(\"respectsDaylightSaving\",[\"respectsDaylightSaving\",\"respectDaylightSaving\"])],p.prototype,\"readRespectsDaylightSaving\",null),e([r({type:String,json:{read:{source:\"timeZone\"},write:{target:\"timeZone\"}}})],p.prototype,\"timezone\",void 0),p=i=e([o(\"esri.layers.support.TimeReference\")],p);var a=p;export default a;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import{clone as t}from\"../../core/lang.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import{reader as i}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as l}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as o}from\"../../core/accessorSupport/decorators/writer.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import{JSONSupport as n}from\"../../core/JSONSupport.js\";import{timeUnitKebabDictionary as a}from\"./timeUtils.js\";import s from\"../../TimeExtent.js\";import m from\"../../TimeInterval.js\";import u from\"./TimeReference.js\";var p;let d=p=class extends n{constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeReference=null,this.trackIdField=null,this.useTime=!0}readFullTimeExtent(e,t){if(!t.timeExtent||!Array.isArray(t.timeExtent)||2!==t.timeExtent.length)return null;const r=new Date(t.timeExtent[0]),i=new Date(t.timeExtent[1]);return new s({start:r,end:i})}writeFullTimeExtent(e,t){e&&e.start&&e.end?t.timeExtent=[e.start.getTime(),e.end.getTime()]:t.timeExtent=null}readInterval(e,t){return t.timeInterval&&t.timeIntervalUnits?new m({value:t.timeInterval,unit:a.fromJSON(t.timeIntervalUnits)}):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?new m({value:t.defaultTimeInterval,unit:a.fromJSON(t.defaultTimeIntervalUnits)}):null}writeInterval(e,t){if(e){const r=e.toJSON();t.timeInterval=r.value,t.timeIntervalUnits=r.unit}else t.timeInterval=null,t.timeIntervalUnits=null}clone(){const{cumulative:e,endField:r,hasLiveData:i,interval:l,startField:o,timeReference:n,fullTimeExtent:a,trackIdField:s,useTime:m}=this;return new p({cumulative:e,endField:r,hasLiveData:i,interval:l,startField:o,timeReference:t(n),fullTimeExtent:t(a),trackIdField:s,useTime:m})}};e([r({type:Boolean,json:{read:{source:\"exportOptions.timeDataCumulative\"},write:{target:\"exportOptions.timeDataCumulative\"}}})],d.prototype,\"cumulative\",void 0),e([r({type:String,json:{read:{source:\"endTimeField\"},write:{target:\"endTimeField\",allowNull:!0}}})],d.prototype,\"endField\",void 0),e([r({type:s,json:{write:{enabled:!0,allowNull:!0}}})],d.prototype,\"fullTimeExtent\",void 0),e([i(\"fullTimeExtent\",[\"timeExtent\"])],d.prototype,\"readFullTimeExtent\",null),e([o(\"fullTimeExtent\")],d.prototype,\"writeFullTimeExtent\",null),e([r({type:Boolean,json:{write:!0}})],d.prototype,\"hasLiveData\",void 0),e([r({type:m,json:{write:{enabled:!0,allowNull:!0}}})],d.prototype,\"interval\",void 0),e([i(\"interval\",[\"timeInterval\",\"timeIntervalUnits\",\"defaultTimeInterval\",\"defaultTimeIntervalUnits\"])],d.prototype,\"readInterval\",null),e([o(\"interval\")],d.prototype,\"writeInterval\",null),e([r({type:String,json:{read:{source:\"startTimeField\"},write:{target:\"startTimeField\",allowNull:!0}}})],d.prototype,\"startField\",void 0),e([r({type:u,json:{write:{enabled:!0,allowNull:!0}}})],d.prototype,\"timeReference\",void 0),e([r({type:String,json:{write:{enabled:!0,allowNull:!0}}})],d.prototype,\"trackIdField\",void 0),e([r({type:Boolean,json:{read:{source:\"exportOptions.useTime\"},write:{target:\"exportOptions.useTime\"}}})],d.prototype,\"useTime\",void 0),d=p=e([l(\"esri.layers.support.TimeInfo\")],d);var c=d;export default c;\n"],"sourceRoot":""}