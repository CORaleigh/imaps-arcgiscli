(self.webpackChunkimaps=self.webpackChunkimaps||[]).push([[2499],{37969:(e,t,r)=>{"use strict";r.d(t,{pJ:()=>l,XO:()=>s});var n=r(7584);function s(e){return e=e||n.Z.location.hostname,c.some((t=>{var r;return null!=(null==(r=e)?void 0:r.match(t))}))}function l(e,t){return e&&(t=t||n.Z.location.hostname)?null!=t.match(o)||null!=t.match(i)?e.replace("static.arcgis.com","staticdev.arcgis.com"):null!=t.match(a)||null!=t.match(m)?e.replace("static.arcgis.com","staticqa.arcgis.com"):e:e}const o=/^devext.arcgis.com$/,a=/^qaext.arcgis.com$/,i=/^[\w-]*\.mapsdevext.arcgis.com$/,m=/^[\w-]*\.mapsqa.arcgis.com$/,c=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,o,a,/^jsapps.esri.com$/,i,m]},42499:(e,t,r)=>{"use strict";r.r(t),r.d(t,{fetchStyle:()=>h,fetchSymbolFromStyle:()=>g,resolveWebStyleSymbol:()=>w,styleNameFromItem:()=>$});var n=r(32656),s=r(10923),l=r(37704),o=r(39105),a=r(54721),i=r(56798),m=r(32797),c=r(87484),u=r(36875),y=r(54734),f=r(37969),p=r(95830);function d(e){return!!(0,p.Z)(`enable-feature:${e}`)}const b={};function h(e,t,r){return e.styleUrl?function(e,t){return S(e,t).then((t=>({data:t.data,baseUrl:(0,s.Yd)(e),styleUrl:e})))}(e.styleUrl,r):e.styleName?function(e,t,r){const s=t.portal||m.Z.getDefault();let l;const o=`${s.url} - ${s.user&&s.user.username} - ${e}`;return b[o]||(b[o]=function(e,t,r){return t.load(r).then((()=>{const n=new i.Z({disableExtraQuery:!0,query:`owner:${Z} AND type:${v} AND typekeywords:"${e}"`});return t.queryItems(n,r)})).then((({results:t})=>{let s=null;const l=e.toLowerCase();if(t&&Array.isArray(t))for(const e of t)if(e.typeKeywords.some((e=>e.toLowerCase()===l))&&e.type===v&&e.owner===Z){s=e;break}if(!s)throw new n.Z("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return s.load(r)}))}(e,s,r).then((e=>(l=e,e.fetchData()))).then((t=>({data:t,baseUrl:l.itemUrl,styleName:e})))),b[o]}(e.styleName,t,r):(0,o.reject)(new n.Z("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function w(e,t,r,l){return e.name?e.styleName&&"Esri2DPointSymbolsStyle"===e.styleName?function(e,t,r){const n=U.replace(/\{SymbolName\}/gi,e.name);return S(n,r).then((e=>{const r=N(e.data);return(0,y.f)(r,{portal:t.portal,url:(0,s.mN)((0,s.Yd)(n)),origin:"portal-item"})}))}(e,t,l):h(e,t,l).then((n=>g(n,e.name,t,r,l))):(0,o.reject)(new n.Z("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))}function g(e,t,r,a,i){const m=e.data,p={portal:r.portal,url:(0,s.mN)(e.baseUrl),origin:"portal-item"},b=m.items.find((e=>e.name===t));if(!b)return(0,o.reject)(new n.Z("symbolstyleutils:symbol-name-not-found",`The symbol name '${t}' could not be found`,{symbolName:t}));let h=(0,l.f)(function(e,t){if("cimRef"===t)return e.cimRef;if(e.formatInfos&&!d("force-wosr"))for(const t of e.formatInfos)if("gltf"===t.type)return t.href;return e.webRef}(b,a),p),w=b.thumbnail&&b.thumbnail.href;const g=b.thumbnail&&b.thumbnail.imageData;(0,f.XO)()&&(h=(0,f.pJ)(h),w=(0,f.pJ)(w));const $={portal:r.portal,url:(0,s.mN)((0,s.Yd)(h)),origin:"portal-item"};return S(h,i).then((n=>{const s="cimRef"===a?N(n.data):n.data,o=(0,y.f)(s,$);if(o&&(0,y.i)(o)){if(w){const e=(0,l.f)(w,p);o.thumbnail=new u.Z({url:e})}else g&&(o.thumbnail=new u.Z({url:`data:image/png;base64,${g}`}));e.styleUrl?o.styleOrigin=new c.Z({portal:r.portal,styleUrl:e.styleUrl,name:t}):e.styleName&&(o.styleOrigin=new c.Z({portal:r.portal,styleName:e.styleName,name:t}))}return o}))}function N(e){return null===e||"CIMSymbolReference"===e.type?e:{type:"CIMSymbolReference",symbol:e}}function $(e){for(const t of e.typeKeywords)if(/^Esri.*Style$/.test(t)&&"Esri Style"!==t)return t}function S(e,t){const r={responseType:"json",query:{f:"json"},...t};return(0,a.default)((0,s.Fv)(e),r)}const Z="esri_en",v="Style",U="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json"}}]);
//# sourceMappingURL=2499.js.map