(self.webpackChunkimaps=self.webpackChunkimaps||[]).push([[2357],{61121:(e,t,n)=>{"use strict";function r(e){return"date"===e.type||"esriFieldTypeDate"===e.type}function s(e){return e.toLowerCase().trim()}n.d(t,{Z:()=>a});const a=class{constructor(e){if(this.fields=e,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this.dateFields=[],!e)return;const t=[];for(const n of e){const e=n&&n.name;if(e){const a=s(e);this._fieldsMap.set(e,n),this._fieldsMap.set(a,n),t.push(a),r(n)&&(this.dateFields.push(n),this._dateFieldsSet.add(n))}}t.sort(),this.uid=t.join(",")}destroy(){this._fieldsMap.clear()}has(e){return null!=this.get(e)}get(e){return null!=e?this._fieldsMap.get(e)||this._fieldsMap.get(s(e)):void 0}isDateField(e){return this._dateFieldsSet.has(this.get(e))}normalizeFieldName(e){const t=this.get(e);if(t)return t.name}}},82357:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createLabelFunction:()=>g,formatField:()=>x});var r=n(36544),s=n(32656),a=n(30927),i=n(4665),l=n(21979),u=n(17427),o=n(61121),c=n(49684);const p=r.Z.getLogger("esri.layers.support.labelFormatUtils"),f={type:"simple",evaluate:()=>null},d={getAttribute:(e,t)=>e.field(t)};async function g(e,t,r){if(!e||!e.symbol)return f;const l=e.where,u=(0,c.hV)(e),g=l?await n.e(1063).then(n.bind(n,71063)):null;let h;if("arcade"===u.type){const e=await(0,a.WW)(u.expression,r,t);h={type:"arcade",evaluate(t){try{const n=e.evaluate({$feature:"attributes"in t?e.repurposeFeature(t):e.repurposeAdapter(t)});if(null!=n)return n.toString()}catch(e){p.error(new s.Z("bad-arcade-expression","Encountered an error when evaluating label expression for feature",{feature:t,expression:u}))}return null},needsHydrationToEvaluate:()=>null==(0,c.el)(u.expression)}}else h={type:"simple",evaluate:e=>u.expression.replace(/{[^}]*}/g,(n=>{const r=n.slice(1,-1),s=(0,i.rz)(t,r);if(!s)return n;let a=null;return"attributes"in e?e&&e.attributes&&(a=e.attributes[s.name]):a=e.field(s.name),null==a?"":x(a,s)}))};if(l){let n;try{n=g.WhereClause.create(l,new o.Z(t))}catch(e){return f}const r=h.evaluate;h.evaluate=e=>{const t="attributes"in e?void 0:d;return n.testFeature(e,t)?r(e):null}}return h}function x(e,t){if(null==e)return"";const n=t.domain;if(n)if("codedValue"===n.type||"coded-value"===n.type){const t=e;for(const e of n.codedValues)if(e.code===t)return e.name}else if("range"===n.type){const t=+e,r="range"in n?n.range[0]:n.minValue,s="range"in n?n.range[1]:n.maxValue;if(r<=t&&t<=s)return n.name}let r=e;return"date"===t.type||"esriFieldTypeDate"===t.type?r=(0,l.p6)(r,(0,l.Ze)("short-date")):(0,i.H7)(t)&&(r=(0,u.uf)(+r)),r||""}},49684:(e,t,n)=>{"use strict";n.d(t,{dI:()=>f,hV:()=>o,YI:()=>c,UO:()=>p,el:()=>_,z7:()=>u});var r=n(88263);const s=new RegExp("__begin__","ig"),a=new RegExp("__end__","ig"),i=new RegExp("^__begin__","i"),l=new RegExp("__end__$","i");function u(e){return e.replace(new RegExp("\\{","g"),"[").replace(new RegExp("\\}","g"),"]")}function o(e){const t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):null!=e.labelExpression&&(t.expression=function(e){return e.replace(new RegExp("\\[","g"),"{").replace(new RegExp("\\]","g"),"}")}(e.labelExpression),t.type="conventional"),t}function c(e){const t=o(e);if(!t)return null;switch(t.type){case"conventional":return f(t.expression);case"arcade":return t.expression}return null}function p(e){const t=o(e);if(!t)return null;switch(t.type){case"conventional":return function(e){const t=e.match(d);return t&&t[1].trim()||null}(t.expression);case"arcade":return _(t.expression)}return null}function f(e){let t;return e?(t=(0,r.gx)(e,(e=>'__begin__$feature["'+e+'"]__end__')),t=i.test(t)?t.replace(i,""):'"'+t,t=l.test(t)?t.replace(l,""):t+'"',t=t.replace(s,'" + ').replace(a,' + "')):t='""',t}const d=/^\s*\{([^}]+)\}\s*$/i;const g=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,x=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,h=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function _(e){if(!e)return null;let t=g.exec(e)||x.exec(e);return t?t[1]||t[3]:(t=h.exec(e),t?t[2]:null)}}}]);
//# sourceMappingURL=2357.js.map