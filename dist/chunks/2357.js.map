{"version":3,"sources":["webpack://imaps/./node_modules/@arcgis/core/layers/support/FieldsIndex.js","webpack://imaps/./node_modules/@arcgis/core/layers/support/labelFormatUtils.js","webpack://imaps/./node_modules/@arcgis/core/layers/support/labelUtils.js"],"names":["t","type","e","toLowerCase","trim","s","this","fields","_fieldsMap","Map","_dateFieldsSet","Set","dateFields","i","d","name","a","set","push","add","sort","uid","join","clear","get","has","c","f","evaluate","m","getAttribute","field","async","o","symbol","where","l","g","expression","r","$feature","repurposeFeature","repurposeAdapter","toString","error","feature","needsHydrationToEvaluate","replace","slice","attributes","y","WhereClause","create","testFeature","domain","codedValues","code","range","minValue","n","maxValue","RegExp","labelExpressionInfo","value","labelExpression","p","match","u","x","w","test","_","exec"],"mappings":"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","file":"chunks/2357.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction t(t){return\"date\"===t.type||\"esriFieldTypeDate\"===t.type}function e(t){return t.toLowerCase().trim()}export default class{constructor(s){if(this.fields=s,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this.dateFields=[],!s)return;const i=[];for(const d of s){const s=d&&d.name;if(s){const a=e(s);this._fieldsMap.set(s,d),this._fieldsMap.set(a,d),i.push(a),t(d)&&(this.dateFields.push(d),this._dateFieldsSet.add(d))}}i.sort(),this.uid=i.join(\",\")}destroy(){this._fieldsMap.clear()}has(t){return null!=this.get(t)}get(t){return null!=t?this._fieldsMap.get(t)||this._fieldsMap.get(e(t)):void 0}isDateField(t){return this._dateFieldsSet.has(this.get(t))}normalizeFieldName(t){const e=this.get(t);if(e)return e.name}}\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Logger.js\";import t from\"../../core/Error.js\";import{createLabelExpression as r}from\"../../support/arcadeOnDemand.js\";import{isNumericField as a,getField as n}from\"./fieldUtils.js\";import{formatDate as o,convertDateFormatToIntlOptions as i}from\"../../intl/date.js\";import{formatNumber as l}from\"../../intl/number.js\";import s from\"./FieldsIndex.js\";import{getLabelExpression as u,getSingleFieldArcadeExpression as p}from\"./labelUtils.js\";const c=e.getLogger(\"esri.layers.support.labelFormatUtils\"),f={type:\"simple\",evaluate:()=>null},m={getAttribute:(e,t)=>e.field(t)};async function d(e,a,o){if(!e||!e.symbol)return f;const i=e.where,l=u(e),d=i?await import(\"../../core/sql/WhereClause.js\"):null;let g;if(\"arcade\"===l.type){const e=await r(l.expression,o,a);g={type:\"arcade\",evaluate(r){try{const t=e.evaluate({$feature:\"attributes\"in r?e.repurposeFeature(r):e.repurposeAdapter(r)});if(null!=t)return t.toString()}catch(e){c.error(new t(\"bad-arcade-expression\",\"Encountered an error when evaluating label expression for feature\",{feature:r,expression:l}))}return null},needsHydrationToEvaluate:()=>null==p(l.expression)}}else g={type:\"simple\",evaluate:e=>l.expression.replace(/{[^}]*}/g,(t=>{const r=t.slice(1,-1),o=n(a,r);if(!o)return t;let i=null;if(\"attributes\"in e){e&&e.attributes&&(i=e.attributes[o.name])}else i=e.field(o.name);return null==i?\"\":y(i,o)}))};if(i){let e;try{e=d.WhereClause.create(i,new s(a))}catch(e){return f}const t=g.evaluate;g.evaluate=r=>{const a=\"attributes\"in r?void 0:m;return e.testFeature(r,a)?t(r):null}}return g}function y(e,t){if(null==e)return\"\";const r=t.domain;if(r)if(\"codedValue\"===r.type||\"coded-value\"===r.type){const t=e;for(const e of r.codedValues)if(e.code===t)return e.name}else if(\"range\"===r.type){const t=+e,a=\"range\"in r?r.range[0]:r.minValue,n=\"range\"in r?r.range[1]:r.maxValue;if(a<=t&&t<=n)return r.name}let n=e;return\"date\"===t.type||\"esriFieldTypeDate\"===t.type?n=o(n,i(\"short-date\")):a(t)&&(n=l(+n)),n||\"\"}export{d as createLabelFunction,y as formatField};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{replace as e}from\"../../core/string.js\";const n=new RegExp(\"__begin__\",\"ig\"),r=new RegExp(\"__end__\",\"ig\"),s=new RegExp(\"^__begin__\",\"i\"),t=new RegExp(\"__end__$\",\"i\");function o(e){return e.replace(new RegExp(\"\\\\[\",\"g\"),\"{\").replace(new RegExp(\"\\\\]\",\"g\"),\"}\")}function i(e){return e.replace(new RegExp(\"\\\\{\",\"g\"),\"[\").replace(new RegExp(\"\\\\}\",\"g\"),\"]\")}function l(e){const n={expression:\"\",type:\"none\"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(n.expression=e.labelExpressionInfo.value,n.type=\"conventional\"):e.labelExpressionInfo.expression&&(n.expression=e.labelExpressionInfo.expression,n.type=\"arcade\"):null!=e.labelExpression&&(n.expression=o(e.labelExpression),n.type=\"conventional\"),n}function a(e){const n=l(e);if(!n)return null;switch(n.type){case\"conventional\":return p(n.expression);case\"arcade\":return n.expression}return null}function c(e){const n=l(e);if(!n)return null;switch(n.type){case\"conventional\":return x(n.expression);case\"arcade\":return w(n.expression)}return null}function p(o){let i;return o?(i=e(o,(e=>'__begin__$feature[\"'+e+'\"]__end__')),i=s.test(i)?i.replace(s,\"\"):'\"'+i,i=t.test(i)?i.replace(t,\"\"):i+'\"',i=i.replace(n,'\" + ').replace(r,' + \"')):i='\"\"',i}const u=/^\\s*\\{([^}]+)\\}\\s*$/i;function x(e){const n=e.match(u);return n&&n[1].trim()||null}const f=/^\\s*(?:(?:\\$feature\\.(\\w+))|(?:\\$feature\\[([\"'])([\\w\\s]+)(\\2)\\]));?\\s*$/i,_=/^\\s*(?:(?:\\$feature\\.(\\w+))|(?:\\$feature\\[([\"'])([\\w\\s]+)(\\2)\\]));?\\s*(?:DomainName\\(\\s*\\$feature\\s*,\\s*([\"'])(\\1|\\3)(\\5)\\s*\\));?\\s*$/i,g=/^\\s*(?:DomainName\\(\\s*\\$feature\\s*,\\s*([\"'])([\\w\\s]+)(\\1)\\s*\\));?\\s*$/i;function w(e){if(!e)return null;let n=f.exec(e)||_.exec(e);return n?n[1]||n[3]:(n=g.exec(e),n?n[2]:null)}export{p as convertTemplatedStringToArcade,l as getLabelExpression,a as getLabelExpressionArcade,c as getLabelExpressionSingleField,w as getSingleFieldArcadeExpression,x as getSingleFieldTemplatedString,o as sqlToTemplateString,i as templateStringToSql};\n"],"sourceRoot":""}