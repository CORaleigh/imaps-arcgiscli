{"version":3,"sources":["webpack://imaps/./node_modules/@arcgis/core/core/LRUCache.js","webpack://imaps/./node_modules/@arcgis/core/core/MemCache.js","webpack://imaps/./node_modules/@arcgis/core/renderers/DictionaryRenderer.js"],"names":["e","r","this","_storage","maxSize","registerRemoveFunc","t","put","pop","get","clearAll","s","_namespace","_removeFunc","_hit","_miss","register","slice","size","clear","deregisterRemoveFunc","deregister","i","updateSize","getStats","resetStats","_maxSize","_db","Map","_size","_removeFuncs","_users","push","removeUnordered","filter","Math","max","_checkSizeLimit","h","delete","entry","_notifyRemoved","console","warn","set","lifetime","lives","Size","round","_getHitRate","Entries","toString","Array","forEach","forAll","namespace","startsWith","isNaN","hitRate","Object","keys","sort","length","resetHitRate","w","x","v","super","_ongoingRequests","_symbolCache","config","fieldMap","scaleExpression","scaleExpressionTitle","url","type","scalingExpressionInfo","expression","returnType","origin","writeVisualVariables","visualVariables","_dictionaryPromise","fetchResources","_symbolFields","attributes","o","n","a","catch","l","split","p","u","indexOf","_itemNames","has","substr","map","Number","toRgba","primitiveName","propertyName","value","m","_cimPartsToCIMSymbol","collectVVRequiredFields","name","add","error","abortOptions","responseType","query","f","data","authoringInfo","_refSymbolUrlTemplate","cimRefTemplateUrl","Set","itemsNames","symbol","configuration","hasOwnProperty","c","fields","spatialReference","then","scale","repurposeFeature","geometry","evaluate","$feature","$view","reduce","getAttributeHash","JSON","stringify","replace","primitiveOverrides","symbolLayers","unshift","_getSymbolPart","_combineSymbolParts","json","read","source","write","target","prototype","String","enabled"],"mappings":"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","file":"chunks/3925.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{MemCacheStorage as t}from\"./MemCache.js\";export default class{constructor(e,r){this._storage=new t,this._storage.maxSize=e,r&&this._storage.registerRemoveFunc(\"\",r)}put(t,e,r){this._storage.put(t,e,r,1)}pop(t){return this._storage.pop(t)}get(t){return this._storage.get(t)}clear(){this._storage.clearAll()}destroy(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}}\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport t from\"./PooledArray.js\";const e=-3;class s{constructor(t,e,s){this._namespace=t,this._storage=e,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=\":\",s&&(this._storage.registerRemoveFunc(this._namespace,s),this._removeFunc=!0)}get namespace(){return this._namespace.slice(0,-1)}get hitRate(){return this._hit/(this._hit+this._miss)}get size(){return this._storage.size}get maxSize(){return this._storage.maxSize}resetHitRate(){this._hit=this._miss=0}destroy(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this)}put(t,e,s,i=0){this._storage.put(this._namespace+t,e,s,i)}get(t){const e=this._storage.get(this._namespace+t);return void 0===e?++this._miss:++this._hit,e}pop(t){const e=this._storage.pop(this._namespace+t);return void 0===e?++this._miss:++this._hit,e}updateSize(t,e,s){this._storage.updateSize(this._namespace+t,e,s)}clear(){this._storage.clear(this._namespace)}clearAll(){this._storage.clearAll()}getStats(){return this._storage.getStats()}resetStats(){this._storage.resetStats()}}class i{constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=[],this._users=new t}register(t){this._users.push(t)}deregister(t){this._users.removeUnordered(t)}registerRemoveFunc(t,e){this._removeFuncs.push([t,e])}deregisterRemoveFunc(t){this._removeFuncs=this._removeFuncs.filter((e=>e[0]!==t))}get size(){return this._size}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,0),this._checkSizeLimit()}put(t,e,s,i){const h=this._db.get(t);if(h&&(this._size-=h.size,this._db.delete(t),h.entry!==e&&this._notifyRemoved(t,h.entry)),s>this._maxSize)return void this._notifyRemoved(t,e);if(void 0===e)return void console.warn(\"Refusing to cache undefined entry \");if(!s||s<0)return void console.warn(\"Refusing to cache entry with invalid size \"+s);const r=1+Math.max(i,-3)- -3;this._db.set(t,{entry:e,size:s,lifetime:r,lives:r}),this._size+=s,this._checkSizeLimit()}updateSize(t,e,s){const i=this._db.get(t);i&&i.entry===e&&(this._size-=i.size,s>this._maxSize?this._notifyRemoved(t,e):(i.size=s,this._size+=s,this._checkSizeLimit()))}pop(t){const e=this._db.get(t);if(e)return this._size-=e.size,this._db.delete(t),++this._hit,e.entry;++this._miss}get(t){const e=this._db.get(t);if(void 0!==e)return this._db.delete(t),e.lives=e.lifetime,this._db.set(t,e),++this._hit,e.entry;++this._miss}getStats(){const t={Size:Math.round(this._size/1048576)+\"/\"+Math.round(this._maxSize/1048576)+\"MB\",\"Hit rate\":Math.round(100*this._getHitRate())+\"%\",Entries:this._db.size.toString()},e={},s=new Array;this._db.forEach(((t,i)=>{const h=t.lifetime;s[h]=(s[h]||0)+t.size,this._users.forAll((s=>{const h=s.namespace;if(i.startsWith(h)){const s=e[h]||0;e[h]=s+t.size}}))}));const i={};this._users.forAll((t=>{const s=t.namespace;if(!isNaN(t.hitRate)&&t.hitRate>0){const h=e[s]||0;e[s]=h,i[s]=Math.round(100*t.hitRate)+\"%\"}else i[s]=\"0%\"}));const h=Object.keys(e);h.forEach((t=>e[t]=e[t]/this._size*100)),h.sort(((t,s)=>e[s]-e[t])),h.forEach((s=>t[s]=Math.round(e[s])+\"% / \"+i[s]));for(let e=s.length-1;e>=0;--e){const i=s[e];i&&(t[\"Priority \"+(e+-3-1)]=Math.round(i/this.size*100)+\"%\")}return t}resetStats(){this._hit=this._miss=0,this._users.forAll((t=>t.resetHitRate()))}clear(t){this._db.forEach(((e,s)=>{s.startsWith(t)&&(this._size-=e.size,this._db.delete(s),this._notifyRemoved(s,e.entry))}))}clearAll(){this._db.forEach(((t,e)=>this._notifyRemoved(e,t.entry))),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemoved(t,e){this._removeFuncs.forEach((s=>{t.startsWith(s[0])&&s[1](e)}))}_checkSizeLimit(){if(!(this._size<=this._maxSize))for(const[t,e]of this._db)if(this._db.delete(t),e.lives<=1?(this._size-=e.size,this._notifyRemoved(t,e.entry)):(--e.lives,this._db.set(t,e)),this._size<=.9*this.maxSize)return}}export{e as MIN_PRIORITY,s as MemCache,i as MemCacheStorage};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import{clone as s}from\"../core/lang.js\";import{isSome as t}from\"../core/maybe.js\";import{numericHash as r}from\"../core/string.js\";import i from\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import{property as o}from\"../core/accessorSupport/decorators/property.js\";import{subclass as n}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as a}from\"../core/accessorSupport/decorators/writer.js\";import l from\"../core/Error.js\";import\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import{isAbortError as c,all as p,reject as u}from\"../core/promiseUtils.js\";import{loadArcade as m,createDictionaryExpression as f}from\"../support/arcadeOnDemand.js\";import{collectArcadeFieldNames as h}from\"../layers/support/fieldUtils.js\";import y from\"../Color.js\";import d from\"../symbols/CIMSymbol.js\";import g from\"../request.js\";import b from\"./Renderer.js\";import{VisualVariablesMixin as j}from\"./mixins/VisualVariablesMixin.js\";import _ from\"../core/LRUCache.js\";var w;const x=i.getLogger(\"esri.renderers.DictionaryRenderer\");let v=w=class extends(j(b)){constructor(e){super(e),this._ongoingRequests=new Map,this._symbolCache=new _(100),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type=\"dictionary\"}writeData(e,s){e&&(s.scalingExpressionInfo={expression:e,returnType:\"number\"})}writeVisualVariables(e,s,t,r){null!=r&&r.origin||super.writeVisualVariables(e,s,t,r)}clone(){return new w({config:s(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:s(this.fieldMap),url:s(this.url),visualVariables:s(this.visualVariables)})}async getSymbolAsync(e,s){let t;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(s));try{t=await this._dictionaryPromise}catch(e){if(c(e))return this._dictionaryPromise=null,null}const i={};if(this.fieldMap)for(const s of this._symbolFields){const t=this.fieldMap[s];if(t&&null!==e.attributes[t]&&void 0!==e.attributes[t]){const r=\"\"+e.attributes[t];i[s]=r}else i[s]=\"\"}const o=t(i,s);if(!o||\"string\"!=typeof o)return null;const n=r(o).toString(),a=this._symbolCache.get(n);if(a)return a.catch((()=>{this._symbolCache.pop(n)})),a;const l=o.split(\";\"),p=[],u=[];for(const e of l)if(e&&0!==e.length)if(-1===e.indexOf(\"po:\"))if(-1!==e.indexOf(\"|\"))for(const s of e.split(\"|\"))this._itemNames.has(s)&&p.push(s);else this._itemNames.has(e)&&p.push(e);else{const s=e.substr(3).split(\"|\");if(3===s.length){const e=s[0],t=s[1];let r=s[2];if(\"DashTemplate\"===t)r=r.split(\" \").map((e=>Number(e)));else if(\"Color\"===t){const e=new y(r).toRgba();r=[e[0],e[1],e[2],255*e[3]]}else r=Number(r);u.push({primitiveName:e,propertyName:t,value:r})}}const m=this._cimPartsToCIMSymbol(p,u,s);return this._symbolCache.put(n,m,1),m}async collectRequiredFields(e,s){await this.collectVVRequiredFields(e,s),this.scaleExpression&&await h(e,s,this.scaleExpression);const t=s.map((e=>e.name));for(const s in this.fieldMap)t.indexOf(this.fieldMap[s])<0||e.add(this.fieldMap[s])}get arcadeRequired(){return!0}async fetchResources(e){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void x.error(\"no valid URL!\");const s=t(e)?e.abortOptions:null,r=g(this.url+\"/resources/styles/dictionary-info.json\",{responseType:\"json\",query:{f:\"json\"},...s}),[{data:i}]=await p([r,m()]);if(!i)throw this._dictionaryPromise=null,new l(\"esri.renderers.DictionaryRenderer\",\"Bad dictionary data!\");const o=i.expression,n=i.authoringInfo;this._refSymbolUrlTemplate=this.url+\"/\"+i.cimRefTemplateUrl,this._itemNames=new Set(i.itemsNames),this._symbolFields=n.symbol;const a={};if(this.config){const e=this.config;for(const s in e)a[s]=e[s]}for(const e of n.configuration)a.hasOwnProperty(e.name)||(a[e.name]=e.value);const c=[];if(t(e)&&e.fields&&this.fieldMap)for(const s of this._symbolFields){const t=this.fieldMap[s],r=e.fields.filter((e=>e.name===t));r.length>0&&c.push({...r[0],name:s})}return this._dictionaryPromise=f(o,t(e)?e.spatialReference:null,c,a).then((e=>{const s={scale:0};return(r,i)=>{const o=e.repurposeFeature({geometry:null,attributes:r});return s.scale=t(i)?i.scale:void 0,e.evaluate({$feature:o,$view:s})}})).catch((e=>(x.error(\"Creating dictinoary expression failed:\",e),null))),this._dictionaryPromise}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,s)=>e+s.getAttributeHash()),\"\")}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._symbolFields}async _getSymbolPart(e,s){if(this._ongoingRequests.has(e))return this._ongoingRequests.get(e).then((e=>e.data));const t=this._refSymbolUrlTemplate.replace(/\\{itemName\\}/gi,e),r=g(t,{responseType:\"json\",query:{f:\"json\"},...s});this._ongoingRequests.set(e,r);try{return(await r).data}catch(s){return this._ongoingRequests.delete(e),u(s)}}_combineSymbolParts(e,s){if(!e||0===e.length)return null;if(1===e.length)return{type:\"CIMSymbolReference\",symbol:e[0],primitiveOverrides:s};const t={...e[0]};t.symbolLayers=[];for(const s of e){const e=s;t.symbolLayers.unshift(...e.symbolLayers)}return{type:\"CIMSymbolReference\",symbol:t,primitiveOverrides:s}}async _cimPartsToCIMSymbol(e,s,t){const r=new Array(e.length);for(let s=0;s<e.length;s++)r[s]=this._getSymbolPart(e[s],t);const i=await p(r);return new d({data:this._combineSymbolParts(i,s)})}};e([o({type:Object,json:{read:{source:\"configuration\"},write:{target:\"configuration\"}}})],v.prototype,\"config\",void 0),e([o({type:Object,json:{write:!0}})],v.prototype,\"fieldMap\",void 0),e([o({type:String,json:{read:{source:\"scalingExpressionInfo.expression\"},write:!0}})],v.prototype,\"scaleExpression\",void 0),e([a(\"scaleExpression\")],v.prototype,\"writeData\",null),e([o({type:String,json:{read:{source:\"scalingExpressionInfo.title\"},write:{target:\"scalingExpressionInfo.title\",overridePolicy(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],v.prototype,\"scaleExpressionTitle\",void 0),e([o({type:String,json:{write:!0}})],v.prototype,\"url\",void 0),e([a(\"visualVariables\")],v.prototype,\"writeVisualVariables\",null),v=w=e([n(\"esri.renderers.DictionaryRenderer\")],v);var S=v;export default S;\n"],"sourceRoot":""}