(self.webpackChunkimaps=self.webpackChunkimaps||[]).push([[4164],{82204:(t,e,n)=>{"use strict";n.d(e,{d:()=>o});var r=n(33655);function o(t,e,n){const o=t.byteLength/(4*e),l=new Uint32Array(t,0,o*e);let f=new Uint32Array(o);const u=n&&n.minReduction||0,g=n&&n.originalIndices||null,d=n&&n.componentOffsets||null;let h=0;if(d)for(let t=0;t<d.length-1;t++){const e=d[t+1]-d[t];e>h&&(h=e)}else h=o;const p=Math.floor(1.1*h)+1;(null==a||a.length<2*p)&&(a=new Uint32Array((0,r.Sf)(2*p)));for(let t=0;t<2*p;t++)a[t]=0;let m=0;const w=!!d&&!!g,v=w?g.length:o,y=w?new Uint32Array(g.length):null,A=1.96;let I=0!==u?Math.ceil(4*A*A/(u*u)*u*(1-u)):v,b=1,S=d?d[1]:v;for(let t=0;t<v;t++){if(t===I){const e=1-m/t;if(e+A*Math.sqrt(e*(1-e)/t)<u)return null;I*=2}if(t===S){for(let t=0;t<2*p;t++)a[t]=0;if(g)for(let t=d[b-1];t<d[b];t++)y[t]=f[g[t]];S=d[++b]}const n=w?g[t]:t,r=n*e,o=c(l,r,e);let s=o%p,h=m;for(;0!==a[2*s+1];){if(a[2*s]===o){const t=a[2*s+1]-1;if(i(l,r,t*e,e)){h=f[t];break}}s++,s>=p&&(s-=p)}h===m&&(a[2*s]=o,a[2*s+1]=n+1,m++),f[n]=h}if(0!==u&&1-m/o<u)return null;if(w){for(let t=d[b-1];t<y.length;t++)y[t]=f[g[t]];f=y}const U=new Uint32Array(e*m);m=0;for(let t=0;t<v;t++)f[t]===m&&(s(l,(w?g[t]:t)*e,U,m*e,e),m++);if(g&&!w){const t=new Uint32Array(g.length);for(let e=0;e<t.length;e++)t[e]=f[g[e]];f=t}return{buffer:U.buffer,indices:f,uniqueCount:m}}function i(t,e,n,r){for(let o=0;o<r;o++)if(t[e+o]!==t[n+o])return!1;return!0}function s(t,e,n,r,o){for(let i=0;i<o;i++)n[r+i]=t[e+i]}function c(t,e,n){let r=0;for(let o=0;o<n;o++)r=t[e+o]+r|0,r=r+(r<<11)+(r>>>2)|0;return r>>>0}let a=null},64164:(t,e,n)=>{"use strict";n.r(e),n.d(e,{work:()=>O,wrappedWork:()=>q});var r=n(82204),o=n(1227),i=n(80905);const s=(0,i.U$)().vec3f("position").u16("componentIndex").u16("_padding"),c=(0,i.U$)().vec2u8("sideness"),a=((0,o.K)(c),(0,i.U$)().vec3f("position0").vec3f("position1").u16("componentIndex").u8("variantOffset",{glNormalized:!0}).u8("variantStroke").u8("variantExtension",{glNormalized:!0}).u8("_padding",{glPadding:!0}).u16("_padding2",{glPadding:!0})),l=a.clone().vec3f("normal"),f=a.clone().vec3f("normalA").vec3f("normalB");var u=n(91946),g=n(77625),d=n(17387);class h{updateSettings(t){this.settings=t}write(t,e,n){const r=function(t){const e=p;e[0]=t.position0[0],e[1]=t.position0[1],e[2]=t.position0[2],e[3]=t.position1[0],e[4]=t.position1[1],e[5]=t.position1[2],w[0]=5381;for(let t=0;t<m.length;t++)w[0]=31*w[0]+m[t];return w[0]}(n);v.seed=r;const o=v.getIntRange(0,255),i=v.getIntRange(0,this.settings.variants-1),s=v.getFloat(),c=255*(.5*function(t,e){const n=t<0?-1:1;return Math.pow(Math.abs(t),1.2)*n}(-(1-Math.min(s/.7,1))+Math.max(0,s-.7)/(1-.7))+.5);t.position0.setVec(e,n.position0),t.position1.setVec(e,n.position1),t.componentIndex.set(e,n.componentIndex),t.variantOffset.set(e,o),t.variantStroke.set(e,i),t.variantExtension.set(e,c)}trim(t,e){return t.slice(0,e)}}const p=new Float32Array(6),m=new Uint32Array(p.buffer),w=new Uint32Array(1),v=new u.Z;class y{constructor(){this.commonWriter=new h}updateSettings(t){this.commonWriter.updateSettings(t)}allocate(t){return l.createBuffer(t)}write(t,e,n){this.commonWriter.write(t,e,n),(0,d.b)(I,n.faceNormal0,n.faceNormal1),(0,d.n)(I,I),t.normal.setVec(e,I)}trim(t,e){return this.commonWriter.trim(t,e)}}y.Layout=l,y.glLayout=(0,o.K)(l,{divisor:1});class A{constructor(){this.commonWriter=new h}updateSettings(t){this.commonWriter.updateSettings(t)}allocate(t){return f.createBuffer(t)}write(t,e,n){this.commonWriter.write(t,e,n),t.normalA.setVec(e,n.faceNormal0),t.normalB.setVec(e,n.faceNormal1)}trim(t,e){return this.commonWriter.trim(t,e)}}A.Layout=f,A.glLayout=(0,o.K)(f,{divisor:1});const I=(0,g.c)();var b=n(12608);function S(t,e){return e.push(t.buffer),{buffer:t.buffer,layout:U(t.layout)}}function U(t){const e=new Array;return t.fields.forEach(((t,n)=>{const r={...t,constructor:N(t.constructor)};e.push([n,r])})),{stride:t.stride,fields:e,fieldNames:t.fieldNames}}const V=[b.ly,b.Eu,b.ct,b.ek,b.gK,b.bj,b.oS,b.q6,b.fP,b.Cd,b.ey,b.O1,b.D_,b.xA,b.ne,b.mc,b.av,b.TS,b.mw,b.v6,b.Nu,b.qt,b.G5,b.hu,b.Hz,b.Vs,b.P_,b.ir,b.o7,b.or,b.n1,b.zO,b.Jj,b.wA,b.PP,b.TN];function N(t){return`${t.ElementType}_${t.ElementCount}`}const k=new Map;function E(t,e){const n=t.length/3,r=new Uint32Array(e+1),o=new Uint32Array(e+1),i=(t,e)=>{t<e?r[t+1]++:o[e+1]++};for(let e=0;e<n;e++){const n=t[3*e],r=t[3*e+1],o=t[3*e+2];i(n,r),i(r,o),i(o,n)}let s=0,c=0;for(let t=0;t<e;t++){const e=r[t+1],n=o[t+1];r[t+1]=s,o[t+1]=c,s+=e,c+=n}const a=new Uint32Array(6*n),l=r[e],f=(t,e,n)=>{if(t<e){const o=r[t+1]++;a[2*o]=e,a[2*o+1]=n}else{const r=o[e+1]++;a[2*l+2*r]=t,a[2*l+2*r+1]=n}};for(let e=0;e<n;e++){const n=t[3*e],r=t[3*e+1],o=t[3*e+2];f(n,r,e),f(r,o,e),f(o,n,e)}const u=(t,e)=>{const n=2*t,r=e-t;for(let t=1;t<r;t++){const e=a[n+2*t],r=a[n+2*t+1];let o=t-1;for(;o>=0&&a[n+2*o]>e;o--)a[n+2*o+2]=a[n+2*o],a[n+2*o+3]=a[n+2*o+1];a[n+2*o+2]=e,a[n+2*o+3]=r}};for(let t=0;t<e;t++)u(r[t],r[t+1]),u(l+o[t],l+o[t+1]);const g=new Int32Array(3*n),d=(e,n)=>e===t[3*n]?0:e===t[3*n+1]?1:e===t[3*n+2]?2:-1,h=(t,e)=>{const n=d(t,e);g[3*e+n]=-1},p=(t,e,n,r)=>{const o=d(t,e);g[3*e+o]=r;const i=d(n,r);g[3*r+i]=e};for(let t=0;t<e;t++){let e=r[t];const n=r[t+1];let i=o[t];const s=o[t+1];for(;e<n&&i<s;){const n=a[2*e],r=a[2*l+2*i];n===r?(p(t,a[2*e+1],r,a[2*l+2*i+1]),e++,i++):n<r?(h(t,a[2*e+1]),e++):(h(r,a[2*l+2*i+1]),i++)}for(;e<n;)h(t,a[2*e+1]),e++;for(;i<s;)h(a[2*l+2*i],a[2*l+2*i+1]),i++}return g}V.forEach((t=>k.set(N(t),t)));var x=n(6962),D=n(19677),M=n(33655),L=n(17154);function W(t,e){return t.cosAngle<e}function B(t,e){return t.cosAngle>e}function P(t,e){const n=(0,M.ZF)(t.cosAngle),r=F.fwd,o=F.ortho;return(0,L.tB)(r,t.position1,t.position0),n*((0,d.d)((0,d.c)(o,t.faceNormal0,t.faceNormal1),r)>0?-1:1)>e}const F={edge:{position0:(0,g.c)(),position1:(0,g.c)(),faceNormal0:(0,g.c)(),faceNormal1:(0,g.c)(),componentIndex:0,cosAngle:0},ortho:(0,g.c)(),fwd:(0,g.c)()},C={v0:(0,g.c)(),v1:(0,g.c)(),v2:(0,g.c)()},_={anglePlanar:4,angleSignificantEdge:35};async function q(t){const e=function(t){return{data:s.createView(t.dataBuffer),originalIndices:"Uint32Array"===t.originalIndicesType?new Uint32Array(t.originalIndicesBuffer):"Uint16Array"===t.originalIndicesType?new Uint16Array(t.originalIndicesBuffer):void 0,writerSettings:t.writerSettings,skipDeduplicate:t.skipDeduplicate}}(t),n=O(e),r=[e.data.buffer];return{result:function(t,e){return e.push(t.regular.lodInfo.lengths.buffer),e.push(t.silhouette.lodInfo.lengths.buffer),{regular:{instancesData:S(t.regular.instancesData,e),lodInfo:{lengths:t.regular.lodInfo.lengths.buffer}},silhouette:{instancesData:S(t.silhouette.instancesData,e),lodInfo:{lengths:t.silhouette.lodInfo.lengths.buffer}},averageEdgeLength:t.averageEdgeLength}}(n,r),transferList:r}}function O(t){const e=function(t,e,n){if(e&&n)return{faces:n,neighbors:E(n,t.count),vertices:t};{const e=(0,r.d)(t.buffer,t.stride/4,{originalIndices:n}),o=E(e.indices,e.uniqueCount);return{faces:e.indices,neighbors:o,vertices:s.createView(e.buffer)}}}(t.data,t.skipDeduplicate,t.originalIndices);return T.updateSettings(t.writerSettings),$.updateSettings(t.writerSettings),function(t,e,n,r=_){const o=t.vertices.position,i=t.vertices.componentIndex,s=(0,M.Vl)(r.anglePlanar),c=(0,M.Vl)(r.angleSignificantEdge),a=Math.cos(c),l=Math.cos(s),f=F.edge,u=f.position0,g=f.position1,h=f.faceNormal0,p=f.faceNormal1,m=function(t){const e=t.faces.length/3,n=t.vertices.position,r=t.faces,o=C.v0,i=C.v1,s=C.v2,c=new Float32Array(3*e);for(let t=0;t<e;t++){const e=r[3*t+0],a=r[3*t+1],l=r[3*t+2];n.getVec(e,o),n.getVec(a,i),n.getVec(l,s),(0,d.f)(i,i,o),(0,d.f)(s,s,o),(0,d.c)(o,i,s),(0,d.n)(o,o),c[3*t+0]=o[0],c[3*t+1]=o[1],c[3*t+2]=o[2]}return c}(t),w=function(t){const e=t.faces.length/3,n=t.faces,r=t.neighbors;let o=0;for(let t=0;t<e;t++){const e=r[3*t+0],i=r[3*t+1],s=r[3*t+2],c=n[3*t+0],a=n[3*t+1],l=n[3*t+2];o+=-1===e||c<a?1:0,o+=-1===i||a<l?1:0,o+=-1===s||l<c?1:0}const i=new Int32Array(4*o);let s=0;for(let t=0;t<e;t++){const e=r[3*t+0],o=r[3*t+1],c=r[3*t+2],a=n[3*t+0],l=n[3*t+1],f=n[3*t+2];(-1===e||a<l)&&(i[s++]=a,i[s++]=l,i[s++]=t,i[s++]=e),(-1===o||l<f)&&(i[s++]=l,i[s++]=f,i[s++]=t,i[s++]=o),(-1===c||f<a)&&(i[s++]=f,i[s++]=a,i[s++]=t,i[s++]=c)}return i}(t),v=w.length/4,y=e.allocate(v);let A=0;const I=v,b=n.allocate(I);let S=0,U=0,V=0;const N=(0,D.w6)(0,v),k=new Float32Array(v);(0,x.Ed)(k,((t,e,n)=>{o.getVec(w[4*e+0],u),o.getVec(w[4*e+1],g),n[e]=(0,d.k)(u,g)})),N.sort(((t,e)=>k[e]-k[t]));const E=new Array,L=new Array;for(let t=0;t<v;t++){const r=N[t],c=k[r],v=w[4*r+0],I=w[4*r+1],x=w[4*r+2],D=w[4*r+3],M=-1===D;if(o.getVec(v,u),o.getVec(I,g),M)(0,d.s)(h,m[3*x+0],m[3*x+1],m[3*x+2]),(0,d.g)(p,h),f.componentIndex=i.get(v),f.cosAngle=(0,d.d)(h,p);else{if((0,d.s)(h,m[3*x+0],m[3*x+1],m[3*x+2]),(0,d.s)(p,m[3*D+0],m[3*D+1],m[3*D+2]),f.componentIndex=i.get(v),f.cosAngle=(0,d.d)(h,p),B(f,l))continue;f.cosAngle<-.9999&&(0,d.g)(p,h)}U+=c,V++,M||W(f,a)?(e.write(y,A++,f),E.push(c)):P(f,s)&&(n.write(b,S++,f),L.push(c))}const q=new Float32Array(E.reverse()),O=new Float32Array(L.reverse());return{regular:{instancesData:e.trim(y,A),lodInfo:{lengths:q}},silhouette:{instancesData:n.trim(b,S),lodInfo:{lengths:O}},averageEdgeLength:U/V}}(e,T,$)}const T=new y,$=new A}}]);
//# sourceMappingURL=4164.js.map