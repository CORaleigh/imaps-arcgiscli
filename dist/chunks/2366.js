(self.webpackChunkimaps=self.webpackChunkimaps||[]).push([[2366],{15988:(e,t,r)=>{"use strict";r.d(t,{Z:()=>g});var s,o=r(56140),i=(r(95830),r(82550)),n=r(59472),a=(r(36544),r(68055),r(79881)),l=r(87566),p=(r(10923),r(57002),r(86035),r(58385)),u=r(56885),c=r(36348),f=r(58484),y=r(54734),h=r(32366);let d=s=class extends p.wq{constructor(...e){super(...e),this.isAggregate=!1,this.layer=null,this.popupTemplate=null,this.sourceLayer=null,Object.defineProperty(this,"uid",{value:(0,h.D)(),configurable:!0})}normalizeCtorArgs(e,t,r,s){return e&&!e.declaredClass?e:{geometry:e,symbol:t,attributes:r,popupTemplate:s}}set attributes(e){const t=this._get("attributes");t!==e&&(this._set("attributes",e),this._notifyLayer("attributes",t,e))}set geometry(e){const t=this._get("geometry");t!==e&&(this._set("geometry",e),this._notifyLayer("geometry",t,e))}set symbol(e){const t=this._get("symbol");t!==e&&(this._set("symbol",e),this._notifyLayer("symbol",t,e))}set visible(e){const t=this._get("visible");t!==e&&(this._set("visible",e),this._notifyLayer("visible",t,e))}getEffectivePopupTemplate(e=!1){return this.popupTemplate?this.popupTemplate:this.sourceLayer?"popupTemplate"in this.sourceLayer&&this.sourceLayer.popupTemplate?this.sourceLayer.popupTemplate:e&&"defaultPopupTemplate"in this.sourceLayer&&(0,n.pC)(this.sourceLayer.defaultPopupTemplate)?this.sourceLayer.defaultPopupTemplate:null:null}getAttribute(e){return this.attributes&&this.attributes[e]}setAttribute(e,t){if(this.attributes){const r=this.getAttribute(e);this.attributes[e]=t,this._notifyLayer("attributes",r,t,e)}else this.attributes={[e]:t},this._notifyLayer("attributes",void 0,t,e)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){return{geometry:(0,n.pC)(this.geometry)?this.geometry.toJSON():null,symbol:(0,n.pC)(this.symbol)?this.symbol.toJSON():null,attributes:{...this.attributes},popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}}clone(){return new s(this.cloneProperties())}cloneProperties(){return{attributes:(0,i.d9)(this.attributes),geometry:(0,i.d9)(this.geometry),layer:this.layer,popupTemplate:this.popupTemplate&&this.popupTemplate.clone(),sourceLayer:this.sourceLayer,symbol:(0,i.d9)(this.symbol),visible:this.visible}}_notifyLayer(e,t,r,s){if(!this.layer||!("graphicChanged"in this.layer))return;const o={graphic:this,property:e,oldValue:t,newValue:r};"attributes"===e&&(o.attributeName=s),this.layer.graphicChanged(o)}};(0,o._)([(0,a.Cb)({value:null})],d.prototype,"attributes",null),(0,o._)([(0,a.Cb)({value:null,types:c.qM,json:{read:u.im}})],d.prototype,"geometry",null),(0,o._)([(0,a.Cb)({type:Boolean})],d.prototype,"isAggregate",void 0),(0,o._)([(0,a.Cb)()],d.prototype,"layer",void 0),(0,o._)([(0,a.Cb)({type:f.default})],d.prototype,"popupTemplate",void 0),(0,o._)([(0,a.Cb)()],d.prototype,"sourceLayer",void 0),(0,o._)([(0,a.Cb)({value:null,types:y.s})],d.prototype,"symbol",null),(0,o._)([(0,a.Cb)({type:Boolean,value:!0})],d.prototype,"visible",null),d=s=(0,o._)([(0,l.j)("esri.Graphic")],d),(d||(d={})).generateUID=h.D;const g=d},47977:(e,t,r)=>{"use strict";r.d(t,{E:()=>o});class s{constructor(e={}){this._options=e}toQueryParams(e){if(!e)return null;const t=e.toJSON(),r={};return Object.keys(t).forEach((e=>{const s=this._options[e];if(s){const o="boolean"!=typeof s&&s.name?s.name:e,i="boolean"!=typeof s&&s.getter?s.getter(t):t[e];null!=i&&(r[o]=(e=>{if(!Array.isArray(e))return!1;const[t]=e;return"number"==typeof t||"string"==typeof t})(i)?i.join(","):"object"==typeof i?JSON.stringify(i):i)}else r[e]=t[e]}),this),r}}function o(e){return new s(e)}},32366:(e,t,r)=>{"use strict";r.d(t,{D:()=>o});let s=0;function o(){return s++}},91535:(e,t,r)=>{"use strict";r.d(t,{aX:()=>A,or:()=>P,hR:()=>M});var s=r(34926),o=r(59472),i=r(36544),n=r(32656),a=r(39105),l=r(27780),p=r(73032),u=r(41241),c=r(53817),f=r(93833),y=r(10923),h=r(56885),d=(r(36348),r(54721));async function g(e,t,r){const s="string"==typeof e?(0,y.mN)(e):e,o=t[0].spatialReference,i=(0,h.Ji)(t[0]),n={...r,query:{...s.query,f:"json",sr:o.wkid?o.wkid:JSON.stringify(o),geometries:JSON.stringify((a=t,{geometryType:(0,h.Ji)(a[0]),geometries:a.map((e=>e.toJSON()))}))}};var a;return function(e,t,r){const s=(0,h.q9)(t);return e.map((e=>{const t=s.fromJSON(e);return t.spatialReference=r,t}))}((await(0,d.default)(s.path+"/simplify",n)).data,i,o)}const m=i.Z.getLogger("esri.geometry.support.normalizeUtils"),v={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new f.Z({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:p.Z.WebMercator}),minus180Line:new f.Z({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:p.Z.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new f.Z({paths:[[[180,-180],[180,180]]],spatialReference:p.Z.WGS84}),minus180Line:new f.Z({paths:[[[-180,-180],[-180,180]]],spatialReference:p.Z.WGS84})}};function b(e){return"polygon"===e.type}function _(e){return"polyline"===e[0].type}function T(e){return b(e)?e.rings:e.paths}function w(e,t){return Math.ceil((e-t)/(2*t))}function S(e,t){const r=T(e);for(const e of r)for(const r of e)r[0]+=t;return e}function M(e,t){if(!(e instanceof f.Z||e instanceof c.Z)){const e="straightLineDensify: the input geometry is neither polyline nor polygon";throw m.error(e),new n.Z(e)}const r=T(e),s=[];for(const e of r){const r=[];s.push(r),r.push([e[0][0],e[0][1]]);for(let s=0;s<e.length-1;s++){const o=e[s][0],i=e[s][1],n=e[s+1][0],a=e[s+1][1],l=Math.sqrt((n-o)*(n-o)+(a-i)*(a-i)),p=(a-i)/l,u=(n-o)/l,c=l/t;if(c>1){for(let e=1;e<=c-1;e++){const s=e*t,n=u*s+o,a=p*s+i;r.push([n,a])}const e=(l+Math.floor(c-1)*t)/2,s=u*e+o,n=p*e+i;r.push([s,n])}r.push([n,a])}}return b(e)?new c.Z({rings:s,spatialReference:e.spatialReference}):new f.Z({paths:s,spatialReference:e.spatialReference})}function C(e,t,r){if(t){const t=M(e,1e6);e=(0,u.Sx)(t,!0)}return r&&(e=S(e,r)),e}function Z(e,t,r){if(Array.isArray(e)){const s=e[0];if(s>t){const r=w(s,t);e[0]=s+r*(-2*t)}else if(s<r){const t=w(s,r);e[0]=s+t*(-2*r)}}else{const s=e.x;if(s>t){const r=w(s,t);e=e.clone().offset(r*(-2*t),0)}else if(s<r){const t=w(s,r);e=e.clone().offset(t*(-2*r),0)}}return e}async function A(e,t,r){if(!Array.isArray(e))return A([e],t);const i=t?t.url:s.Z.geometryServiceUrl;let n,p,m,b,M,P,N,x,B=0;const O=[],J=[];for(const t of e)if((0,o.Wi)(t))J.push(t);else if(n||(n=t.spatialReference,p=(0,l.C5)(n),m=n.isWebMercator,P=m?102100:4326,b=v[P].maxX,M=v[P].minX,N=v[P].plus180Line,x=v[P].minus180Line),p)if("mesh"===t.type)J.push(t);else if("point"===t.type)J.push(Z(t.clone(),b,M));else if("multipoint"===t.type){const e=t.clone();e.points=e.points.map((e=>Z(e,b,M))),J.push(e)}else if("extent"===t.type){const e=t.clone()._normalize(!1,!1,p);J.push(e.rings?new c.Z(e):e)}else if(t.extent){const e=t.extent,r=w(e.xmin,M)*(2*b);let s=0===r?t.clone():S(t.clone(),r);e.offset(r,0),e.intersects(N)&&e.xmax!==b?(B=e.xmax>B?e.xmax:B,s=C(s,m),O.push(s),J.push("cut")):e.intersects(x)&&e.xmin!==M?(B=e.xmax*(2*b)>B?e.xmax*(2*b):B,s=C(s,m,360),O.push(s),J.push("cut")):J.push(s)}else J.push(t.clone());else J.push(t);let L=w(B,b),j=-90;const k=L,R=new f.Z;for(;L>0;){const e=360*L-180;R.addPath([[e,j],[e,-1*j]]),j*=-1,L--}if(O.length>0&&k>0){const t=function(e,t){let r=-1;for(let s=0;s<t.cutIndexes.length;s++){const o=t.cutIndexes[s],i=t.geometries[s],n=T(i);for(let e=0;e<n.length;e++){const t=n[e];t.some((r=>{if(r[0]<180)return!0;{let r=0;for(let e=0;e<t.length;e++){const s=t[e][0];r=s>r?s:r}r=Number(r.toFixed(9));const s=-360*w(r,180);for(let r=0;r<t.length;r++){const t=i.getPoint(e,r);i.setPoint(e,r,t.clone().offset(s,0))}return!0}}))}if(o===r){if("polygon"===e[0].type)for(const t of T(i))e[o]=e[o].addRing(t);else if(_(e))for(const t of T(i))e[o]=e[o].addPath(t)}else r=o,e[o]=i}return e}(O,await async function(e,t,r,s){const o="string"==typeof e?(0,y.mN)(e):e,i=t[0].spatialReference,n={...s,query:{...o.query,f:"json",sr:JSON.stringify(i),target:JSON.stringify({geometryType:(0,h.Ji)(t[0]),geometries:t}),cutter:JSON.stringify(r)}},a=await(0,d.default)(o.path+"/cut",n),{cutIndexes:l,geometries:p=[]}=a.data;return{cutIndexes:l,geometries:p.map((e=>{const t=(0,h.im)(e);return t.spatialReference=i,t}))}}(i,O,R,r)),s=[],n=[];for(let r=0;r<J.length;r++){const i=J[r];if("cut"!==i)n.push(i);else{const i=t.shift(),a=e[r];(0,o.pC)(a)&&"polygon"===a.type&&a.rings&&a.rings.length>1&&i.rings.length>=a.rings.length?(s.push(i),n.push("simplify")):n.push(m?(0,u.$)(i):i)}}if(!s.length)return n;const a=await g(i,s,r),l=[];for(let e=0;e<n.length;e++){const t=n[e];"simplify"!==t?l.push(t):l.push(m?(0,u.$)(a.shift()):a.shift())}return l}const q=[];for(let e=0;e<J.length;e++){const t=J[e];if("cut"!==t)q.push(t);else{const e=O.shift();q.push(!0===m?(0,u.$)(e):e)}}return(0,a.resolve)(q)}function P(e,t){const r=(0,l.C5)(t);if(r){const[t,s]=r.valid,o=s-t;if(e<t)for(;e<t;)e+=o;if(e>s)for(;e>s;)e-=o}return e}},62366:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>P});var s=r(56140),o=(r(95830),r(36544),r(68055),r(79881)),i=r(87566),n=(r(10923),r(57002),r(86035),r(39105)),a=r(54721),l=r(91535),p=r(95986),u=r(47977),c=r(10532),f=r(59472),y=r(30590),h=r(58385),d=r(73032),g=r(61106),m=r(53817),v=r(93833),b=r(56885),_=(r(36348),r(15988)),T=r(36405);function w(e){return e.features.map((t=>{const r=d.Z.fromJSON(e.spatialReference),s=_.Z.fromJSON(t);return(0,f.Wg)(s.geometry).spatialReference=r,s}))}function S(e){return e.features.map((t=>(t.geometry.spatialReference=e.spatialReference,(0,b.im)(t.geometry))))}let M=class extends h.wq{constructor(e){super(e),this.facilities=null,this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.serviceAreaPolylines=null,this.serviceAreaPolygons=null}readFacilities(e){return S(e)}readPointBarriers(e,t){return S(t.barriers)}readPolylineBarriers(e){return S(e)}readPolygonBarriers(e){return S(e)}readIncidents(e,t){return w(t.saPolylines)}readServiceAreaPolygons(e,t){return w(t.saPolygons)}};(0,s._)([(0,o.Cb)({type:[g.Z]})],M.prototype,"facilities",void 0),(0,s._)([(0,y.r)("facilities")],M.prototype,"readFacilities",null),(0,s._)([(0,o.Cb)({type:[T.Z]})],M.prototype,"messages",void 0),(0,s._)([(0,o.Cb)({type:[g.Z]})],M.prototype,"pointBarriers",void 0),(0,s._)([(0,y.r)("pointBarriers",["barriers"])],M.prototype,"readPointBarriers",null),(0,s._)([(0,o.Cb)({type:[v.Z]})],M.prototype,"polylineBarriers",void 0),(0,s._)([(0,y.r)("polylineBarriers")],M.prototype,"readPolylineBarriers",null),(0,s._)([(0,o.Cb)({type:[m.Z]})],M.prototype,"polygonBarriers",void 0),(0,s._)([(0,y.r)("polygonBarriers")],M.prototype,"readPolygonBarriers",null),(0,s._)([(0,o.Cb)({type:[_.Z]})],M.prototype,"serviceAreaPolylines",void 0),(0,s._)([(0,y.r)("serviceAreaPolylines",["saPolylines"])],M.prototype,"readIncidents",null),(0,s._)([(0,o.Cb)({type:[_.Z]})],M.prototype,"serviceAreaPolygons",void 0),(0,s._)([(0,y.r)("serviceAreaPolygons",["saPolygons"])],M.prototype,"readServiceAreaPolygons",null),M=(0,s._)([(0,i.j)("esri.tasks.support.ServiceAreaSolveResult")],M);const C=M,Z=(0,u.E)({accumulateAttributes:{name:"accumulateAttributeNames"},attributeParameterValues:!0,defaultBreaks:!0,facilities:!0,outSpatialReference:{name:"outSR",getter:e=>e.outSpatialReference.wkid},pointBarriers:{name:"barriers"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:"restrictionAttributeNames"},returnPointBarriers:{name:"returnBarriers"},travelMode:!0});let A=class extends((0,c.Y)(p.Z)){constructor(e){super(e),this.url=null}solve(e,t){const r=[],s=[],o={},i={};return e.facilities&&e.facilities.features&&this._collectGeometries(e.facilities.features,s,"facilities.features",o),e.pointBarriers&&e.pointBarriers.features&&this._collectGeometries(e.pointBarriers.features,s,"pointBarriers.features",o),e.polylineBarriers&&e.polylineBarriers.features&&this._collectGeometries(e.polylineBarriers.features,s,"polylineBarriers.features",o),e.polygonBarriers&&e.polygonBarriers.features&&this._collectGeometries(e.polygonBarriers.features,s,"polygonBarriers.features",o),(0,l.aX)(s).then((e=>{for(const t in o){const s=o[t];r.push(t),i[t]=e.slice(s[0],s[1])}return this._isInputGeometryZAware(i,r)?this.getServiceDescription():(0,n.resolve)({dontCheck:!0})})).then((s=>{("dontCheck"in s?s.dontCheck:s.hasZ)||this._dropZValuesOffInputGeometry(i,r);for(const t in i)i[t].forEach(((r,s)=>{e.get(t)[s].geometry=r}));let o={query:{...this.parsedUrl.query,f:"json",...Z.toQueryParams(e)}};return(this.requestOptions||t)&&(o={...this.requestOptions,...t,...o}),(0,a.default)(`${this.parsedUrl.path}/solveServiceArea`,o)})).then((e=>C.fromJSON(e.data)))}_collectGeometries(e,t,r,s){s[r]=[t.length,t.length+e.length],e.forEach((e=>{t.push(e.geometry)}))}};(0,s._)([(0,o.Cb)()],A.prototype,"url",void 0),A=(0,s._)([(0,i.j)("esri.tasks.ServiceAreaTask")],A);const P=A},95986:(e,t,r)=>{"use strict";r.d(t,{Z:()=>p});var s=r(56140),o=(r(95830),r(36544),r(68055),r(79881)),i=r(87566),n=r(10923),a=(r(57002),r(86035),r(82677));let l=class extends a.default{constructor(...e){super(...e),this.requestOptions=null,this.url=null}normalizeCtorArgs(e,t){return"string"!=typeof e?e:{url:e,...t}}get parsedUrl(){return this._parseUrl(this.url)}_parseUrl(e){return e?(0,n.mN)(e):null}_encode(e,t,r){const s={};for(const o in e){if("declaredClass"===o)continue;const i=e[o];if(null!=i&&"function"!=typeof i)if(Array.isArray(i)){s[o]=[];for(let e=0;e<i.length;e++)s[o][e]=this._encode(i[e])}else if("object"==typeof i)if(i.toJSON){const e=i.toJSON(r&&r[o]);s[o]=t?e:JSON.stringify(e)}else s[o]=t?i:JSON.stringify(i);else s[o]=i}return s}};(0,s._)([(0,o.Cb)({readOnly:!0,dependsOn:["url"]})],l.prototype,"parsedUrl",null),(0,s._)([(0,o.Cb)()],l.prototype,"requestOptions",void 0),(0,s._)([(0,o.Cb)({type:String})],l.prototype,"url",void 0),l=(0,s._)([(0,i.j)("esri.tasks.Task")],l);const p=l},10532:(e,t,r)=>{"use strict";r.d(t,{Y:()=>c});var s=r(56140),o=(r(95830),r(10103)),i=r(59472),n=(r(36544),r(68055),r(79881),r(87566)),a=r(32656),l=r(10923),p=(r(57002),r(86035),r(54721)),u=r(95986);const c=e=>{let t=class extends e{async getServiceDescription(){return this._serviceDescriptionPromise||(this._serviceDescriptionPromise=this._fetchServiceDescription()),this._serviceDescriptionPromise}async _fetchServiceDescription(){if(!this.url||!this.parsedUrl)throw new a.Z("network-service:missing-url","Url to Network service is missing");const e=this.url,{data:t}=await(0,p.default)(e,{query:{f:"json"}});t.supportedTravelModes||(t.supportedTravelModes=[]);for(let e=0;e<t.supportedTravelModes.length;e++)t.supportedTravelModes[e].id||(t.supportedTravelModes[e].id=t.supportedTravelModes[e].itemId);const r=t.currentVersion>=10.4?async function(e){try{const{data:{supportedTravelModes:t,defaultTravelMode:r}}=await(0,p.default)(e+("/"===e[e.length-1]?"":"/")+"retrieveTravelModes",{query:{f:"json"}});return{supportedTravelModes:t,defaultTravelMode:r}}catch(e){throw new a.Z("network-service:retrieveTravelModes","Could not get to the NAServer's retrieveTravelModes.",{error:e})}}(e):async function(e){const{data:t}=await(0,p.default)(e.substring(0,e.indexOf("/rest/")+6)+"info",{query:{f:"json"}});if(!t||!t.owningSystemUrl)return{supportedTravelModes:[],defaultTravelMode:null};e=t.owningSystemUrl;const{data:r}=await(0,p.default)(e+("/"===e[e.length-1]?"":"/")+"sharing/rest/portals/self",{query:{f:"json"}}),s=(0,o.hS)("helperServices.routingUtilities.url",r);if(!s)return{supportedTravelModes:[],defaultTravelMode:null};const i=(0,l.mN)(e),n=/\/solveClosestFacility$/.test(i.path)?"Route":/\/solveClosestFacility$/.test(i.path)?"ClosestFacility":"ServiceAreas",a=await(0,p.default)(s+("/"===s[s.length-1]?"":"/")+"GetTravelModes/execute",{query:{f:"json",serviceName:n}}),u=[];let c=null;if(a&&a.data&&a.data.results&&a.data.results.length){const e=a.data.results;for(const t of e)if("supportedTravelModes"===t.paramName){if(t.value&&t.value.features)for(const{attributes:e}of t.value.features)if(e){const t=JSON.parse(e.TravelMode);u.push(t)}}else"defaultTravelMode"===t.paramName&&(c=t.value)}return{supportedTravelModes:u,defaultTravelMode:c}}(e),{defaultTravelMode:s,supportedTravelModes:i}=await r;return t.defaultTravelMode=s,t.supportedTravelModes=i,t}_isInputGeometryZAware(e,t){for(let r=0;r<t.length;r++){const s=e[t[r]];if(s&&s.length)for(const e of s)if((0,i.pC)(e)&&e.hasZ)return!0}return!1}_dropZValuesOffInputGeometry(e,t){for(let r=0;r<t.length;r++){const s=e[t[r]];if(s&&s.length)for(const e of s)e.z=void 0}console.log("The remote Network Analysis service is powered by a network dataset which is not Z-aware.\nZ-coordinates of the input geometry are ignored.")}};return t=(0,s._)([(0,n.j)("esri.tasks.mixins.NAServiceDescription")],t),t};let f=class extends(c(u.Z)){};f=(0,s._)([(0,n.j)("esri.tasks.mixins.NAServiceDescription")],f)},21544:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var s=r(56140),o=(r(95830),r(36544),r(68055),r(79881)),i=r(56274),n=r(87566),a=(r(10923),r(57002),r(86035),r(58385));const l=new i.Xn({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"});let p=class extends a.wq{constructor(e){super(e),this.description=null,this.type=null}};(0,s._)([(0,o.Cb)({type:String,json:{write:!0}})],p.prototype,"description",void 0),(0,s._)([(0,o.Cb)({type:String,json:{read:l.read,write:l.write}})],p.prototype,"type",void 0),p=(0,s._)([(0,n.j)("esri.tasks.support.GPMessage")],p);const u=p},36405:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var s=r(56140),o=(r(95830),r(36544),r(68055),r(79881)),i=r(56274),n=r(87566),a=(r(10923),r(57002),r(86035),r(21544));const l=new i.Xn({0:"informative",1:"process-definition",2:"process-start",3:"process-stop",50:"warning",100:"error",101:"empty",200:"abort"});let p=class extends a.Z{constructor(e){super(e),this.type=null}};(0,s._)([(0,o.Cb)({type:String,json:{read:l.read,write:l.write}})],p.prototype,"type",void 0),p=(0,s._)([(0,n.j)("esri.tasks.support.NAMessage")],p);const u=p}}]);
//# sourceMappingURL=2366.js.map