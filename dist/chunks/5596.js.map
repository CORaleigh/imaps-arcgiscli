{"version":3,"sources":["webpack://imaps/./node_modules/@arcgis/core/views/draw/support/Reshape.js"],"names":["f","e","t","s","this","graphic","mover","selected","type","x","b","G","dx","dy","S","w","M","added","k","removed","H","i","oldGraphic","vertices","E","I","removeVertex","R","C","default","style","size","vertex","color","outline","outlineColor","width","hover","hoverSize","hoverColor","hoverOutlineColor","midpoints","midpoint","j","super","_handles","_graphicAttributes","esriSketchTool","_mover","_viewHandles","_totalDx","_totalDy","callbacks","enableMidpoints","handleGraphics","layer","midpointGraphics","midpointSymbol","selectedHandles","view","_setup","add","on","_keyDownHandler","refresh","_clearSelection","_resetGraphics","_reset","destroy","removeAll","get","_set","push","concat","length","includes","_removeVertex","_setupGraphics","_setupMover","_resetGraphicStateVars","cursor","removeMany","forEach","geometry","clone","pop","_createHandleGraphics","_createMidpointGraphics","_saveRelatedIndices","addMany","symbols","spatialReference","o","h","a","c","n","p","y","symbol","attributes","pathIndex","pointIndex","d","m","v","_","pointIndexStart","pointIndexEnd","map","r","relatedGraphicIndices","enableMoveAllGraphics","graphics","onGraphicClick","_onGraphicClickCallback","onGraphicMoveStart","_onGraphicMoveStartCallback","onGraphicMove","_onGraphicMoveCallback","onGraphicMoveStop","_onGraphicMoveStopCallback","onGraphicPointerOver","_onGraphicPointerOverCallback","onGraphicPointerOut","_onGraphicPointerOutCallback","viewEvent","stopPropagation","clearSelection","emit","_isMidpoint","button","_createHandleFromMidpoint","_emitVertexAddEvent","_isHandle","native","shiftKey","_removeFromSelection","_addToSelection","visible","_emitMoveStartEvent","_emitReshapeStartEvent","_emitMoveEvent","_syncGeometryAfterHandleMove","_emitReshapeEvent","_syncGraphicsWithGeometry","_emitMoveStopEvent","_emitReshapeStopEvent","paths","rings","_updateHandleGraphicLocations","_updateMidpointGraphicLocations","set","l","_isSelected","_updateHoverCursor","splice","coordinates","componentIndex","vertexIndex","Number","indexOf","_emitSelectEvent","_emitDeselectEvent","key","repeat","_removeHandles","_emitVertexRemoveEvent","onMoveStart","onMove","onMoveStop","onReshapeStart","onReshape","onReshapeStop","onVertexSelect","onVertexDeselect","onVertexAdd","onVertexRemove","prototype","readOnly","dependsOn","value"],"mappings":"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","file":"chunks/5596.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import{unwrap as t,get as s}from\"../../../core/maybe.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import r from\"../../../geometry/Point.js\";import{geometryToCoordinates as h,getMidpoint as a}from\"../../../geometry/support/coordsUtils.js\";import\"../../../geometry.js\";import c from\"../../../core/Evented.js\";import n from\"../../../symbols/SimpleMarkerSymbol.js\";import l from\"../../../Graphic.js\";import p from\"../../../core/Handles.js\";import{whenOnce as d,pausable as m}from\"../../../core/watchUtils.js\";import{ViewEventPriorities as v}from\"../../input/InputManager.js\";import{cloneMove as y}from\"./drawUtils.js\";import{addUniqueLayer as _}from\"./layerUtils.js\";import u from\"./GraphicMover.js\";import{settings as g}from\"./settings.js\";class f{constructor(e,t,s){this.graphic=e,this.mover=t,this.selected=s,this.type=\"reshape-start\"}}class x{constructor(e,t,s){this.graphic=e,this.mover=t,this.selected=s,this.type=\"reshape\"}}class b{constructor(e,t,s){this.graphic=e,this.mover=t,this.selected=s,this.type=\"reshape-stop\"}}class G{constructor(e,t,s){this.mover=e,this.dx=t,this.dy=s,this.type=\"move-start\"}}class S{constructor(e,t,s){this.mover=e,this.dx=t,this.dy=s,this.type=\"move\"}}class w{constructor(e,t,s){this.mover=e,this.dx=t,this.dy=s,this.type=\"move-stop\"}}class M{constructor(e){this.added=e,this.type=\"vertex-select\"}}class k{constructor(e){this.removed=e,this.type=\"vertex-deselect\"}}class H{constructor(e,t,s,i){this.added=e,this.graphic=t,this.oldGraphic=s,this.vertices=i,this.type=\"vertex-add\"}}class E{constructor(e,t,s,i){this.removed=e,this.graphic=t,this.oldGraphic=s,this.vertices=i,this.type=\"vertex-remove\"}}const I={removeVertex:[\"Backspace\",\"Delete\"]},R=g.reshapeGraphics,C={vertices:{default:new n({style:\"circle\",size:R.vertex.size,color:R.vertex.color,outline:{color:R.vertex.outlineColor,width:1}}),hover:new n({style:\"circle\",size:R.vertex.hoverSize,color:R.vertex.hoverColor,outline:{color:R.vertex.hoverOutlineColor,width:1}}),selected:new n({style:\"circle\",size:R.selected.size,color:R.selected.color,outline:{color:R.selected.outlineColor,width:1}})},midpoints:{default:new n({style:\"circle\",size:R.midpoint.size,color:R.midpoint.color,outline:{color:R.midpoint.outlineColor,width:1}}),hover:new n({style:\"circle\",size:R.midpoint.size,color:R.midpoint.color,outline:{color:R.midpoint.outlineColor,width:1}})}};let j=class extends c.EventedAccessor{constructor(e){super(e),this._handles=new p,this._graphicAttributes={esriSketchTool:\"box\"},this._mover=null,this._viewHandles=new p,this._totalDx=0,this._totalDy=0,this.callbacks={onReshapeStart(){},onReshape(){},onReshapeStop(){},onMoveStart(){},onMove(){},onMoveStop(){},onGraphicClick(){}},this.enableMidpoints=!0,this.graphic=null,this.handleGraphics=[],this.layer=null,this.midpointGraphics=[],this.midpointSymbol=new n({style:\"circle\",size:6,color:[200,200,200],outline:{color:[100,100,100],width:1}}),this.selectedHandles=[],this.type=\"reshape\",this.view=null}initialize(){this._setup(),this._handles.add([d(this,\"view.ready\",(()=>{const{layer:e,view:t}=this;_(t,e),this._viewHandles.add([t.on(\"key-down\",(e=>this._keyDownHandler(e)),v.TOOL)])})),m(this,\"graphic\",(()=>this.refresh())),m(this,\"layer\",((e,t)=>{t&&(this._clearSelection(),this._resetGraphics(t)),this.refresh()})),m(this,\"enableMidpoints\",(()=>{this.refresh()}))])}destroy(){this._reset(),this._mover&&this._mover.destroy(),this._mover=null,this._handles.removeAll(),this._handles=null,this._viewHandles.removeAll(),this._viewHandles=null}get state(){const e=!!this.get(\"view.ready\"),t=!(!this.get(\"graphic\")||!this.get(\"layer\"));return e&&t?\"active\":e?\"ready\":\"disabled\"}set symbols(e){const{midpoints:t=C.midpoints,vertices:s=C.vertices}=e||{};this._set(\"symbols\",{midpoints:t,vertices:s})}isUIGraphic(e){const t=[];return this.graphic&&t.push(this.graphic),t.concat(this.handleGraphics,this.midpointGraphics),t.length&&t.includes(e)}refresh(){this._reset(),this._setup()}reset(){this.graphic=null}clearSelection(){this._clearSelection()}removeSelectedHandles(){this.selectedHandles.length&&this._removeVertex(this.selectedHandles)}_setup(){this.graphic&&this.layer&&(this._setupGraphics(),this._setupMover())}_reset(){this._clearSelection(),this._resetGraphicStateVars(),this._resetGraphics(),this._mover&&this._mover.destroy(),this._mover=null,this.view.cursor=\"default\"}_resetGraphicStateVars(){this._totalDx=0,this._totalDy=0}_resetGraphics(e){const t=e||this.layer;t&&(t.removeMany(this.handleGraphics),t.removeMany(this.midpointGraphics)),this.handleGraphics.forEach((e=>e.destroy())),this.midpointGraphics.forEach((e=>e.destroy())),this._set(\"handleGraphics\",[]),this._set(\"midpointGraphics\",[]),this._set(\"selectedHandles\",[])}_setupGraphics(){const e=t(this.graphic.geometry),s=h(e.clone());if(\"polygon\"===e.type)for(const e of s){const t=e[e.length-1];e[0][0]===t[0]&&e[0][1]===t[1]&&e.length>2&&e.pop()}this._set(\"handleGraphics\",this._createHandleGraphics(s)),this.enableMidpoints&&this._set(\"midpointGraphics\",this._createMidpointGraphics(s)),this._saveRelatedIndices(this.handleGraphics),this.layer.addMany(this.midpointGraphics),this.layer.addMany(this.handleGraphics)}_createHandleGraphics(e){const{_graphicAttributes:t,symbols:s,view:{spatialReference:i}}=this,o=[];return null==e||e.forEach(((e,h)=>{e.forEach(((e,a)=>{var c;const[n,p]=e;o.push(new l({geometry:new r({x:n,y:p,spatialReference:i}),symbol:null==s||null==(c=s.vertices)?void 0:c.default,attributes:{...t,pathIndex:h,pointIndex:a}}))}))})),o}_createMidpointGraphics(e){const{_graphicAttributes:t,symbols:i,view:{spatialReference:o}}=this,h=[];return null==e||e.forEach(((e,c)=>{e.forEach(((n,p)=>{const[d,m]=n,v=e[p+1]?p+1:0;if(\"polygon\"===s(this.graphic.geometry,\"type\")||0!==v){const[s,n]=e[v],[y,_]=a([d,m],[s,n]);h.push(new l({geometry:new r({x:y,y:_,spatialReference:o}),symbol:i.midpoints.default,attributes:{...t,pathIndex:c,pointIndexStart:p,pointIndexEnd:v}}))}}))})),h}_saveRelatedIndices(e){if(!e)return;const t=e.map((({geometry:e})=>({x:e.x,y:e.y})));for(let s=0;s<t.length;s++){const i=[];for(let e=0;e<t.length;e++){if(s===e)continue;const o=t[s],r=t[e];o.x===r.x&&o.y===r.y&&i.push(e)}e[s].attributes.relatedGraphicIndices=i}}_setupMover(){this._mover=new u({enableMoveAllGraphics:!1,graphics:[].concat(this.handleGraphics,this.midpointGraphics,this.graphic),view:this.view,callbacks:{onGraphicClick:e=>this._onGraphicClickCallback(e),onGraphicMoveStart:e=>this._onGraphicMoveStartCallback(e),onGraphicMove:e=>this._onGraphicMoveCallback(e),onGraphicMoveStop:e=>this._onGraphicMoveStopCallback(e),onGraphicPointerOver:e=>this._onGraphicPointerOverCallback(e),onGraphicPointerOut:e=>this._onGraphicPointerOutCallback(e)}})}_onGraphicClickCallback(e){e.viewEvent.stopPropagation();const t=e.graphic;if(t===this.graphic)this.clearSelection(),this.emit(\"graphic-click\",e),this.callbacks.onGraphicClick&&this.callbacks.onGraphicClick(e);else if(this._isMidpoint(t)){if(2===e.viewEvent.button)return;const s=this.graphic.clone(),i=this._createHandleFromMidpoint(t);this.refresh(),this._emitVertexAddEvent([t],s,i)}else if(this._isHandle(t))if(e.viewEvent.stopPropagation(),2===e.viewEvent.button)this._removeVertex(t);else{e.viewEvent.native.shiftKey||this._clearSelection(),this.selectedHandles.includes(t)?this._removeFromSelection(t,!0):this._addToSelection(t)}}_onGraphicMoveStartCallback(e){const t=e.graphic;if(this._resetGraphicStateVars(),t===this.graphic){const{dx:t,dy:s}=e;return this.handleGraphics.forEach((e=>e.visible=!1)),this.midpointGraphics.forEach((e=>e.visible=!1)),this._clearSelection(),void this._emitMoveStartEvent(t,s)}if(this._isMidpoint(t)){this._clearSelection();const e=this.graphic.clone(),s=this._createHandleFromMidpoint(t);this._emitVertexAddEvent([t],e,s),this._addToSelection(t)}else this.selectedHandles.includes(t)||(this._clearSelection(),this._addToSelection(t));this._emitReshapeStartEvent(t)}_onGraphicMoveCallback(e){const{graphic:t,dx:s,dy:i}=e;this._totalDx+=s,this._totalDy+=i,t===this.graphic?this._emitMoveEvent(s,i):(this._syncGeometryAfterHandleMove(t,s,i),this._emitReshapeEvent(t))}_onGraphicMoveStopCallback(e){const{graphic:t,dx:s,dy:i}=e;if(this._totalDx+=s,this._totalDy+=i,t===this.graphic){for(const e of[].concat(this.handleGraphics,this.midpointGraphics))e.visible=!0;this._syncGraphicsWithGeometry(),this._emitMoveStopEvent()}else this._syncGeometryAfterHandleMove(t,s,i),this._isMidpoint(t)&&this.refresh(),this._emitReshapeStopEvent(t);this._resetGraphicStateVars()}_syncGraphicsWithGeometry(){const e=this.graphic.geometry,t=\"polyline\"===e.type?e.paths:e.rings;this._updateHandleGraphicLocations(t),this._updateMidpointGraphicLocations(t)}_updateHandleGraphicLocations(e){for(const t of this.handleGraphics){const{pathIndex:s,pointIndex:i}=t.attributes,[o,h]=e[s][i];t.set(\"geometry\",new r(o,h,this.view.spatialReference))}}_updateMidpointGraphicLocations(e){for(const t of this.midpointGraphics){const{pathIndex:s,pointIndexStart:i,pointIndexEnd:o}=t.attributes,[h,c]=e[s][i],[n,l]=e[s][o],[p,d]=a([h,c],[n,l]);t.geometry=new r({x:p,y:d,spatialReference:this.view.spatialReference})}}_syncGeometryAfterHandleMove(e,s,i){const o=t(this.graphic.geometry).clone(),r=\"polyline\"===o.type?o.paths:o.rings,{pathIndex:h,pointIndex:a}=e.attributes,{x:c,y:n}=e.geometry,l=r[h].length-1;if(r[h][a]=[c,n],\"polygon\"===o.type&&(0===a?r[h][l]=[c,n]:a===l&&(r[h][0]=[c,n])),this._isHandle(e)){const{relatedGraphicIndices:t}=e.attributes;for(const s of t){const t=this.handleGraphics[s],{pathIndex:i,pointIndex:o}=t.attributes;r[i][o]=[c,n],t.geometry=e.geometry}for(const t of this.selectedHandles)if(t!==e){const{pathIndex:e,pointIndex:h,relatedGraphicIndices:a}=t.attributes,c=y(t.geometry,s,i,this.view),n=r[e].length-1;r[e][h]=[c.x,c.y],t.geometry=c,\"polygon\"===o.type&&(0===h?r[e][n]=[c.x,c.y]:h===n&&(r[e][0]=[c.x,c.y]));for(const e of a){const t=this.handleGraphics[e],{pathIndex:s,pointIndex:i}=t.attributes;r[s][i]=[c.x,c.y],t.geometry=c}}this._updateMidpointGraphicLocations(r)}this.graphic.geometry=o}_onGraphicPointerOverCallback(e){const t=e.graphic;this._isHandle(t)&&!this._isSelected(t)&&(t.symbol=this.symbols.vertices.hover),this._updateHoverCursor(t)}_onGraphicPointerOutCallback(e){const t=e.graphic;this._isHandle(t)&&!this._isSelected(t)&&(t.symbol=this.symbols.vertices.default),this.view.cursor=\"default\"}_createHandleFromMidpoint(e){const{_graphicAttributes:s}=this,i=[],o=t(this.graphic.geometry).clone(),{pathIndex:r,pointIndexStart:h,pointIndexEnd:a}=e.attributes,{x:c,y:n}=e.geometry,l=0===a?h+1:a,p=\"polyline\"===o.type?o.paths:o.rings;return p[r].splice(l,0,[c,n]),e.attributes={...s,pathIndex:r,pointIndex:l,relatedGraphicIndices:[]},i.push({coordinates:p[r][l],componentIndex:r,vertexIndex:l}),this.graphic.geometry=o,i}_removeHandles(e){const s=t(this.graphic.geometry).clone(),i=\"polygon\"===s.type?s.rings:s.paths,o=[];e instanceof l&&(e=[e]);for(const t of e){const{x:e,y:s}=t.geometry;for(let t=0;t<i.length;t++){const r=i[t];for(let h=0;h<r.length;h++){const[a,c]=r[h];e===a&&s===c&&(o.push({coordinates:i[t][h],componentIndex:t,vertexIndex:h}),i[t].splice(Number(h),1))}}}if(\"polygon\"===s.type)for(const e of i){const[t,s]=e[0],[o,r]=e[e.length-1];(1===e.length||e.length<3&&t===o&&s===r)&&i.splice(i.indexOf(e),1),e.length>2&&(t!==o||s!==r)&&e.push(e[0])}else for(const e of i)1===e.length&&i.splice(i.indexOf(e),1);return this.graphic.geometry=s,o}_addToSelection(e){e instanceof l&&(e=[e]);for(const t of e)t.symbol=this.symbols.vertices.selected;this._set(\"selectedHandles\",this.selectedHandles.concat(e)),this._emitSelectEvent(e)}_removeFromSelection(e,t){const{vertices:s}=this.symbols,i=t?s.hover:s.default;e instanceof l&&(e=[e]);for(const t of e)this.selectedHandles.splice(this.selectedHandles.indexOf(t),1),this._set(\"selectedHandles\",this.selectedHandles),t.set(\"symbol\",i);this._emitDeselectEvent(e)}_clearSelection(){if(this.selectedHandles.length){const e=this.selectedHandles;for(const e of this.selectedHandles)e.set(\"symbol\",this.symbols.vertices.default);this._set(\"selectedHandles\",[]),this._emitDeselectEvent(e)}}_keyDownHandler(e){I.removeVertex.includes(e.key)&&!e.repeat&&this.selectedHandles.length&&this._removeVertex(this.selectedHandles)}_removeVertex(e){if(\"polygon\"===this.graphic.geometry.type&&this.handleGraphics.length<4||this.handleGraphics.length<3)return;const t=this.graphic.clone();e instanceof l&&(e=[e]);const s=this._removeHandles(e);this.refresh(),this._emitVertexRemoveEvent(e,t,s)}_isHandle(e){return this.handleGraphics.includes(e)}_isSelected(e){return this._isHandle(e)&&this.selectedHandles.includes(e)}_isMidpoint(e){return this.midpointGraphics.includes(e)}_updateHoverCursor(e){this.view.cursor=this._isMidpoint(e)?\"copy\":\"move\"}_emitMoveStartEvent(e,t){const s=new G(this.graphic,e,t);this.emit(\"move-start\",s),this.callbacks.onMoveStart&&this.callbacks.onMoveStart(s)}_emitMoveEvent(e,t){const s=new S(this.graphic,e,t);this.emit(\"move\",s),this.callbacks.onMove&&this.callbacks.onMove(s)}_emitMoveStopEvent(){const e=new w(this.graphic,this._totalDx,this._totalDy);this.emit(\"move-stop\",e),this.callbacks.onMoveStop&&this.callbacks.onMoveStop(e)}_emitReshapeStartEvent(e){const t=new f(this.graphic,e,this.selectedHandles);this.emit(\"reshape-start\",t),this.callbacks.onReshapeStart&&this.callbacks.onReshapeStart(t)}_emitReshapeEvent(e){const t=new x(this.graphic,e,this.selectedHandles);this.emit(\"reshape\",t),this.callbacks.onReshape&&this.callbacks.onReshape(t)}_emitReshapeStopEvent(e){const t=new b(this.graphic,e,this.selectedHandles);this.emit(\"reshape-stop\",t),this.callbacks.onReshapeStop&&this.callbacks.onReshapeStop(t)}_emitSelectEvent(e){const t=new M(e);this.emit(\"select\",t),this.callbacks.onVertexSelect&&this.callbacks.onVertexSelect(t)}_emitDeselectEvent(e){const t=new k(e);this.emit(\"deselect\",t),this.callbacks.onVertexDeselect&&this.callbacks.onVertexDeselect(t)}_emitVertexAddEvent(e,t,s){const i=new H(e,this.graphic,t,s);this.emit(\"vertex-add\",i),this.callbacks.onVertexAdd&&this.callbacks.onVertexAdd(i)}_emitVertexRemoveEvent(e,t,s){const i=new E(e,this.graphic,t,s);this.emit(\"vertex-remove\",i),this.callbacks.onVertexRemove&&this.callbacks.onVertexRemove(i)}};e([i()],j.prototype,\"callbacks\",void 0),e([i()],j.prototype,\"enableMidpoints\",void 0),e([i()],j.prototype,\"graphic\",void 0),e([i({readOnly:!0})],j.prototype,\"handleGraphics\",void 0),e([i()],j.prototype,\"layer\",void 0),e([i({readOnly:!0})],j.prototype,\"midpointGraphics\",void 0),e([i()],j.prototype,\"midpointSymbol\",void 0),e([i({readOnly:!0})],j.prototype,\"selectedHandles\",void 0),e([i({dependsOn:[\"view.ready\",\"graphic\",\"layer\"],readOnly:!0})],j.prototype,\"state\",null),e([i({value:C})],j.prototype,\"symbols\",null),e([i({readOnly:!0})],j.prototype,\"type\",void 0),e([i()],j.prototype,\"view\",void 0),j=e([o(\"esri.views.draw.support.Reshape\")],j);var V=j;export default V;\n"],"sourceRoot":""}