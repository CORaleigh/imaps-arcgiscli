(self.webpackChunkimaps=self.webpackChunkimaps||[]).push([[5062,5883,6194],{93352:(e,t,n)=>{"use strict";n.d(t,{C:()=>p,b:()=>u});var i=n(85461),r=n(62213),a=n(51219),s=n(63230),o=n(61514),l=n(72023),c=n(34658),d=n(11823),h=n(83488);function u(e){const t=new a.kG,n=1===e.output;return t.include(r.w,{linearDepth:n}),t.include(d.c,e),t.vertex.uniforms.add("proj","mat4").add("view","mat4"),t.attributes.add("position","vec3"),t.varyings.add("vpos","vec3"),n&&(t.include(h.F,e),t.vertex.uniforms.add("nearFar","vec2"),t.varyings.add("linearDepth","float")),t.vertex.code.add(i.H`
    void main(void) {
      vpos = position;
      forwardNormalizedVertexColor();
      gl_Position = ${n?i.H`transformPositionWithDepth(proj, view, vpos, nearFar, linearDepth);`:i.H`transformPosition(proj, view, vpos);`}
    }
  `),t.include(o.p,e),t.fragment.include(s.Y),t.fragment.uniforms.add("eColor","vec4"),4===e.output&&t.include(l.b),t.fragment.code.add(i.H`
  void main() {
    discardBySlice(vpos);
    vec4 color = ${e.attributeColor?"vColor * eColor;":"eColor;"}

    if (color.a < ${i.H.float(c.bf)}) {
      discard;
    }

    ${7===e.output?i.H`gl_FragColor = vec4(color.a);`:""}

    ${0===e.output?i.H`gl_FragColor = highlightSlice(color, vpos); ${e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}`:""}
    ${4===e.output?i.H`outputHighlight();`:""};
    ${1===e.output?i.H`outputDepth(linearDepth);`:""};
  }
  `),t}var p=Object.freeze({__proto__:null,build:u})},57086:(e,t,n)=>{"use strict";n.d(t,{L:()=>o,b:()=>s});var i=n(85461),r=n(51219),a=n(62692);function s(e){const t=new r.kG;return t.include(a.j,e),t.vertex.uniforms.add("uModelViewMatrix","mat4"),t.vertex.uniforms.add("uProjectionMatrix","mat4"),t.attributes.add("start","vec3"),t.attributes.add("end","vec3"),t.attributes.add("up","vec3"),t.attributes.add("extrude","vec2"),t.varyings.add("uv","vec2"),t.varyings.add("vViewStart","vec3"),t.varyings.add("vViewEnd","vec3"),t.varyings.add("vViewPlane","vec4"),t.vertex.uniforms.add("glowWidth","float"),t.vertex.uniforms.add("pixelToNDC","vec2"),t.vertex.code.add(i.H`
  void main() {
    vec3 pos = mix(start, end, extrude.x);

    vec4 viewPos = uModelViewMatrix * vec4(pos, 1);
    vec4 projPos = uProjectionMatrix * viewPos;
    vec2 ndcPos = projPos.xy / projPos.w;

    vec3 viewUp = (uModelViewMatrix * vec4(extrude.y * up, 0)).xyz;
    vec4 projPosUp = uProjectionMatrix * vec4(viewPos.xyz + viewUp, 1);
    vec2 projExtrudeDir = normalize(projPosUp.xy / projPosUp.w - ndcPos);

    vec2 lxy = abs(sign(projExtrudeDir) - ndcPos);
    ndcPos += length(lxy) * projExtrudeDir;

    vec3 worldPlaneNormal = normalize(cross(up, normalize(end - start)));
    vec3 viewPlaneNormal = (uModelViewMatrix * vec4(worldPlaneNormal, 0)).xyz;

    vViewStart = (uModelViewMatrix * vec4(start, 1)).xyz;
    vViewEnd = (uModelViewMatrix * vec4(end, 1)).xyz;
    vViewPlane = vec4(viewPlaneNormal, -dot(viewPlaneNormal, vViewStart));

    // Add enough padding in the X screen space direction for glow
    float xPaddingPixels = sign(dot(viewPlaneNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;
    ndcPos.x += xPaddingPixels * pixelToNDC.x;

    uv = ndcPos * 0.5 + 0.5;
    gl_Position = vec4(ndcPos, 0, 1);
  }
  `),t.fragment.uniforms.add("globalAlpha","float"),t.fragment.uniforms.add("perScreenPixelRatio","float"),t.fragment.code.add(i.H`
  float planeDistancePixels(vec4 plane, vec3 pos, vec3 start, vec3 end) {
    vec3 origin = mix(start, end, 0.5);
    vec3 basis = end - origin;
    vec3 posAtOrigin = pos - origin;

    float x = dot(normalize(basis), posAtOrigin);
    float y = dot(plane.xyz, posAtOrigin);

    float dx = max(abs(x) - length(basis), 0.0);
    float dy = y;

    float dist = length(vec2(dx, dy));

    float width = fwidth(y);
    float maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;
    float pixelDist = dist / min(width, maxPixelDistance);
    return abs(pixelDist);
  }

  void main() {
    vec3 pos;
    vec3 normal;
    float depthDiscontinuityAlpha;

    if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
      discard;
    }

    float distance = planeDistancePixels(vViewPlane, pos, vViewStart, vViewEnd);

    vec4 color = laserlineProfile(distance);
    float alpha = 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, vViewPlane.xyz)));

    gl_FragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);
  }
  `),t}var o=Object.freeze({__proto__:null,build:s})},56396:(e,t,n)=>{"use strict";n.d(t,{L:()=>d,b:()=>c,d:()=>l});var i=n(33655),r=n(85461),a=n(51219),s=n(84444),o=n(62692);const l=(0,i.Vl)(6);function c(e){const t=new a.kG;return t.extensions.add("GL_OES_standard_derivatives"),t.include(s.k),t.include(o.j,e),t.fragment.uniforms.add("angleCutoff","vec2"),t.fragment.uniforms.add("globalAlpha","float"),e.heightManifoldEnabled&&t.fragment.uniforms.add("heightPlane","vec4"),e.pointDistanceEnabled&&t.fragment.uniforms.add("pointDistanceSphere","vec4"),e.lineVerticalPlaneEnabled&&t.fragment.uniforms.add("lineVerticalPlane","vec4").add("lineVerticalStart","vec3").add("lineVerticalEnd","vec3"),(e.heightManifoldEnabled||e.pointDistanceEnabled||e.lineVerticalPlaneEnabled)&&t.fragment.uniforms.add("maxPixelDistance","float"),e.intersectsLineEnabled&&t.fragment.uniforms.add("intersectsLineStart","vec3").add("intersectsLineEnd","vec3").add("intersectsLineDirection","vec3").add("intersectsLineRadius","float").add("perScreenPixelRatio","float"),(e.lineVerticalPlaneEnabled||e.heightManifoldEnabled)&&t.fragment.code.add(r.H`
      float planeDistancePixels(vec4 plane, vec3 pos) {
        float dist = dot(plane.xyz, pos) + plane.w;
        float width = fwidth(dist);
        dist /= min(width, maxPixelDistance);
        return abs(dist);
      }`),e.pointDistanceEnabled&&t.fragment.code.add(r.H`
    float sphereDistancePixels(vec4 sphere, vec3 pos) {
      float dist = distance(sphere.xyz, pos) - sphere.w;
      float width = fwidth(dist);
      dist /= min(width, maxPixelDistance);
      return abs(dist);
    }
    `),e.intersectsLineEnabled&&t.fragment.code.add(r.H`
    float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {
      float dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);
      return abs(dist) - radius;
    }
    `),(e.lineVerticalPlaneEnabled||e.intersectsLineEnabled)&&t.fragment.code.add(r.H`
    bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {
      vec3 dir = end - start;
      float t2 = dot(dir, pos - start);
      float l2 = dot(dir, dir);
      return t2 >= 0.0 && t2 <= l2;
    }
    `),t.fragment.code.add(r.H`
  void main() {
    vec3 pos;
    vec3 normal;
    float depthDiscontinuityAlpha;

    if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
      discard;
    }

    vec4 color = vec4(0, 0, 0, 0);
  `),e.heightManifoldEnabled&&t.fragment.code.add(r.H`
    {
      float heightManifoldAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, heightPlane.xyz)));
      vec4 heightManifoldColor = laserlineProfile(planeDistancePixels(heightPlane, pos));
      color = max(color, heightManifoldColor * heightManifoldAlpha);
    }
    `),e.pointDistanceEnabled&&t.fragment.code.add(r.H`
    {
      // distance to sphere
      float pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);
      vec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);
      float pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));

      color = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);
    }
    `),e.lineVerticalPlaneEnabled&&t.fragment.code.add(r.H`
    {
      if (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {
        float lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);

        vec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);
        float lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));

        color = max(color, lineVerticalColor * lineVerticalAlpha);
      }
    }
    `),e.intersectsLineEnabled&&t.fragment.code.add(r.H`
    {
      if (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {
        float intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);
        vec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);
        float intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));

        color = max(color, intersectsLineColor * intersectsLineAlpha);
      }
    }
    `),t.fragment.code.add(r.H`
    gl_FragColor = laserlineOutput(color * depthDiscontinuityAlpha);
  }
  `),t}var d=Object.freeze({__proto__:null,defaultAngleCutoff:l,build:c})},81632:(e,t,n)=>{"use strict";n.d(t,{R:()=>p,b:()=>u});var i=n(85461),r=n(51219),a=n(63230),s=n(61514),o=n(34658),l=n(83488),c=n(82768),d=n(93077),h=n(9295);function u(e){const t=new r.kG;t.extensions.add("GL_OES_standard_derivatives"),t.include(h.e),t.include(c.U,e),t.include(d.q,e),1===e.output&&t.include(l.F,e),t.vertex.uniforms.add("proj","mat4").add("view","mat4").add("nearFar","vec2").add("pixelRatio","float").add("miterLimit","float").add("screenSize","vec2"),t.attributes.add("position","vec3"),t.attributes.add("subdivisionFactor","float"),t.attributes.add("uv0","vec2"),t.attributes.add("auxpos1","vec3"),t.attributes.add("auxpos2","vec3"),t.varyings.add("vColor","vec4"),t.varyings.add("vpos","vec3"),t.varyings.add("linearDepth","float");const n=e.falloffEnabled,u=e.innerColorEnabled;return u&&t.varyings.add("vLineDistance","float"),n&&t.varyings.add("vLineDistanceNorm","float"),e.falloffEnabled&&t.fragment.uniforms.add("falloff","float"),e.innerColorEnabled&&(t.fragment.uniforms.add("innerColor","vec4"),t.fragment.uniforms.add("innerWidth","float")),t.vertex.code.add(i.H`
		#define PERPENDICULAR(v) vec2(v.y, -v.x);
		#define ISOUTSIDE (left.x * right.y - left.y * right.x)*uv0.y > 0.0

		float interp(float ncp, vec4 a, vec4 b) {
			return (-ncp - a.z) / (b.z - a.z);
		}

		vec2 rotate(vec2 v, float a) {
			float s = sin(a);
			float c = cos(a);
			mat2 m = mat2(c, -s, s, c);
			return m * v;
		}
`),t.vertex.code.add(i.H`
    vec4 projectAndScale(vec4 pos) {
      vec4 posNdc = proj * pos;

      // Note that posNdc is in -1:1, scaling by screenSize converts this to a coordinate system
      // that is twice scaled (going from -size:size).
      posNdc.xy *= screenSize / posNdc.w;
      return posNdc;
    }
`),t.vertex.code.add(i.H`
    void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next, in bool isStartVertex) {
      float vnp = nearFar[0] * 0.99;

      //current pos behind ncp --> we need to clip
      if(pos.z > -nearFar[0]) {
        if (!isStartVertex) {
          //previous in front of ncp
          if(prev.z < -nearFar[0]) {
            pos = mix(prev, pos, interp(vnp, prev, pos));
            next = pos;
          } else {
            pos = vec4(0.0, 0.0, 0.0, 1.0);
          }
        }
        //next in front of ncp
        if(isStartVertex) {
          if(next.z < -nearFar[0]) {
            pos = mix(pos, next, interp(vnp, pos, next));
            prev = pos;
          } else {
            pos = vec4(0.0, 0.0, 0.0, 1.0);
          }
        }
      } else {
        //current position visible
        //previous behind ncp
        if (prev.z > -nearFar[0]) {
          prev = mix(pos, prev, interp(vnp, pos, prev));
        }
        //next behind ncp
        if (next.z > -nearFar[0]) {
          next = mix(next, pos, interp(vnp, next, pos));
        }
      }

      linearDepth = (-pos.z - nearFar[0]) / (nearFar[1] - nearFar[0]);

      pos = projectAndScale(pos);
      next = projectAndScale(next);
      prev = projectAndScale(prev);
    }
`),t.vertex.code.add(i.H`
  void main(void) {
    float coverage = 1.0;
    vpos = position;

    // Check for special value of uv0.y which is used by the Renderer when graphics
    // are removed before the VBO is recompacted. If this is the case, then we just
    // project outside of clip space.
    if (uv0.y == 0.0) {
      // Project out of clip space
      gl_Position = vec4(1e038, 1e038, 1e038, 1.0);
    }
    else {
      bool isStartVertex = abs(abs(uv0.y)-3.0) == 1.0;
      bool isJoin = abs(uv0.y)-3.0 < 0.0;

      float lineWidth = getSize() * pixelRatio;

      // convert sub-pixel coverage to alpha
      if (lineWidth < 1.0) {
        coverage = lineWidth;
        lineWidth = 1.0;
      }else{
        // Ribbon lines cannot properly render non-integer sizes. Round width to integer size if
        // larger than one for better quality. Note that we do render < 1 pixels more or less correctly
        // so we only really care to round anything larger than 1.
        lineWidth = floor(lineWidth + 0.5);
      }

      vec4 pos  = view * vec4(position.xyz, 1.0);
      vec4 prev = view * vec4(auxpos1.xyz, 1.0);
      vec4 next = view * vec4(auxpos2.xyz, 1.0);

      clipAndTransform(pos, prev, next, isStartVertex);

      vec2 left = (pos.xy - prev.xy);
      vec2 right = (next.xy - pos.xy);

      float leftLen = length(left);
      float rightLen = length(right);
  `),e.stippleEnabled&&t.vertex.code.add(i.H`
      // uv0.x is either 0 or 1, depending on whether this is considered the start of a line segment
      // or the end. If start, then use pos->next, otherwise use prev->pos to define the line segment
      // vector
      vec4 stippleSegmentInfo = mix(vec4(pos.xy, right), vec4(prev.xy, left), uv0.x);
      vec2 stippleSegmentOrigin = stippleSegmentInfo.xy;

      // Scale s.t. it's in units of stipple pattern size.
      vec2 stippleSegmentDirection = stippleSegmentInfo.zw;
    `),t.vertex.code.add(i.H`
    left = (leftLen > 0.001) ? left/leftLen : vec2(0.0, 0.0);
    right = (rightLen > 0.001) ? right/rightLen : vec2(0.0, 0.0);

    vec2 capDisplacementDir = vec2(0, 0);
    vec2 joinDisplacementDir = vec2(0, 0);
    float displacementLen = lineWidth;

    if (isJoin) {

      // JOIN handling ---------------------------------------------------
      // determine if vertex is on the "outside or "inside" of the join
      bool isOutside = ISOUTSIDE;

      // compute miter join position first
      joinDisplacementDir = normalize(left + right);
      joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);

      // compute miter stretch
      if (leftLen > 0.001 && rightLen > 0.001) {
        float nDotSeg = dot(joinDisplacementDir, left);
        displacementLen /= length(nDotSeg * left - joinDisplacementDir);

        // limit displacement of inner vertices
        if (!isOutside) {
          displacementLen = min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));
        }
      }

      if (isOutside && (displacementLen > miterLimit * lineWidth)) {
    `),e.roundJoins?t.vertex.code.add(i.H`
        vec2 startDir;
        vec2 endDir;

        if (leftLen < 0.001) {
          startDir = right;
        }
        else{
          startDir = left;
        }
        startDir = normalize(startDir);
        startDir = PERPENDICULAR(startDir);

        if (rightLen < 0.001) {
          endDir = left;
        }
        else{
          endDir = right;
        }
        endDir = normalize(endDir);
        endDir = PERPENDICULAR(endDir);

        float rotationAngle = acos(clamp(dot(startDir, endDir), -1.0, 1.0));
        joinDisplacementDir = rotate(startDir, -sign(uv0.y) * subdivisionFactor * rotationAngle);
      `):t.vertex.code.add(i.H`
        // convert to bevel join if miterLimit is exceeded
        if (leftLen < 0.001) {
          joinDisplacementDir = right;
        }
        else if (rightLen < 0.001) {
          joinDisplacementDir = left;
        }
        else {
          joinDisplacementDir = isStartVertex ? right : left;
        }
        joinDisplacementDir = normalize(joinDisplacementDir);
        joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);
  `),t.vertex.code.add(i.H`
        displacementLen = lineWidth;
      }
    } else {
    // CAP handling ---------------------------------------------------
    if (leftLen < 0.001) {
      joinDisplacementDir = right;
    }
    else if (rightLen < 0.001) {
      joinDisplacementDir = left;
    }
    else {
      joinDisplacementDir = isStartVertex ? right : left;
    }
    joinDisplacementDir = normalize(joinDisplacementDir);
    joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);
    displacementLen = lineWidth;

    capDisplacementDir = isStartVertex ? -right : left;
  `),e.roundCaps?t.vertex.code.add(i.H`
    float angle = subdivisionFactor*PI*0.5;
    joinDisplacementDir *= cos(angle);
    capDisplacementDir *= sin(angle);
    `):t.vertex.code.add(i.H`
    capDisplacementDir *= subdivisionFactor;
    `),t.vertex.code.add(i.H`
  }

  // Displacement (in pixels) caused by join/or cap
  vec2 dpos = joinDisplacementDir * sign(uv0.y) * displacementLen + capDisplacementDir * displacementLen;

  ${n||u?i.H`float lineDist = lineWidth * sign(uv0.y) * pos.w;`:""}

  ${u?i.H`vLineDistance = lineDist;`:""}
  ${n?i.H`vLineDistanceNorm = lineDist / lineWidth;`:""}

  pos.xy += dpos;
  `),e.stippleEnabled&&(t.vertex.code.add(i.H`
    {
      // Compute the stipple pattern UV coordinate from the actual position, based on the origin
      // and direction of the line segment on which the stipple pattern is based.

      // Project the vector from the origin of the segment to the vertex onto the line segment.
      // Note the 0.5 factor due to projected positions being at twice the screen size scale (see projectAndScale)
      vec2 posVec = pos.xy - stippleSegmentOrigin;

      float stippleSegmentDirectionLength = length(stippleSegmentDirection);
    `),e.stippleIntegerRepeatsEnabled&&t.vertex.code.add(i.H`
      float numberOfPatternRepeats = stippleSegmentDirectionLength * 0.5 * stipplePatternPixelSizeInv;
      float roundedNumberOfPatternRepeats = floor(numberOfPatternRepeats);
      stipplePatternUvMax = roundedNumberOfPatternRepeats;
      `),t.vertex.code.add(i.H`
      if (stippleSegmentDirectionLength >= 0.001) {
        // Project the vertex position onto the line segment.
        float projectedLength = dot(stippleSegmentDirection, posVec) / stippleSegmentDirectionLength * 0.5;
     ${e.stippleIntegerRepeatsEnabled?"float wholeNumberOfRepeatsScale = roundedNumberOfPatternRepeats / numberOfPatternRepeats;":"float wholeNumberOfRepeatsScale = 1.0;"}
        stipplePatternUv = projectedLength * wholeNumberOfRepeatsScale * stipplePatternPixelSizeInv * pos.w;
        } else {
          stipplePatternUv = 1.0;
        }
      }
    `)),t.vertex.code.add(i.H`
      // Convert back into NDC
      pos.xy = pos.xy / screenSize * pos.w;

      vColor = getColor();
      vColor.a *= coverage;

      gl_Position = pos;
    }
  }
  `),t.include(s.p,e),t.fragment.uniforms.add("intrinsicColor","vec4"),t.fragment.include(a.Y),t.fragment.code.add(i.H`
  void main() {
    discardBySlice(vpos);
    float stippleAlpha = getStippleAlpha();
    discardByStippleAlpha(stippleAlpha, STIPPLE_ALPHA_COLOR_DISCARD);

    vec4 color = intrinsicColor * vColor;
  `),e.innerColorEnabled&&(t.fragment.uniforms.add("pixelRatio","float"),t.fragment.code.add(i.H`
    float distToInner = abs(vLineDistance * gl_FragCoord.w) - innerWidth;
    float innerAA = clamp(0.5 - distToInner, 0.0, 1.0);
    float innerAlpha = innerColor.a + color.a * (1.0 - innerColor.a);
    color = mix(color, vec4(innerColor.rgb, innerAlpha), innerAA);
    `)),t.fragment.code.add(i.H`
    vec4 finalColor = blendStipple(color, stippleAlpha);
  `),e.falloffEnabled&&t.fragment.code.add(i.H`
    finalColor.a *= pow(max(0.0, 1.0 - abs(vLineDistanceNorm * gl_FragCoord.w)), falloff);
    `),t.fragment.code.add(i.H`
    if (finalColor.a < ${i.H.float(o.bf)}) {
      discard;
    }

    ${7===e.output?i.H`gl_FragColor = vec4(finalColor.a);`:""}
    ${0===e.output?i.H`gl_FragColor = highlightSlice(finalColor, vpos);`:""}
    ${0===e.output&&e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}
    ${4===e.output?i.H`gl_FragColor = vec4(1.0);`:""}
    ${1===e.output?i.H`outputDepth(linearDepth);`:""}
  }
  `),t}var p=Object.freeze({__proto__:null,build:u})},77204:(e,t,n)=>{"use strict";n.d(t,{r:()=>d,p:()=>c});var i=n(56140),r=n(79881),a=n(87566),s=n(82677),o=n(59691),l=n(45671);const c=e=>{let t=class extends e{destroy(){this.destroyed||(this.handles.destroy(),this.updatingHandles.destroy())}get handles(){return this._get("handles")||new o.Z}get updatingHandles(){return this._get("updatingHandles")||new l.t}};return(0,i._)([(0,r.Cb)({readOnly:!0})],t.prototype,"handles",null),(0,i._)([(0,r.Cb)({readOnly:!0})],t.prototype,"updatingHandles",null),t=(0,i._)([(0,a.j)("esri.core.HandleOwner")],t),t};let d=class extends(c(s.default)){};d=(0,i._)([(0,a.j)("esri.core.HandleOwner")],d)},35883:(e,t,n)=>{"use strict";n.r(t),n.d(t,{hydratedAdapter:()=>l});var i=n(61106),r=n(52937),a=n(3470),s=n(53817),o=n(93833);const l={convertToGEGeometry:function(e,t){if(null==t)return null;let n="cache"in t?t.cache._geVersion:void 0;return null==n&&(n=e.convertJSONToGeometry(t),"cache"in t&&(t.cache._geVersion=n)),n},exportPoint:function(e,t,n){const r=e.hasZ(t),a=e.hasM(t),s=new i.Z({x:e.getPointX(t),y:e.getPointY(t),spatialReference:n});return r&&(s.z=e.getPointZ(t)),a&&(s.m=e.getPointM(t)),s.cache._geVersion=t,s},exportPolygon:function(e,t,n){const i=new s.Z({rings:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:n});return i.cache._geVersion=t,i},exportPolyline:function(e,t,n){const i=new o.Z({paths:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:n});return i.cache._geVersion=t,i},exportMultipoint:function(e,t,n){const i=new a.Z({hasZ:e.hasZ(t),hasM:e.hasM(t),points:e.exportPoints(t),spatialReference:n});return i.cache._geVersion=t,i},exportExtent:function(e,t,n){const i=e.hasZ(t),a=e.hasM(t),s=new r.Z({xmin:e.getXMin(t),ymin:e.getYMin(t),xmax:e.getXMax(t),ymax:e.getYMax(t),spatialReference:n});if(i){const n=e.getZExtent(t);s.zmin=n.vmin,s.zmax=n.vmax}if(a){const n=e.getMExtent(t);s.mmin=n.vmin,s.mmax=n.vmax}return s.cache._geVersion=t,s}}},70642:(e,t,n)=>{"use strict";n.r(t),n.d(t,{buffer:()=>w,clip:()=>o,contains:()=>c,convexHull:()=>x,crosses:()=>d,cut:()=>l,densify:()=>U,difference:()=>S,disjoint:()=>g,distance:()=>h,equals:()=>u,extendedSpatialReferenceInfo:()=>s,flipHorizontal:()=>z,flipVertical:()=>V,generalize:()=>L,geodesicArea:()=>q,geodesicBuffer:()=>E,geodesicDensify:()=>N,geodesicLength:()=>H,intersect:()=>P,intersects:()=>p,isSimple:()=>_,nearestCoordinate:()=>D,nearestVertex:()=>M,nearestVertices:()=>R,offset:()=>C,overlaps:()=>v,planarArea:()=>F,planarLength:()=>j,relate:()=>y,rotate:()=>T,simplify:()=>b,symmetricDifference:()=>A,touches:()=>f,union:()=>O,within:()=>m});var i=n(65798),r=n(35883);function a(e){return Array.isArray(e)?e[0].spatialReference:e&&e.spatialReference}function s(e){return i.a.extendedSpatialReferenceInfo(e)}function o(e,t){return i.a.clip(r.hydratedAdapter,a(e),e,t)}function l(e,t){return i.a.cut(r.hydratedAdapter,a(e),e,t)}function c(e,t){return i.a.contains(r.hydratedAdapter,a(e),e,t)}function d(e,t){return i.a.crosses(r.hydratedAdapter,a(e),e,t)}function h(e,t,n){return i.a.distance(r.hydratedAdapter,a(e),e,t,n)}function u(e,t){return i.a.equals(r.hydratedAdapter,a(e),e,t)}function p(e,t){return i.a.intersects(r.hydratedAdapter,a(e),e,t)}function f(e,t){return i.a.touches(r.hydratedAdapter,a(e),e,t)}function m(e,t){return i.a.within(r.hydratedAdapter,a(e),e,t)}function g(e,t){return i.a.disjoint(r.hydratedAdapter,a(e),e,t)}function v(e,t){return i.a.overlaps(r.hydratedAdapter,a(e),e,t)}function y(e,t,n){return i.a.relate(r.hydratedAdapter,a(e),e,t,n)}function _(e){return i.a.isSimple(r.hydratedAdapter,a(e),e)}function b(e){return i.a.simplify(r.hydratedAdapter,a(e),e)}function x(e,t=!1){return i.a.convexHull(r.hydratedAdapter,a(e),e,t)}function S(e,t){return i.a.difference(r.hydratedAdapter,a(e),e,t)}function A(e,t){return i.a.symmetricDifference(r.hydratedAdapter,a(e),e,t)}function P(e,t){return i.a.intersect(r.hydratedAdapter,a(e),e,t)}function O(e,t=null){return i.a.union(r.hydratedAdapter,a(e),e,t)}function C(e,t,n,s,o,l){return i.a.offset(r.hydratedAdapter,a(e),e,t,n,s,o,l)}function w(e,t,n,s=!1){return i.a.buffer(r.hydratedAdapter,a(e),e,t,n,s)}function E(e,t,n,s,o,l){return i.a.geodesicBuffer(r.hydratedAdapter,a(e),e,t,n,s,o,l)}function D(e,t,n=!0){return i.a.nearestCoordinate(r.hydratedAdapter,a(e),e,t,n)}function M(e,t){return i.a.nearestVertex(r.hydratedAdapter,a(e),e,t)}function R(e,t,n,s){return i.a.nearestVertices(r.hydratedAdapter,a(e),e,t,n,s)}function I(e){return"xmin"in e?"center"in e?e.center:null:"x"in e?e:"extent"in e?e.extent.center:null}function T(e,t,n){var r;if(null==e)throw new Error("Illegal Argument Exception");const a=e.spatialReference;if(null==(n=null!=(r=n)?r:I(e)))throw new Error("Illegal Argument Exception");const s=e.constructor.fromJSON(i.a.rotate(e,t,n));return s.spatialReference=a,s}function z(e,t){var n;if(null==e)throw new Error("Illegal Argument Exception");const r=e.spatialReference;if(null==(t=null!=(n=t)?n:I(e)))throw new Error("Illegal Argument Exception");const a=e.constructor.fromJSON(i.a.flipHorizontal(e,t));return a.spatialReference=r,a}function V(e,t){var n;if(null==e)throw new Error("Illegal Argument Exception");const r=e.spatialReference;if(null==(t=null!=(n=t)?n:I(e)))throw new Error("Illegal Argument Exception");const a=e.constructor.fromJSON(i.a.flipVertical(e,t));return a.spatialReference=r,a}function L(e,t,n,s){return i.a.generalize(r.hydratedAdapter,a(e),e,t,n,s)}function U(e,t,n){return i.a.densify(r.hydratedAdapter,a(e),e,t,n)}function N(e,t,n,s=0){return i.a.geodesicDensify(r.hydratedAdapter,a(e),e,t,n,s)}function F(e,t){return i.a.planarArea(r.hydratedAdapter,a(e),e,t)}function j(e,t){return i.a.planarLength(r.hydratedAdapter,a(e),e,t)}function q(e,t,n){return i.a.geodesicArea(r.hydratedAdapter,a(e),e,t,n)}function H(e,t,n){return i.a.geodesicLength(r.hydratedAdapter,a(e),e,t,n)}},98675:(e,t,n)=>{"use strict";n.r(t),n.d(t,{directGeodeticSolver:()=>v,geodesicAreas:()=>f,geodesicDensify:()=>g,geodesicDistance:()=>_,geodesicLengths:()=>m,inverseGeodeticSolver:()=>y,isSupported:()=>p,pointFromDistance:()=>b});var i=n(32656),r=n(73032),a=n(61106),s=n(53817),o=n(93833),l=(n(36348),n(93533)),c=n(64249);function d(e){if(!e)return null;if(e.isGeographic&&e.wkid){const t=c.Dg[e.wkid];if(t)return t}if(e.wkt){const t=c.yB.exec(e.wkt);if(!t||2!==t.length)return null;const n=t[1].split(",");if(!n||n.length<3)return null;const i=parseFloat(n[1]),r=parseFloat(n[2]);return isNaN(i)||isNaN(r)?null:{a:i,f:0===r?0:1/r}}return null}function h(e){const t=d(e||r.Z.WGS84);if(function(e){return"b"in e&&"eSq"in e&&"radius"in e}(t))return t;const n=t.a*(1-t.f);return Object.assign(t,{b:n,eSq:1-(n/t.a)**2,radius:(2*t.a+n)/3,densificationRatio:1e4/((2*t.a+n)/3)})}function u(e,t,n){const{a:i,eSq:r}=h(n),a=Math.sqrt(r),s=Math.sin(t[1]*c.Yr),o=i*t[0]*c.Yr;let l;return l=r>0?i*((1-r)*(s/(1-r*(s*s))-1/(2*a)*Math.log((1-a*s)/(1+a*s))))*.5:i*s,e[0]=o,e[1]=l,e}function p(e){return null!==d(e)}function f(e,t="square-meters"){if(e.some((e=>!p(e.spatialReference))))throw new i.Z("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const n=[];for(let t=0;t<e.length;t++){const i=e[t],r=i.spatialReference,{radius:a,densificationRatio:s}=h(r),o=a*s;n.push(g(i,o))}const r=[],a=[0,0],s=[0,0];for(let e=0;e<n.length;e++){const{rings:i,spatialReference:o}=n[e];let c=0;for(let e=0;e<i.length;e++){const t=i[e];u(a,t[0],o),u(s,t[t.length-1],o);let n=s[0]*a[1]-a[0]*s[1];for(let e=0;e<t.length-1;e++)u(a,t[e+1],o),u(s,t[e],o),n+=s[0]*a[1]-a[0]*s[1];c+=n}c=(0,l.En)(c,"square-meters",t),r.push(c/-2)}return r}function m(e,t="meters"){const n=e,r=e;if(!n&&!r)throw new i.Z("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(n?n.some((e=>!p(e.spatialReference))):r.some((e=>!p(e.spatialReference))))throw new i.Z("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const a=[];for(let n=0;n<e.length;n++){const i=e[n],{spatialReference:r}=i,s="polyline"===i.type?i.paths:i.rings;let o=0;for(let e=0;e<s.length;e++){const t=s[e];let n=0;for(let e=1;e<t.length;e++){const i=t[e-1][0],a=t[e][0],s=t[e-1][1],o=t[e][1];if(s!==o||i!==a){const e={distance:null};y(e,[i,s],[a,o],r),n+=e.distance}}o+=n}o=(0,l.En)(o,"meters",t),a.push(o)}return a}function g(e,t){if("polyline"!==e.type&&"polygon"!==e.type)throw new i.Z("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:n}=e;if(!p(n))throw new i.Z("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const{radius:r}=h(n),a=r/1e4;t<a&&(t=a);const l="polyline"===e.type?e.paths:e.rings,c=[],d=[0,0],u={distance:null};for(const e of l){const i=[];c.push(i),i.push([e[0][0],e[0][1]]);let r,a,s=e[0][0],o=e[0][1];for(let l=0;l<e.length-1;l++){if(r=e[l+1][0],a=e[l+1][1],s===r&&o===a)continue;const c=[s,o];y(u,[s,o],[r,a],n);const{azimuth:h,distance:p}=u,f=p/t;if(f>1){for(let e=1;e<=f-1;e++)v(d,c,h,e*t,n),i.push(d.slice(0));v(d,c,h,(p+Math.floor(f-1)*t)/2,n),i.push(d.slice(0))}v(d,c,h,p,n),i.push(d.slice(0)),s=d[0],o=d[1]}}return"polyline"===e.type?new o.Z({paths:c,spatialReference:n}):new s.Z({rings:c,spatialReference:n})}function v(e,t,n,i,r){const a=t[0],s=t[1],o=a*c.Yr,l=s*c.Yr,d=n*c.Yr,{a:u,b:p,f}=h(r),m=Math.sin(d),g=Math.cos(d),v=(1-f)*Math.tan(l),y=1/Math.sqrt(1+v*v),_=v*y,b=Math.atan2(v,g),x=y*m,S=x*x,A=1-S,P=A*(u*u-p*p)/(p*p),O=1+P/16384*(4096+P*(P*(320-175*P)-768)),C=P/1024*(256+P*(P*(74-47*P)-128));let w,E,D,M,R=i/(p*O),I=2*Math.PI;for(;Math.abs(R-I)>1e-12;)D=Math.cos(2*b+R),w=Math.sin(R),E=Math.cos(R),M=C*w*(D+C/4*(E*(2*D*D-1)-C/6*D*(4*w*w-3)*(4*D*D-3))),I=R,R=i/(p*O)+M;const T=_*w-y*E*g,z=Math.atan2(_*E+y*w*g,(1-f)*Math.sqrt(S+T*T)),V=Math.atan2(w*m,y*E-_*w*g),L=f/16*A*(4+f*(4-3*A)),U=z/c.Yr,N=(o+(V-(1-L)*f*x*(R+L*w*(D+L*E*(2*D*D-1)))))/c.Yr;return e.splice(0,e.length),e.push(N,U),e}function y(e,t,n,i){const r=t[0]*c.Yr,a=t[1]*c.Yr,s=n[0]*c.Yr,o=n[1]*c.Yr,{a:l,b:d,f:u,radius:p}=h(i),f=s-r,m=Math.atan((1-u)*Math.tan(a)),g=Math.atan((1-u)*Math.tan(o)),v=Math.sin(m),y=Math.cos(m),_=Math.sin(g),b=Math.cos(g);let x,S,A,P,O,C,w,E,D,M,R=1e3,I=f;do{if(w=Math.sin(I),E=Math.cos(I),A=Math.sqrt(b*w*(b*w)+(y*_-v*b*E)*(y*_-v*b*E)),0===A)return{distance:0};O=v*_+y*b*E,C=Math.atan2(A,O),D=y*b*w/A,S=1-D*D,P=O-2*v*_/S,isNaN(P)&&(P=0),M=u/16*S*(4+u*(4-3*S)),x=I,I=f+(1-M)*u*D*(C+M*A*(P+M*O*(2*P*P-1)))}while(Math.abs(I-x)>1e-12&&--R>0);if(0===R){const e=p,t=Math.acos(Math.sin(a)*Math.sin(o)+Math.cos(a)*Math.cos(o)*Math.cos(s-r))*e,n=s-r,i=Math.sin(n)*Math.cos(o),l=Math.cos(a)*Math.sin(o)-Math.sin(a)*Math.cos(o)*Math.cos(n);return{azimuth:Math.atan2(i,l)/c.Yr,distance:t}}const T=S*(l*l-d*d)/(d*d),z=T/1024*(256+T*(T*(74-47*T)-128)),V=d*(1+T/16384*(4096+T*(T*(320-175*T)-768)))*(C-z*A*(P+z/4*(O*(2*P*P-1)-z/6*P*(4*A*A-3)*(4*P*P-3)))),L=Math.atan2(b*Math.sin(I),y*_-v*b*Math.cos(I)),U=Math.atan2(y*Math.sin(I),y*_*Math.cos(I)-v*b);return e.azimuth=L/c.Yr,e.distance=V,e.reverseAzimuth=U/c.Yr,e}function _(e,t,n="meters"){if(!e||!t)throw new i.Z("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!e.spatialReference||!t.spatialReference)throw new i.Z("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!e.spatialReference.equals(t.spatialReference))throw new i.Z("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const{spatialReference:r}=e;if(!p(r))throw new i.Z("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(e.equals(t))return{distance:0,azimuth:0,reverseAzimuth:0};const a={distance:null};return y(a,[e.x,e.y],[t.x,t.y],r),a.distance=(0,l.En)(a.distance,"meters",n),a}function b(e,t,n){if(!e||null==t||null==n)throw new i.Z("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");if(n<0||n>360)throw new i.Z("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0° to 360° degrees");if(!e.spatialReference)throw new i.Z("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const{spatialReference:r}=e;if(!p(r))throw new i.Z("geodesic-distance:not-supported","input geometry spatial reference is not supported");const s=[0,0];return v(s,[e.x,e.y],n,t,r),new a.Z({x:s[0],y:s[1],spatialReference:r})}},91535:(e,t,n)=>{"use strict";n.d(t,{aX:()=>w,or:()=>E,hR:()=>P});var i=n(34926),r=n(59472),a=n(36544),s=n(32656),o=n(39105),l=n(27780),c=n(73032),d=n(41241),h=n(53817),u=n(93833),p=n(10923),f=n(56885),m=(n(36348),n(54721));async function g(e,t,n){const i="string"==typeof e?(0,p.mN)(e):e,r=t[0].spatialReference,a=(0,f.Ji)(t[0]),s={...n,query:{...i.query,f:"json",sr:r.wkid?r.wkid:JSON.stringify(r),geometries:JSON.stringify((o=t,{geometryType:(0,f.Ji)(o[0]),geometries:o.map((e=>e.toJSON()))}))}};var o;return function(e,t,n){const i=(0,f.q9)(t);return e.map((e=>{const t=i.fromJSON(e);return t.spatialReference=n,t}))}((await(0,m.default)(i.path+"/simplify",s)).data,a,r)}const v=a.Z.getLogger("esri.geometry.support.normalizeUtils"),y={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new u.Z({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:c.Z.WebMercator}),minus180Line:new u.Z({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:c.Z.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new u.Z({paths:[[[180,-180],[180,180]]],spatialReference:c.Z.WGS84}),minus180Line:new u.Z({paths:[[[-180,-180],[-180,180]]],spatialReference:c.Z.WGS84})}};function _(e){return"polygon"===e.type}function b(e){return"polyline"===e[0].type}function x(e){return _(e)?e.rings:e.paths}function S(e,t){return Math.ceil((e-t)/(2*t))}function A(e,t){const n=x(e);for(const e of n)for(const n of e)n[0]+=t;return e}function P(e,t){if(!(e instanceof u.Z||e instanceof h.Z)){const e="straightLineDensify: the input geometry is neither polyline nor polygon";throw v.error(e),new s.Z(e)}const n=x(e),i=[];for(const e of n){const n=[];i.push(n),n.push([e[0][0],e[0][1]]);for(let i=0;i<e.length-1;i++){const r=e[i][0],a=e[i][1],s=e[i+1][0],o=e[i+1][1],l=Math.sqrt((s-r)*(s-r)+(o-a)*(o-a)),c=(o-a)/l,d=(s-r)/l,h=l/t;if(h>1){for(let e=1;e<=h-1;e++){const i=e*t,s=d*i+r,o=c*i+a;n.push([s,o])}const e=(l+Math.floor(h-1)*t)/2,i=d*e+r,s=c*e+a;n.push([i,s])}n.push([s,o])}}return _(e)?new h.Z({rings:i,spatialReference:e.spatialReference}):new u.Z({paths:i,spatialReference:e.spatialReference})}function O(e,t,n){if(t){const t=P(e,1e6);e=(0,d.Sx)(t,!0)}return n&&(e=A(e,n)),e}function C(e,t,n){if(Array.isArray(e)){const i=e[0];if(i>t){const n=S(i,t);e[0]=i+n*(-2*t)}else if(i<n){const t=S(i,n);e[0]=i+t*(-2*n)}}else{const i=e.x;if(i>t){const n=S(i,t);e=e.clone().offset(n*(-2*t),0)}else if(i<n){const t=S(i,n);e=e.clone().offset(t*(-2*n),0)}}return e}async function w(e,t,n){if(!Array.isArray(e))return w([e],t);const a=t?t.url:i.Z.geometryServiceUrl;let s,c,v,_,P,E,D,M,R=0;const I=[],T=[];for(const t of e)if((0,r.Wi)(t))T.push(t);else if(s||(s=t.spatialReference,c=(0,l.C5)(s),v=s.isWebMercator,E=v?102100:4326,_=y[E].maxX,P=y[E].minX,D=y[E].plus180Line,M=y[E].minus180Line),c)if("mesh"===t.type)T.push(t);else if("point"===t.type)T.push(C(t.clone(),_,P));else if("multipoint"===t.type){const e=t.clone();e.points=e.points.map((e=>C(e,_,P))),T.push(e)}else if("extent"===t.type){const e=t.clone()._normalize(!1,!1,c);T.push(e.rings?new h.Z(e):e)}else if(t.extent){const e=t.extent,n=S(e.xmin,P)*(2*_);let i=0===n?t.clone():A(t.clone(),n);e.offset(n,0),e.intersects(D)&&e.xmax!==_?(R=e.xmax>R?e.xmax:R,i=O(i,v),I.push(i),T.push("cut")):e.intersects(M)&&e.xmin!==P?(R=e.xmax*(2*_)>R?e.xmax*(2*_):R,i=O(i,v,360),I.push(i),T.push("cut")):T.push(i)}else T.push(t.clone());else T.push(t);let z=S(R,_),V=-90;const L=z,U=new u.Z;for(;z>0;){const e=360*z-180;U.addPath([[e,V],[e,-1*V]]),V*=-1,z--}if(I.length>0&&L>0){const t=function(e,t){let n=-1;for(let i=0;i<t.cutIndexes.length;i++){const r=t.cutIndexes[i],a=t.geometries[i],s=x(a);for(let e=0;e<s.length;e++){const t=s[e];t.some((n=>{if(n[0]<180)return!0;{let n=0;for(let e=0;e<t.length;e++){const i=t[e][0];n=i>n?i:n}n=Number(n.toFixed(9));const i=-360*S(n,180);for(let n=0;n<t.length;n++){const t=a.getPoint(e,n);a.setPoint(e,n,t.clone().offset(i,0))}return!0}}))}if(r===n){if("polygon"===e[0].type)for(const t of x(a))e[r]=e[r].addRing(t);else if(b(e))for(const t of x(a))e[r]=e[r].addPath(t)}else n=r,e[r]=a}return e}(I,await async function(e,t,n,i){const r="string"==typeof e?(0,p.mN)(e):e,a=t[0].spatialReference,s={...i,query:{...r.query,f:"json",sr:JSON.stringify(a),target:JSON.stringify({geometryType:(0,f.Ji)(t[0]),geometries:t}),cutter:JSON.stringify(n)}},o=await(0,m.default)(r.path+"/cut",s),{cutIndexes:l,geometries:c=[]}=o.data;return{cutIndexes:l,geometries:c.map((e=>{const t=(0,f.im)(e);return t.spatialReference=a,t}))}}(a,I,U,n)),i=[],s=[];for(let n=0;n<T.length;n++){const a=T[n];if("cut"!==a)s.push(a);else{const a=t.shift(),o=e[n];(0,r.pC)(o)&&"polygon"===o.type&&o.rings&&o.rings.length>1&&a.rings.length>=o.rings.length?(i.push(a),s.push("simplify")):s.push(v?(0,d.$)(a):a)}}if(!i.length)return s;const o=await g(a,i,n),l=[];for(let e=0;e<s.length;e++){const t=s[e];"simplify"!==t?l.push(t):l.push(v?(0,d.$)(o.shift()):o.shift())}return l}const N=[];for(let e=0;e<T.length;e++){const t=T[e];if("cut"!==t)N.push(t);else{const e=I.shift();N.push(!0===v?(0,d.$)(e):e)}}return(0,o.resolve)(N)}function E(e,t){const n=(0,l.C5)(t);if(n){const[t,i]=n.valid,r=i-t;if(e<t)for(;e<t;)e+=r;if(e>i)for(;e>i;)e-=r}return e}},58722:(e,t,n)=>{"use strict";n.d(t,{WG:()=>p,kB:()=>c,Ou:()=>o});n(95830);var i=n(6962),r=n(59472),a=n(56885),s=(n(15988),n(1586));function o(e){return"declaredClass"in e}function l(e){return"declaredClass"in e}function c(e){return(0,r.Wi)(e)?null:o(e)?e:(0,a.im)(function(e){const t=e.spatialReference.toJSON();switch(e.type){case"point":{const{x:n,y:i,z:r,m:a}=e;return{x:n,y:i,z:r,m:a,spatialReference:t}}case"polygon":{const{rings:n,hasZ:i,hasM:r}=e;return{rings:d(n),hasZ:i,hasM:r,spatialReference:t}}case"polyline":{const{paths:n,hasZ:i,hasM:r}=e;return{paths:d(n),hasZ:i,hasM:r,spatialReference:t}}case"extent":{const{xmin:n,xmax:i,ymin:r,ymax:a,zmin:s,zmax:o,mmin:l,mmax:c,hasZ:d,hasM:h}=e;return{xmin:n,xmax:i,ymin:r,ymax:a,zmin:s,zmax:o,mmin:l,mmax:c,hasZ:d,hasM:h,spatialReference:t}}case"multipoint":{const{points:n,hasZ:i,hasM:r}=e;return{points:u(n)?h(n):n,hasZ:i,hasM:r,spatialReference:t}}default:return}}(e))}function d(e){return function(e){for(const t of e)if(0!==t.length)return u(t);return!1}(e)?e.map((e=>h(e))):e}function h(e){return e.map((e=>(0,i.qo)(e)))}function u(e){return e.length&&((0,i.xZ)(e[0])||(0,i.fS)(e[0]))}function p(e,t){if(!e)return null;let n;if(l(e)){if(null==t)return e.clone();if(l(t))return t.copy(e)}return null!=t?(n=t,n.x=e.x,n.y=e.y,n.spatialReference=e.spatialReference,e.hasZ?(n.z=e.z,n.hasZ=e.hasZ):(n.z=null,n.hasZ=!1),e.hasM?(n.m=e.m,n.hasM=!0):(n.m=null,n.hasM=!1)):(n=(0,s.Tx)(e.x,e.y,e.z,e.spatialReference),e.hasM&&(n.m=e.m,n.hasM=!0)),n}},2961:(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var i=n(49840),r=n(93533);const a={inches:(0,r.En)(1,"meters","inches"),feet:(0,r.En)(1,"meters","feet"),"us-feet":(0,r.En)(1,"meters","us-feet"),yards:(0,r.En)(1,"meters","yards"),miles:(0,r.En)(1,"meters","miles"),"nautical-miles":(0,r.En)(1,"meters","nautical-miles"),millimeters:(0,r.En)(1,"meters","millimeters"),centimeters:(0,r.En)(1,"meters","centimeters"),decimeters:(0,r.En)(1,"meters","decimeters"),meters:(0,r.En)(1,"meters","meters"),kilometers:(0,r.En)(1,"meters","kilometers"),"decimal-degrees":1/(0,r.ty)(1,"meters",i.sv.radius)}},46970:(e,t,n)=>{"use strict";n.d(t,{vQ:()=>u,vx:()=>p,Zz:()=>a,RL:()=>l,vu:()=>o,Ou:()=>h,Lt:()=>c});var i=n(59472),r=n(98160);function a(e,t){return(0,i.Wi)(t)||!t.mode?e?"absolute-height":"on-the-ground":t.mode}function s(e,t){return a(!!(0,i.pC)(e)&&e.hasZ,t)}function o(e){const t=d(e);return s(e.geometry,t)}function l(e){const t=d(e),n=s(e.geometry,t);return{mode:n,offset:(0,i.pC)(t)&&"on-the-ground"!==n?(0,i.Pt)(t.offset,0)*(0,r.Z7)((0,i.Pt)(t.unit,"meters")):0}}function c(e){if("on-the-ground"===o(e))return!1;const t=d(e),n=(0,i.pC)(t)&&t.featureExpressionInfo?t.featureExpressionInfo.expression:null;return!(!n||"0"===n)}function d(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function h(e,t,n){if((0,i.Wi)(n)||!n.mode)return;const r=e.hasZ?e.z:0,a=(0,i.pC)(n.offset)?n.offset:0;switch(n.mode){case"absolute-height":return r-a;case"on-the-ground":return 0;case"relative-to-ground":return r-((t.elevationProvider.getElevation(e.x,e.y,e.z,e.spatialReference,"ground")||0)+a);case"relative-to-scene":return r-((t.elevationProvider.getElevation(e.x,e.y,e.z,e.spatialReference,"scene")||0)+a)}}function u(e,t,n,i=null){return f(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,n,i)}function p(e,t,n,i,r=null){return f(e,t[0],t[1],t.length>2?t[2]:0,n,i,r)}function f(e,t,n,r,a,s,o=null){if((0,i.Wi)(s))return;const l=(0,i.pC)(o)?o.mode:"absolute-height";return"on-the-ground"===l?0:function(e,t,n,r,a,s,o,l){const c=(0,i.pC)(o)&&(0,i.pC)(o.offset)?o.offset:0;switch(l){case"absolute-height":return e-c;case"relative-to-ground":return e-((s.elevationProvider.getElevation(t,n,r,a,"ground")||0)+c);case"relative-to-scene":return e-((s.elevationProvider.getElevation(t,n,r,a,"scene")||0)+c)}}(function(e,t,n,r,a,s,o){const l=(0,i.pC)(s.offset)?s.offset:0;switch(s.mode){case"absolute-height":return o+l;case"on-the-ground":return a.elevationProvider.getElevation(e,t,0,r,"ground")||0;case"relative-to-ground":return o+(a.elevationProvider.getElevation(e,t,n,r,"ground")||0)+l;case"relative-to-scene":return o+(a.elevationProvider.getElevation(e,t,n,r,"scene")||0)+l}}(t,n,r,a,e,s,r),t,n,r,a,e,o,l)}},95986:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(56140),r=(n(95830),n(36544),n(68055),n(79881)),a=n(87566),s=n(10923),o=(n(57002),n(86035),n(82677));let l=class extends o.default{constructor(...e){super(...e),this.requestOptions=null,this.url=null}normalizeCtorArgs(e,t){return"string"!=typeof e?e:{url:e,...t}}get parsedUrl(){return this._parseUrl(this.url)}_parseUrl(e){return e?(0,s.mN)(e):null}_encode(e,t,n){const i={};for(const r in e){if("declaredClass"===r)continue;const a=e[r];if(null!=a&&"function"!=typeof a)if(Array.isArray(a)){i[r]=[];for(let e=0;e<a.length;e++)i[r][e]=this._encode(a[e])}else if("object"==typeof a)if(a.toJSON){const e=a.toJSON(n&&n[r]);i[r]=t?e:JSON.stringify(e)}else i[r]=t?a:JSON.stringify(a);else i[r]=a}return i}};(0,i._)([(0,r.Cb)({readOnly:!0,dependsOn:["url"]})],l.prototype,"parsedUrl",null),(0,i._)([(0,r.Cb)()],l.prototype,"requestOptions",void 0),(0,i._)([(0,r.Cb)({type:String})],l.prototype,"url",void 0),l=(0,i._)([(0,a.j)("esri.tasks.Task")],l);const c=l},76194:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>y});var i=n(56140),r=(n(95830),n(59472)),a=(n(36544),n(68055),n(79881)),s=n(56274),o=n(30590),l=n(87566),c=n(60538),d=(n(10923),n(57002),n(86035),n(58385)),h=n(73032),u=n(56885),p=n(36348),f=n(15988),m=n(70834);const g=new s.Xn({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let v=class extends d.wq{constructor(e){super(e),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(e,t){const n=h.Z.fromJSON(t.spatialReference),i=[];for(let t=0;t<e.length;t++){const a=e[t],s=f.Z.fromJSON(a),o=a.geometry&&a.geometry.spatialReference;(0,r.pC)(s.geometry)&&!o&&(s.geometry.spatialReference=n),i.push(s)}return i}writeGeometryType(e,t,n,i){if(e)return void g.write(e,t,n,i);const{features:a}=this;if(a)for(const e of a)if(e&&(0,r.pC)(e.geometry))return void g.write(e.geometry.type,t,n,i)}readQueryGeometry(e,t){if(!e)return null;const n=!!e.spatialReference,i=(0,u.im)(e);return!n&&t.spatialReference&&(i.spatialReference=h.Z.fromJSON(t.spatialReference)),i}writeSpatialReference(e,t){if(e)return void(t.spatialReference=e.toJSON());const{features:n}=this;if(n)for(const e of n)e&&(0,r.pC)(e.geometry)&&e.geometry.spatialReference&&(t.spatialReference=e.geometry.spatialReference.toJSON())}toJSON(e){const t=this.write(null);if(t.features&&Array.isArray(e)&&e.length>0)for(let n=0;n<t.features.length;n++){const i=t.features[n];if(i.geometry){const t=e&&e[n];i.geometry=t&&t.toJSON()||i.geometry}}return t}quantize(e){const{scale:[t,n],translate:[i,a]}=e,s=this.features,o=this._getQuantizationFunction(this.geometryType,(e=>Math.round((e-i)/t)),(e=>Math.round((a-e)/n)));for(let e=0,t=s.length;e<t;e++)o((0,r.Wg)(s[e].geometry))||(s.splice(e,1),e--,t--);return this.transform=e,this}unquantize(){const{geometryType:e,features:t,transform:n}=this;if(!n)return this;const{translate:[i,a],scale:[s,o]}=n,l=this._getHydrationFunction(e,(e=>e*s+i),(e=>a-e*o));for(const{geometry:e}of t)(0,r.pC)(e)&&l(e);return this.transform=null,this}_quantizePoints(e,t,n){let i,r;const a=[];for(let s=0,o=e.length;s<o;s++){const o=e[s];if(s>0){const e=t(o[0]),s=n(o[1]);e===i&&s===r||(a.push([e-i,s-r]),i=e,r=s)}else i=t(o[0]),r=n(o[1]),a.push([i,r])}return a.length>0?a:null}_getQuantizationFunction(e,t,n){return"point"===e?e=>(e.x=t(e.x),e.y=n(e.y),e):"polyline"===e||"polygon"===e?e=>{const i=(0,u.oU)(e)?e.rings:e.paths,r=[];for(let e=0,a=i.length;e<a;e++){const a=i[e],s=this._quantizePoints(a,t,n);s&&r.push(s)}return r.length>0?((0,u.oU)(e)?e.rings=r:e.paths=r,e):null}:"multipoint"===e?e=>{let i;return i=this._quantizePoints(e.points,t,n),i.length>0?(e.points=i,e):null}:"extent"===e?e=>e:null}_getHydrationFunction(e,t,n){return"point"===e?e=>{e.x=t(e.x),e.y=n(e.y)}:"polyline"===e||"polygon"===e?e=>{const i=(0,u.oU)(e)?e.rings:e.paths;let r,a;for(let e=0,s=i.length;e<s;e++){const s=i[e];for(let e=0,i=s.length;e<i;e++){const i=s[e];e>0?(r+=i[0],a+=i[1]):(r=i[0],a=i[1]),i[0]=t(r),i[1]=n(a)}}}:"extent"===e?e=>{e.xmin=t(e.xmin),e.ymin=n(e.ymin),e.xmax=t(e.xmax),e.ymax=n(e.ymax)}:"multipoint"===e?e=>{const i=e.points;let r,a;for(let e=0,s=i.length;e<s;e++){const s=i[e];e>0?(r+=s[0],a+=s[1]):(r=s[0],a=s[1]),s[0]=t(r),s[1]=n(a)}}:void 0}};(0,i._)([(0,a.Cb)({type:String,json:{write:!0}})],v.prototype,"displayFieldName",void 0),(0,i._)([(0,a.Cb)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"exceededTransferLimit",void 0),(0,i._)([(0,a.Cb)({type:[f.Z],json:{write:!0}})],v.prototype,"features",void 0),(0,i._)([(0,o.r)("features")],v.prototype,"readFeatures",null),(0,i._)([(0,a.Cb)({type:[m.Z],json:{write:!0}})],v.prototype,"fields",void 0),(0,i._)([(0,a.Cb)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:g.read}}})],v.prototype,"geometryType",void 0),(0,i._)([(0,c.c)("geometryType")],v.prototype,"writeGeometryType",null),(0,i._)([(0,a.Cb)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"hasM",void 0),(0,i._)([(0,a.Cb)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"hasZ",void 0),(0,i._)([(0,a.Cb)({types:p.qM,json:{write:!0}})],v.prototype,"queryGeometry",void 0),(0,i._)([(0,o.r)("queryGeometry")],v.prototype,"readQueryGeometry",null),(0,i._)([(0,a.Cb)({type:h.Z,json:{write:!0}})],v.prototype,"spatialReference",void 0),(0,i._)([(0,c.c)("spatialReference")],v.prototype,"writeSpatialReference",null),(0,i._)([(0,a.Cb)({json:{write:!0}})],v.prototype,"transform",void 0),v=(0,i._)([(0,l.j)("esri.tasks.support.FeatureSet")],v),v.prototype.toJSON.isDefaultToJSON=!0,v||(v={});const y=v},74218:(e,t,n)=>{"use strict";n.d(t,{zE:()=>d});var i=n(92232),r=n(88998),a=n(33655),s=(n(77625),n(67128),n(50897),n(17333)),o=(n(12811),n(55735)),l=(n(38256),n(34353),n(69996),n(1586)),c=n(58722);function d(e,t){if("point"===e.type)return u(e,t,!1);if((0,c.Ou)(e))switch(e.type){case"extent":return u(e.center,t,!1);case"polygon":return u(e.centroid,t,!1);case"polyline":return u(h(e),t,!0);case"mesh":return u(e.extent.center,t,!1)}else switch(e.type){case"extent":return u(function(e){const t=(0,a.xV)(e.zmin);return(0,l.Tx)(.5*(e.xmax+e.xmin),.5*(e.ymax+e.ymin),t?.5*(e.zmax+e.zmin):void 0,e.spatialReference)}(e),t,!0);case"polygon":return u(function(e){const t=e.rings[0];if(!t||0===t.length)return null;const n=(0,r.a)(e.rings,e.hasZ);return(0,l.Tx)(n[0],n[1],n[2],e.spatialReference)}(e),t,!0);case"polyline":return u(h(e),t,!0)}}function h(e){const t=e.paths[0];if(!t||0===t.length)return null;const n=(0,i.n8)(t,(0,i.ok)(t)/2);return(0,l.Tx)(n[0],n[1],n[2],e.spatialReference)}function u(e,t,n){const i=n?e:(0,c.WG)(e);return t&&e?(0,s.nF)(e,i,t)?i:null:i}(0,o.f)(0,0),(0,o.f)(.5,0),(0,o.f)(1,0),(0,o.f)(0,.5),(0,o.f)(.5,.5),(0,o.f)(1,.5),(0,o.f)(0,1),(0,o.f)(.5,1),(0,o.f)(1,1)},19132:(e,t,n)=>{"use strict";n.d(t,{KO:()=>a,Fb:()=>r});var i=n(1586);function r(e){return"array"in e}function a(e,t,n="ground"){if((0,i.Vs)(t))return e.getElevation(t.x,t.y,t.z||0,t.spatialReference,n);if(r(t)){let i=t.offset;return e.getElevation(t.array[i++],t.array[i++],t.array[i]||0,e.spatialReference,n)}return e.getElevation(t[0],t[1],t[2]||0,e.spatialReference,n)}},86509:(e,t,n)=>{"use strict";n.d(t,{J:()=>H});var i=n(59472),r=n(33655),a=n(77625),s=n(17387),o=n(55735),l=n(38256),c=n(34353),d=n(88),h=n(56469),u=n(10346),p=n(30090),f=n(56140),m=n(67128),g=n(12811),v=n(23240),y=n(97853),_=n(44801),b=n(51007),x=n(36904),S=n(57086);class A extends y.A{initializeProgram(e){const t=A.shader.get(),n=this.configuration,i=t.build(n);return new b.Z(e.rctx,i.generateSource("vertex"),i.generateSource("fragment"),A.attributeLocations)}bind(e,t,n){this.program.setUniform3fv("innerColor",e.innerColor),this.program.setUniform1f("innerWidth",e.innerWidth*n.pixelRatio),this.program.setUniform3fv("glowColor",e.glowColor),this.program.setUniform1f("glowWidth",e.glowWidth*n.pixelRatio),this.program.setUniform1f("glowFalloff",e.glowFalloff),this.program.setUniform1f("globalAlpha",e.globalAlpha),this.program.setUniform1f("perScreenPixelRatio",n.perScreenPixelRatio),this.program.setUniform2f("pixelToNDC",2/n.fullWidth,2/n.fullHeight),this.program.setUniformMatrix4fv("uProjectionMatrix",n.projectionMatrix),(0,m.t)(O,n.viewMatrix,t),this.program.setUniformMatrix4fv("uModelViewMatrix",O),this.configuration.contrastControlEnabled&&this.program.setUniform1f("globalAlphaContrastBoost",null!=e.globalAlphaContrastBoost?e.globalAlphaContrastBoost:1)}initializePipeline(){return(0,x.sm)({blending:(0,x.if)(1,771),colorWrite:x.BK})}bindPipelineState(e){e.setPipelineState(this.pipeline)}}A.shader=new v.J(S.L,(()=>n.e(5277).then(n.bind(n,45277)))),A.attributeLocations={start:0,end:1,up:2,extrude:3};class P extends _.m{constructor(){super(...arguments),this.contrastControlEnabled=!1}}(0,f._)([(0,_.o)()],P.prototype,"contrastControlEnabled",void 0);const O=(0,g.a)();n(95830),n(5627);var C=n(1227),w=n(80905),E=n(69595),D=n(74038);n(84570),n(89930);class M{constructor(e){this._renderCoordsHelper=e,this._buffers=null,this._origin=(0,a.c)(),this._dirty=!1,this._count=0,this._vao=null}set vertices(e){const t=new Float64Array(3*e.length);let n=0;for(const i of e)t[n++]=i[0],t[n++]=i[1],t[n++]=i[2];this.buffers=[t]}set buffers(e){if(this._buffers=e,this._buffers.length>0){const e=this._buffers[0],t=3*Math.floor(e.length/3/2);(0,s.s)(this._origin,e[t+0],e[t+1],e[t+2])}else(0,s.s)(this._origin,0,0,0);this._dirty=!0}get origin(){return this._origin}draw(e){const t=this.ensureVAO(e);(0,i.pC)(t)&&(e.bindVAO(t),e.drawArrays(4,0,this._count))}dispose(){(0,i.pC)(this._vao)&&this._vao.dispose()}ensureVAO(e){return(0,i.Wi)(this._buffers)?null:((0,i.Wi)(this._vao)&&(this._vao=this.createVAO(e,this._buffers)),this.ensureVertexData(this._vao,this._buffers),this._vao)}createVAO(e,t){const n=this.createDataBuffer(t);return this._dirty=!1,new D.Z(e,A.attributeLocations,{data:(0,C.K)(T)},{data:E.Z.createVertex(e,35044,n)})}ensureVertexData(e,t){if(!this._dirty)return;const n=this.createDataBuffer(t);e.vertexBuffers.data.setData(n),this._dirty=!1}numberOfRenderVertices(e){return 2*(e.length/3-1)*3}createDataBuffer(e){const t=e.reduce(((e,t)=>e+this.numberOfRenderVertices(t)),0);this._count=t;const n=T.createBuffer(t),i=this._origin;let r=0,a=0;for(const t of e){for(let e=0;e<t.length;e+=3){const o=(0,s.s)(I,t[e+0],t[e+1],t[e+2]);0===e?a=this._renderCoordsHelper.getAltitude(o):this._renderCoordsHelper.setAltitude(a,o);const l=this._renderCoordsHelper.worldUpAtPosition(o,R),c=r+2*e,d=(0,s.f)(I,o,i);if(e<t.length-3){n.up.setVec(c,l),n.up.setVec(c+3,l),n.up.setVec(c+5,l);for(let e=0;e<6;e++)n.start.setVec(c+e,d);n.extrude.setValues(c+0,0,-1),n.extrude.setValues(c+1,1,-1),n.extrude.setValues(c+2,1,1),n.extrude.setValues(c+3,0,-1),n.extrude.setValues(c+4,1,1),n.extrude.setValues(c+5,0,1)}if(e>0){n.up.setVec(c-2,l),n.up.setVec(c-4,l),n.up.setVec(c-5,l);for(let e=-6;e<0;e++)n.end.setVec(c+e,d)}}r+=this.numberOfRenderVertices(t)}return n.buffer}}const R=(0,a.c)(),I=(0,a.c)(),T=(0,w.U$)().vec3f("start").vec3f("end").vec3f("up").vec2f("extrude");var z=n(11379),V=n(56396);class L extends y.A{initializeProgram(e){const t=L.shader.get(),n=this.configuration,i=t.build(n);return new b.Z(e.rctx,i.generateSource("vertex"),i.generateSource("fragment"),z.i)}bind(e,t){this.program.setUniform3fv("innerColor",e.innerColor),this.program.setUniform1f("innerWidth",e.innerWidth*t.pixelRatio),this.program.setUniform3fv("glowColor",e.glowColor),this.program.setUniform1f("glowWidth",e.glowWidth*t.pixelRatio),this.program.setUniform1f("glowFalloff",e.glowFalloff),this.program.setUniform1f("globalAlpha",e.globalAlpha),this.configuration.contrastControlEnabled&&this.program.setUniform1f("globalAlphaContrastBoost",null!=e.globalAlphaContrastBoost?e.globalAlphaContrastBoost:1);const n=null!=e.angleCutoff?e.angleCutoff:V.d;this.program.setUniform2f("angleCutoff",Math.cos(n),Math.cos(Math.max(0,n-(0,r.Vl)(2)))),this.configuration.intersectsLineEnabled&&this.program.setUniform1f("perScreenPixelRatio",t.perScreenPixelRatio)}initializePipeline(){return(0,x.sm)({blending:(0,x.if)(1,771),colorWrite:x.BK})}}L.shader=new v.J(V.L,(()=>n.e(1070).then(n.bind(n,1070))));class U extends _.m{constructor(){super(...arguments),this.heightManifoldEnabled=!1,this.pointDistanceEnabled=!1,this.lineVerticalPlaneEnabled=!1,this.intersectsLineEnabled=!1,this.contrastControlEnabled=!1}}(0,f._)([(0,_.o)()],U.prototype,"heightManifoldEnabled",void 0),(0,f._)([(0,_.o)()],U.prototype,"pointDistanceEnabled",void 0),(0,f._)([(0,_.o)()],U.prototype,"lineVerticalPlaneEnabled",void 0),(0,f._)([(0,_.o)()],U.prototype,"intersectsLineEnabled",void 0),(0,f._)([(0,_.o)()],U.prototype,"contrastControlEnabled",void 0);const N=(0,a.c)(),F=(0,l.a)(),j={glowColor:[1,.5,0],glowWidth:8,glowFalloff:8,innerColor:[1,1,1],innerWidth:1,globalAlpha:.75,angleCutoff:(0,r.Vl)(6),globalAlphaContrastBoost:2};function q(e,t,n,i){const r=N,a=F;(0,s.i)(r,t,i),(0,s.g)(a,n),a[3]=0,(0,c.t)(a,a,i),d.yC.fromPositionAndNormal(r,a,e)}class H{constructor(e,t={},n={contrastControlEnabled:!1}){this._technique=null,this._projInfo=(0,l.a)(),this._zScale=(0,o.a)(),this._heightManifoldEnabled=!1,this._heightManifoldTarget=(0,a.c)(),this._pointDistanceEnabled=!1,this._pointDistanceOrigin=(0,a.c)(),this._pointDistanceTarget=(0,a.c)(),this._lineVerticalPlaneEnabled=!1,this._lineVerticalPlaneSegment=d.KD.create(),this._intersectsLineEnabled=!1,this._intersectsLineSegment=d.KD.create(),this._intersectsLineRadius=3,this._intersectsLineInfinite=!1,this._pathVerticalPlaneEnabled=!1,this._pathVerticalPlaneData=null,this._pathTechnique=null,this.canRender=!0,this._tempNormal=(0,a.c)(),this._tempDir=(0,a.c)(),this._tempUp=(0,a.c)(),this._tempVec3A=(0,a.c)(),this._tempVec3B=(0,a.c)(),this._tempVec4=(0,l.a)(),this._tempPlane=d.yC.create(),this._tempSphere=d.Dv.create(),this._renderCoordsHelper=e,this._params=(0,p.Uf)(t,j),this._config=n}get renderSlots(){return[this._config.contrastControlEnabled?17:16]}get needsLinearDepth(){return!0}get heightManifoldEnabled(){return this._heightManifoldEnabled}set heightManifoldEnabled(e){this._heightManifoldEnabled!==e&&(this._heightManifoldEnabled=e,this._requestRender())}get heightManifoldTarget(){return this._heightManifoldTarget}set heightManifoldTarget(e){(0,s.g)(this._heightManifoldTarget,e),this._requestRender()}get pointDistanceEnabled(){return this._pointDistanceEnabled}set pointDistanceEnabled(e){e!==this._pointDistanceEnabled&&(this._pointDistanceEnabled=e,this._requestRender())}get pointDistanceTarget(){return this._pointDistanceTarget}set pointDistanceTarget(e){(0,s.g)(this._pointDistanceTarget,e),this._requestRender()}get pointDistanceOrigin(){return this._pointDistanceOrigin}set pointDistanceOrigin(e){(0,s.g)(this._pointDistanceOrigin,e),this._requestRender()}get lineVerticalPlaneEnabled(){return this._lineVerticalPlaneEnabled}set lineVerticalPlaneEnabled(e){e!==this._lineVerticalPlaneEnabled&&(this._lineVerticalPlaneEnabled=e,this._requestRender())}get lineVerticalPlaneSegment(){return this._lineVerticalPlaneSegment}set lineVerticalPlaneSegment(e){d.KD.copy(e,this._lineVerticalPlaneSegment),this._requestRender()}get intersectsLineEnabled(){return this._intersectsLineEnabled}set intersectsLineEnabled(e){e!==this._intersectsLineEnabled&&(this._intersectsLineEnabled=e,this._requestRender())}get intersectsLineSegment(){return this._intersectsLineSegment}set intersectsLineSegment(e){d.KD.copy(e,this._intersectsLineSegment),this._requestRender()}get intersectsLineRadius(){return this._intersectsLineRadius}set intersectsLineRadius(e){e!==this._intersectsLineRadius&&(this._intersectsLineRadius=e,this._requestRender())}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(e){e!==this._intersectsLineInfinite&&(this._intersectsLineInfinite=e,this._requestRender())}get pathVerticalPlaneEnabled(){return this._pathVerticalPlaneEnabled}set pathVerticalPlaneEnabled(e){e!==this._pathVerticalPlaneEnabled&&(this._pathVerticalPlaneEnabled=e,(0,i.pC)(this._pathVerticalPlaneData)&&this._requestRender())}set pathVerticalPlaneVertices(e){(0,i.Wi)(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new M(this._renderCoordsHelper)),this._pathVerticalPlaneData.vertices=e,this.pathVerticalPlaneEnabled&&this._requestRender()}set pathVerticalPlaneBuffers(e){(0,i.Wi)(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new M(this._renderCoordsHelper)),this._pathVerticalPlaneData.buffers=e,this.pathVerticalPlaneEnabled&&this._requestRender()}setParameterValues(e){(0,p.LO)(this._params,e)&&this._requestRender()}initializeRenderContext(e){this._initContext=e;const t=e.rctx;this._quadVAO=(0,u.ow)(t),this._techniqueRepository=e.shaderTechniqueRep,this._techniqueConfig=new U,this._pathTechniqueConfig=new P}uninitializeRenderContext(){this._quadVAO.dispose(),this._quadVAO=null,(0,i.pC)(this._technique)&&this._techniqueRepository.release(this._technique),(0,i.pC)(this._pathVerticalPlaneData)&&this._pathVerticalPlaneData.dispose(),(0,i.pC)(this._pathTechnique)&&this._techniqueRepository.release(this._pathTechnique)}render(e){const t=this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled,n=this.pathVerticalPlaneEnabled;if(!t&&!n)return!0;const i=e.camera;return(0,h.Xv)(i.projectionMatrix,i.fullWidth,i.fullHeight,this._projInfo,this._zScale),t&&this.renderUnified(e),n&&this.renderPath(e),!0}renderUnified(e){const t=e.rctx,n=this._selectTechnique(),i=n.program;t.bindProgram(i),n.bindPipelineState(t),this.bindGlobalUniforms(e,i),this.bindHeightManifoldUniforms(e,i),this.bindPointDistanceUniforms(e,i),this.bindLineVerticalPlaneUniforms(e,i),this.bindIntersectsLineUniforms(e,i),n.bind(this._params,e.camera),t.bindVAO(this._quadVAO),t.drawArrays(5,0,4)}renderPath(e){if((0,i.Wi)(this._pathVerticalPlaneData))return;this._pathTechniqueConfig.contrastControlEnabled=this._config.contrastControlEnabled,this._pathTechnique=this._techniqueRepository.acquireAndReleaseExisting(A,this._pathTechniqueConfig,this._pathTechnique);const t=e.rctx,n=this._pathTechnique,r=n.program;t.bindProgram(r),n.bindPipelineState(t),this.bindGlobalUniforms(e,r),n.bind(this._params,this._pathVerticalPlaneData.origin,e.camera),this._pathVerticalPlaneData.draw(e.rctx)}bindHeightManifoldUniforms(e,t){if(!this.heightManifoldEnabled)return;const n=this._tempVec3A,i=this._tempPlane;this._renderCoordsHelper.worldUpAtPosition(this._heightManifoldTarget,n),q(i,this._heightManifoldTarget,n,e.camera.viewMatrix),t.setUniform4fv("heightPlane",i)}bindPointDistanceUniforms(e,t){if(!this._pointDistanceEnabled)return;const n=e.camera,i=this._tempSphere;(0,s.g)(i.center,this._pointDistanceOrigin),(0,s.i)(i.center,i.center,n.viewMatrix),i.radius=(0,s.k)(this._pointDistanceOrigin,this._pointDistanceTarget),t.setUniform4f("pointDistanceSphere",i.center[0],i.center[1],i.center[2],i.radius)}bindLineVerticalPlaneUniforms(e,t){if(!this._lineVerticalPlaneEnabled)return;const n=this._renderCoordsHelper,i=e.camera,r=this._tempPlane,a=this._tempVec3A,o=this._tempUp,l=this._tempDir,c=this._tempNormal;d.KD.pointAt(this._lineVerticalPlaneSegment,.5,a),n.worldUpAtPosition(a,o),(0,s.n)(l,this._lineVerticalPlaneSegment.vector),(0,s.c)(c,o,l),(0,s.n)(c,c),q(r,this._lineVerticalPlaneSegment.origin,c,i.viewMatrix),t.setUniform4fv("lineVerticalPlane",r);const h=this._tempVec3A;(0,s.g)(h,this._lineVerticalPlaneSegment.origin),n.setAltitude(0,h),(0,s.i)(h,h,i.viewMatrix),t.setUniform3fv("lineVerticalStart",h);const u=this._tempVec3B;(0,s.b)(u,this._lineVerticalPlaneSegment.origin,this._lineVerticalPlaneSegment.vector),n.setAltitude(0,u),(0,s.i)(u,u,i.viewMatrix),t.setUniform3fv("lineVerticalEnd",u)}bindIntersectsLineUniforms(e,t){if(!this._intersectsLineEnabled)return;const n=X,i=W;if(this._intersectsLineInfinite){const t=e.camera;if(d.bW.fromRay(d.kx.wrap(this._intersectsLineSegment.origin,this._intersectsLineSegment.vector),Z),Z.c0=-Number.MAX_VALUE,!d.oy.intersectClipRay(t.frustum.planes,Z))return;d.bW.getStart(Z,n),d.bW.getEnd(Z,i)}else(0,s.g)(n,this._intersectsLineSegment.origin),(0,s.b)(i,this._intersectsLineSegment.origin,this._intersectsLineSegment.vector);const r=this._tempVec3A;(0,s.i)(r,n,e.camera.viewMatrix),t.setUniform3fv("intersectsLineStart",r);const a=this._tempVec4;(0,s.g)(a,this._intersectsLineSegment.vector),this._tempVec4[3]=0,(0,c.t)(this._tempVec4,this._tempVec4,e.camera.viewMatrix),(0,s.i)(i,i,e.camera.viewMatrix),t.setUniform3fv("intersectsLineEnd",i),(0,s.n)(a,a),t.setUniform3f("intersectsLineDirection",a[0],a[1],a[2]),t.setUniform1f("intersectsLineRadius",this._intersectsLineRadius)}bindGlobalUniforms(e,t){const n=e.camera;t.setUniform4fv("projInfo",this._projInfo),t.setUniform2fv("zScale",this._zScale),t.setUniform2f("nearFar",n.near,n.far),this._heightManifoldEnabled?t.setUniform1f("maxPixelDistance",2*n.computeScreenPixelSizeAt(this._heightManifoldTarget)):this._pointDistanceEnabled?t.setUniform1f("maxPixelDistance",2*n.computeScreenPixelSizeAt(this._pointDistanceTarget)):this._lineVerticalPlaneEnabled&&t.setUniform1f("maxPixelDistance",2*n.computeScreenPixelSizeAt(this._lineVerticalPlaneSegment.origin)),t.setUniform1i("depthMap",0),e.rctx.bindTexture(e.offscreenRenderingHelper.linearDepthTexture,0),t.setUniform1i("frameColor",1),e.rctx.bindTexture(e.offscreenRenderingHelper.mainColorTexture,1)}_requestRender(){this._initContext&&this._initContext.requestRender()}_selectTechnique(){return this._techniqueConfig.heightManifoldEnabled=this.heightManifoldEnabled,this._techniqueConfig.lineVerticalPlaneEnabled=this.lineVerticalPlaneEnabled,this._techniqueConfig.pointDistanceEnabled=this.pointDistanceEnabled,this._techniqueConfig.intersectsLineEnabled=this.intersectsLineEnabled,this._techniqueConfig.contrastControlEnabled=this._config.contrastControlEnabled,this._technique=this._techniqueRepository.acquireAndReleaseExisting(L,this._techniqueConfig,this._technique),this._technique}}const Z=d.bW.create(),X=(0,a.c)(),W=(0,a.c)()},1227:(e,t,n)=>{"use strict";n.d(t,{K:()=>r});const i={divisor:0};function r(e,t={}){t={...i,...t};const n=e.stride;return e.fieldNames.filter((t=>{const n=e.fields.get(t).optional;return!(n&&n.glPadding)})).map((i=>{const r=e.fields.get(i),s=r.constructor.ElementCount,o=function(e){const t=a[e];if(t)return t;throw new Error("BufferType not supported in WebGL")}(r.constructor.ElementType),l=r.offset,c=!(!r.optional||!r.optional.glNormalized);return{name:i,stride:n,count:s,type:o,offset:l,normalized:c,divisor:t.divisor}}))}const a={u8:5121,u16:5123,u32:5125,i8:5120,i16:5122,i32:5124,f32:5126}},62692:(e,t,n)=>{"use strict";n.d(t,{j:()=>s});var i=n(85461),r=n(4071);function a(e){e.fragment.uniforms.add("projInfo","vec4"),e.fragment.uniforms.add("zScale","vec2"),e.fragment.code.add(i.H`
    vec3 reconstructPosition(vec2 fragCoord, float depth) {
      return vec3((fragCoord * projInfo.xy + projInfo.zw) * (zScale.x * depth + zScale.y), depth);
    }
  `)}function s(e,t){e.extensions.add("GL_OES_standard_derivatives"),e.include(r.S),e.include(a),e.fragment.uniforms.add("glowColor","vec3"),e.fragment.uniforms.add("glowWidth","float"),e.fragment.uniforms.add("glowFalloff","float"),e.fragment.uniforms.add("innerColor","vec3"),e.fragment.uniforms.add("innerWidth","float"),e.fragment.uniforms.add("depthMap","sampler2D"),e.fragment.uniforms.add("nearFar","vec2"),e.fragment.uniforms.add("frameColor","sampler2D"),t.contrastControlEnabled&&e.fragment.uniforms.add("globalAlphaContrastBoost","float"),e.fragment.code.add(i.H`
  vec4 blendPremultiplied(vec4 source, vec4 dest) {
    float oneMinusSourceAlpha = 1.0 - source.a;

    return vec4(
      source.rgb + dest.rgb * oneMinusSourceAlpha,
      source.a + dest.a * oneMinusSourceAlpha
    );
  }
  `),e.fragment.code.add(i.H`
  vec4 premultipliedColor(vec3 rgb, float alpha) {
    return vec4(rgb * alpha, alpha);
  }
  `),e.fragment.code.add(i.H`
  vec4 laserlineProfile(float dist) {
    if (dist > glowWidth) {
      return vec4(0.0);
    }

    float innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));
    float glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);

    return blendPremultiplied(
      premultipliedColor(innerColor, innerAlpha),
      premultipliedColor(glowColor, glowAlpha)
    );
  }
  `),e.fragment.code.add(i.H`
  bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float depthDiscontinuityAlpha) {
    float depth = linearDepthFromTexture(depthMap, uv, nearFar);

    if (-depth == nearFar[0]) {
      return false;
    }

    pos = reconstructPosition(gl_FragCoord.xy, depth);
    normal = normalize(cross(dFdx(pos), dFdy(pos)));

    float ddepth = fwidth(depth);
    depthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / depth);

    return true;
  }
  `),t.contrastControlEnabled?e.fragment.code.add(i.H`
    float rgbToLuminance(vec3 color) {
      return dot(vec3(0.2126, 0.7152, 0.0722), color);
    }

    vec4 laserlineOutput(vec4 color) {
      float backgroundLuminance = rgbToLuminance(texture2D(frameColor, uv).rgb);
      float alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);

      return color * alpha;
    }
    `):e.fragment.code.add(i.H`
    vec4 laserlineOutput(vec4 color) {
      return color * globalAlpha;
    }
    `)}},84444:(e,t,n)=>{"use strict";n.d(t,{k:()=>r});var i=n(85461);function r(e){e.attributes.add("position","vec2"),e.varyings.add("uv","vec2"),e.vertex.code.add(i.H`
    void main(void) {
      gl_Position = vec4(position, 0.0, 1.0);
      uv = position * 0.5 + vec2(0.5);
    }
  `)}},82768:(e,t,n)=>{"use strict";n.d(t,{U:()=>r});var i=n(85461);function r(e,t){e.vertex.uniforms.add("intrinsicWidth","float"),t.vvSize?(e.attributes.add("sizeFeatureAttribute","float"),e.vertex.uniforms.add("vvSizeMinSize","vec3"),e.vertex.uniforms.add("vvSizeMaxSize","vec3"),e.vertex.uniforms.add("vvSizeOffset","vec3"),e.vertex.uniforms.add("vvSizeFactor","vec3"),e.vertex.code.add(i.H`
    float getSize() {
      return intrinsicWidth * clamp(vvSizeOffset + sizeFeatureAttribute * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).x;
    }
    `)):(e.attributes.add("size","float"),e.vertex.code.add(i.H`
    float getSize(){
      return intrinsicWidth * size;
    }
    `)),t.vvOpacity?(e.attributes.add("opacityFeatureAttribute","float"),e.vertex.defines.addInt("VV_OPACITY_N",8),e.vertex.code.add(i.H`
    uniform float vvOpacityValues[VV_OPACITY_N];
    uniform float vvOpacityOpacities[VV_OPACITY_N];

    float interpolateOpacity( float value ){
      if (value <= vvOpacityValues[0]) {
        return vvOpacityOpacities[0];
      }

      for (int i = 1; i < VV_OPACITY_N; ++i) {
        if (vvOpacityValues[i] >= value) {
          float f = (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);
          return mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f);
        }
      }

      return vvOpacityOpacities[VV_OPACITY_N - 1];
    }

    vec4 applyOpacity( vec4 color ){
      return vec4(color.xyz, interpolateOpacity(opacityFeatureAttribute));
    }
    `)):e.vertex.code.add(i.H`
    vec4 applyOpacity( vec4 color ){
      return color;
    }
    `),t.vvColor?(e.attributes.add("colorFeatureAttribute","float"),e.vertex.defines.addInt("VV_COLOR_N",8),e.vertex.code.add(i.H`
    uniform float vvColorValues[VV_COLOR_N];
    uniform vec4 vvColorColors[VV_COLOR_N];

    vec4 interpolateColor( float value ) {
      if (value <= vvColorValues[0]) {
        return vvColorColors[0];
      }

      for (int i = 1; i < VV_COLOR_N; ++i) {
        if (vvColorValues[i] >= value) {
          float f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);
          return mix(vvColorColors[i-1], vvColorColors[i], f);
        }
      }

      return vvColorColors[VV_COLOR_N - 1];
    }

    vec4 getColor(){
      return applyOpacity(interpolateColor(colorFeatureAttribute));
    }
    `)):(e.attributes.add("color","vec4"),e.vertex.code.add(i.H`
    vec4 getColor(){
      return applyOpacity(color);
    }
    `))}},4071:(e,t,n)=>{"use strict";n.d(t,{S:()=>a});var i=n(85461),r=n(61017);function a(e){e.fragment.include(r.n),e.fragment.code.add(i.H`
    float linearDepthFromTexture(sampler2D depthTex, vec2 uv, vec2 nearFar) {
      return -(rgba2float(texture2D(depthTex, uv)) * (nearFar[1] - nearFar[0]) + nearFar[0]);
    }
  `)}},93077:(e,t,n)=>{"use strict";n.d(t,{q:()=>r});var i=n(85461);function r(e,t){e.defines.addFloat("STIPPLE_ALPHA_COLOR_DISCARD",.001),e.defines.addFloat("STIPPLE_ALPHA_HIGHLIGHT_DISCARD",.5),t.stippleEnabled?function(e,t){e.vertex.uniforms.add("stipplePatternPixelSizeInv","float"),t.stippleUVMaxEnabled&&e.varyings.add("stipplePatternUvMax","float"),e.varyings.add("stipplePatternUv","float"),e.fragment.uniforms.add("stipplePatternTexture","sampler2D"),t.stippleOffColorEnabled&&e.fragment.uniforms.add("stippleOffColor","vec4"),e.fragment.code.add(i.H`
  float getStippleAlpha() {
    float stipplePatternUvClamped = stipplePatternUv * gl_FragCoord.w;
    ${t.stippleUVMaxEnabled?"stipplePatternUvClamped = clamp(stipplePatternUvClamped, 0.0, stipplePatternUvMax);":""}

    return texture2D(stipplePatternTexture, vec2(mod(stipplePatternUvClamped, 1.0), 0.5)).a;
  }`),t.stippleOffColorEnabled?e.fragment.code.add(i.H`
    #define discardByStippleAlpha(stippleAlpha, threshold) {}
    #define blendStipple(color, stippleAlpha) mix(color, stippleOffColor, stippleAlpha)
    `):e.fragment.code.add(i.H`
    #define discardByStippleAlpha(stippleAlpha, threshold) if (stippleAlpha < threshold) { discard; }
    #define blendStipple(color, stippleAlpha) vec4(color.rgb, color.a * stippleAlpha)
    `)}(e,t):function(e){e.fragment.code.add(i.H`
  float getStippleAlpha() { return 1.0; }

  #define discardByStippleAlpha(_stippleAlpha_, _threshold_) {}
  #define blendStipple(color, _stippleAlpha_) color
  `)}(e)}},39746:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var i,r=n(77625),a=n(17387),s=n(69236),o=n(88);!function(e){e.length=function(e,t){const n=e[t],i=e[t+1],r=e[t+2];return Math.sqrt(n*n+i*i+r*r)},e.normalize=function(e,t){const n=e[t],i=e[t+1],r=e[t+2],a=1/Math.sqrt(n*n+i*i+r*r);e[t]*=a,e[t+1]*=a,e[t+2]*=a},e.scale=function(e,t,n){e[t]*=n,e[t+1]*=n,e[t+2]*=n},e.add=function(e,t,n,i,r,a=t){(r=r||e)[a]=e[t]+n[i],r[a+1]=e[t+1]+n[i+1],r[a+2]=e[t+2]+n[i+2]},e.subtract=function(e,t,n,i,r,a=t){(r=r||e)[a]=e[t]-n[i],r[a+1]=e[t+1]-n[i+1],r[a+2]=e[t+2]-n[i+2]}}(i||(i={}));var l=n(56469),c=n(69534);const d=i;var h,u,p,f;!function(e){const t=.5,n=[[-t,-t,t],[t,-t,t],[t,t,t],[-t,t,t],[-t,-t,-t],[t,-t,-t],[t,t,-t],[-t,t,-t]],i=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],r=[0,0,1,0,1,1,0,1],a=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],s=new Array(36);for(let e=0;e<6;e++)for(let t=0;t<6;t++)s[6*e+t]=e;const o=new Array(36);for(let e=0;e<6;e++)o[6*e+0]=0,o[6*e+1]=1,o[6*e+2]=2,o[6*e+3]=2,o[6*e+4]=3,o[6*e+5]=0;e.createGeometry=function(e){Array.isArray(e)||(e=[e,e,e]);const t=new Float32Array(24);for(let i=0;i<8;i++)t[3*i]=n[i][0]*e[0],t[3*i+1]=n[i][1]*e[1],t[3*i+2]=n[i][2]*e[2];const d={};d[l.Xt.POSITION]=new Uint32Array(a),d[l.Xt.NORMAL]=new Uint32Array(s),d[l.Xt.UV0]=new Uint32Array(o);const h={};return h[l.Xt.POSITION]={size:3,data:t},h[l.Xt.NORMAL]={size:3,data:new Float32Array(i)},h[l.Xt.UV0]={size:2,data:new Float32Array(r)},new c.b(h,d)}}(h||(h={})),function(e){const t=.5,n=[[-t,0,-t],[t,0,-t],[t,0,t],[-t,0,t],[0,-t,0],[0,t,0]],i=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],r=[5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],a=[0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7];e.createGeometry=function(e){Array.isArray(e)||(e=[e,e,e]);const t=new Float32Array(18);for(let i=0;i<6;i++)t[3*i]=n[i][0]*e[0],t[3*i+1]=n[i][1]*e[1],t[3*i+2]=n[i][2]*e[2];const s={};s[l.Xt.POSITION]=new Uint32Array(r),s[l.Xt.NORMAL]=new Uint32Array(a);const o={};return o[l.Xt.POSITION]={size:3,data:t},o[l.Xt.NORMAL]={size:3,data:new Float32Array(i)},new c.b(o,s)}}(u||(u={})),function(e){const t=.5,n=(0,s.f)(-t,0,-t),i=(0,s.f)(t,0,-t),r=(0,s.f)(0,0,t),o=(0,s.f)(0,.5,0),d=(0,s.c)(),h=(0,s.c)(),u=(0,s.c)(),p=(0,s.c)(),f=(0,s.c)();(0,a.f)(d,n,o),(0,a.f)(h,n,i),(0,a.c)(u,d,h),(0,a.n)(u,u),(0,a.f)(d,i,o),(0,a.f)(h,i,r),(0,a.c)(p,d,h),(0,a.n)(p,p),(0,a.f)(d,r,o),(0,a.f)(h,r,n),(0,a.c)(f,d,h),(0,a.n)(f,f);const m=[n,i,r,o],g=[0,-1,0,u[0],u[1],u[2],p[0],p[1],p[2],f[0],f[1],f[2]],v=[0,1,2,3,1,0,3,2,1,3,0,2],y=[0,0,0,1,1,1,2,2,2,3,3,3];e.createGeometry=function(e){Array.isArray(e)||(e=[e,e,e]);const t=new Float32Array(12);for(let n=0;n<4;n++)t[3*n]=m[n][0]*e[0],t[3*n+1]=m[n][1]*e[1],t[3*n+2]=m[n][2]*e[2];const n={};n[l.Xt.POSITION]=new Uint32Array(v),n[l.Xt.NORMAL]=new Uint32Array(y);const i={};return i[l.Xt.POSITION]={size:3,data:t},i[l.Xt.NORMAL]={size:3,data:new Float32Array(g)},new c.b(i,n)}}(p||(p={})),function(e){e.createBoxGeometry=h.createGeometry,e.createDiamondGeometry=u.createGeometry,e.createTetrahedronGeometry=p.createGeometry,e.createSphereGeometry=function(e,t,n,i){const{phiStart:r=-Math.PI,phiLength:a=2*Math.PI,thetaStart:s=-Math.PI/2,thetaLength:o=Math.PI}=i||{},{position:d=l.Xt.POSITION,normal:h=l.Xt.NORMAL,uv:u=l.Xt.UV0}=(null==i?void 0:i.attributes)||{},p=Math.max(3,Math.floor(t)),f=Math.max(2,Math.floor(n)),m=(p+1)*(f+1),g=new Float32Array(3*m),v=new Float32Array(3*m),y=new Float32Array(2*m),_=[];let b=0;for(let t=0;t<=f;t++){const n=[],i=t/f,l=s+i*o,c=Math.cos(l);for(let t=0;t<=p;t++){const s=t/p,o=r+s*a,d=Math.cos(o)*c,h=Math.sin(l),u=-Math.sin(o)*c;g[3*b]=d*e,g[3*b+1]=h*e,g[3*b+2]=u*e,v[3*b]=d,v[3*b+1]=h,v[3*b+2]=u,y[2*b]=s,y[2*b+1]=i,n.push(b),++b}_.push(n)}const x=new Uint32Array(2*p*(f-1)*3);b=0;for(let e=0;e<f;e++)for(let t=0;t<p;t++){const n=_[e][t],i=_[e][t+1],r=_[e+1][t+1],a=_[e+1][t];0===e?(x[b++]=n,x[b++]=r,x[b++]=a):e===f-1?(x[b++]=n,x[b++]=i,x[b++]=r):(x[b++]=n,x[b++]=i,x[b++]=r,x[b++]=r,x[b++]=a,x[b++]=n)}const S={};S[d]=x,S[h]=x;const A={};return A[d]={size:3,data:g},A[h]={size:3,data:v},u&&(A[u]={size:2,data:y},S[u]=x),new c.b(A,S)},e.createPolySphereGeometry=function(e,t,n){const i=e;let r,a;if(n)r=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],a=new Uint32Array([0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1]);else{const e=i*(1+Math.sqrt(5))/2;r=[-i,e,0,i,e,0,-i,-e,0,i,-e,0,0,-i,e,0,i,e,0,-i,-e,0,i,-e,e,0,-i,e,0,i,-e,0,-i,-e,0,i],a=new Uint32Array([0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1])}for(let t=0;t<r.length;t+=3)d.scale(r,t,e/d.length(r,t));let s={};function o(t,n){t>n&&([t,n]=[n,t]);const i=t.toString()+"."+n.toString();if(s[i])return s[i];let a=r.length;return r.length+=3,d.add(r,3*t,r,3*n,r,a),d.scale(r,a,e/d.length(r,a)),a/=3,s[i]=a,a}for(let e=0;e<t;e++){const e=a.length,t=new Uint32Array(4*e);for(let n=0;n<e;n+=3){const e=a[n],i=a[n+1],r=a[n+2],s=o(e,i),l=o(i,r),c=o(r,e),d=4*n;t[d]=e,t[d+1]=s,t[d+2]=c,t[d+3]=i,t[d+4]=l,t[d+5]=s,t[d+6]=r,t[d+7]=c,t[d+8]=l,t[d+9]=s,t[d+10]=l,t[d+11]=c}a=t,s={}}const h=new Float32Array(r);for(let e=0;e<h.length;e+=3)d.normalize(h,e);const u={};u[l.Xt.POSITION]=a,u[l.Xt.NORMAL]=a;const p={};return p[l.Xt.POSITION]={size:3,data:new Float32Array(r)},p[l.Xt.NORMAL]={size:3,data:h},new c.b(p,u)},e.createPointGeometry=function(e,t,n,i,r,a,s,o){const d=t?new Float64Array([t[0],t[1],t[2]]):new Float32Array([0,0,0]),h=e?new Float32Array([e[0],e[1],e[2]]):new Float32Array([0,0,1]),u=a?new Float32Array(a):new Float32Array([0,0]),p=n?new Uint8Array([255*n[0],255*n[1],255*n[2],n.length>3?255*n[3]:255]):new Uint8Array([255,255,255,255]),f=null!=i&&2===i.length?new Float32Array(i):new Float32Array([1,1]),m={};if(m[l.Xt.POSITION]={size:3,data:d},m[l.Xt.NORMAL]={size:3,data:h},m[l.Xt.UV0]={size:u.length,data:u},m[l.Xt.COLOR]={size:4,data:p},m[l.Xt.SIZE]={size:2,data:f},null!=r){const e=new Float32Array([r[0],r[1],r[2],r[3]]);m[l.Xt.AUXPOS1]={size:4,data:e}}if(null!=s){const e=new Float32Array([s[0],s[1],s[2],s[3]]);m[l.Xt.AUXPOS2]={size:4,data:e}}return null!=o?(o.initialize(m,c.b.DefaultIndices,"point"),o):new c.b(m,c.b.DefaultIndices,"point")},e.updatePointGeometry=function(e,t,n,i,r,a,s,o){const c=o.vertexAttributes;if(null!=e){const{data:t}=c[l.Xt.NORMAL];t[0]=e[0],t[1]=e[1],t[2]=e[2]}if(null!=t){const{data:e}=c[l.Xt.POSITION];e[0]=t[0],e[1]=t[1],e[2]=t[2]}if(null!=n){const{data:e}=c[l.Xt.COLOR];e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3]}if(null!=i){const{data:e}=c[l.Xt.SIZE];e[0]=i[0],e[1]=i[1]}if(null!=r){const{data:e}=c[l.Xt.AUXPOS1];e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3]}if(null!=a){const{data:e}=c[l.Xt.UV0];e[0]=a[0],e[1]=a[1]}if(null!=s){const{data:e}=c[l.Xt.AUXPOS2];e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3]}return o},e.createPointArrayGeometry=function(e,t){const n=new Float32Array(3*e.length),i=new Float32Array(t?3*e.length:3),r=new Uint32Array(e.length),a=new Uint32Array(e.length);for(let s=0;s<e.length;s++)n[3*s]=e[s][0],n[3*s+1]=e[s][1],n[3*s+2]=e[s][2],t&&(i[3*s]=t[s][0],i[3*s+1]=t[s][1],i[3*s+2]=t[s][2]),r[s]=s,a[s]=0;t||(i[0]=0,i[1]=1,i[2]=0);const s=new Float32Array(2);s[0]=0,s[1]=0;const o={};o[l.Xt.POSITION]=r,o[l.Xt.NORMAL]=t?r:a,o[l.Xt.UV0]=a;const d={};return d[l.Xt.POSITION]={size:3,data:n},d[l.Xt.NORMAL]={size:3,data:i},d[l.Xt.UV0]={size:2,data:s},new c.b(d,o,"point")},e.createTriangleGeometry=function(){const e=new Float32Array([0,0,0,0,0,100,100,0,0]),t=new Uint32Array([0,1,2]),n=new Float32Array([0,1,0]),i=new Uint32Array([0,0,0]),r=new Float32Array([0,0]),a=new Uint32Array([0,0,0]),s={};s[l.Xt.POSITION]=t,s[l.Xt.NORMAL]=i,s[l.Xt.UV0]=a;const o={};return o[l.Xt.POSITION]={size:3,data:e},o[l.Xt.NORMAL]={size:3,data:n},o[l.Xt.UV0]={size:2,data:r},new c.b(o,s)};const t=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]];function n(e,t,n,i,r){return!(Math.abs((0,a.d)(t,e))>r||((0,a.c)(n,e,t),(0,a.n)(n,n),(0,a.c)(i,n,e),(0,a.n)(i,i),0))}function i(e,t,i,r,a,s,o){return n(e,t,a,s,o)||n(e,i,a,s,o)||n(e,r,a,s,o)}e.createSquareGeometry=function(e=t){const n=new Float64Array(12);for(let t=0;t<4;t++)for(let i=0;i<3;i++)n[3*t+i]=e[t][i];const i=new Uint32Array([0,1,2,2,3,0]),r=new Float32Array([0,0,1]),a=new Uint32Array([0,0,0,0,0,0]),s=new Float32Array([0,0,1,0,1,1,0,1]),o=new Uint8Array([255,255,255,255]),d={[l.Xt.POSITION]:i,[l.Xt.NORMAL]:a,[l.Xt.UV0]:i,[l.Xt.COLOR]:a},h={[l.Xt.POSITION]:{size:3,data:n},[l.Xt.NORMAL]:{size:3,data:r},[l.Xt.UV0]:{size:2,data:s},[l.Xt.COLOR]:{size:4,data:o}};return new c.b(h,d)},e.createConeGeometry=function(e,t,n,i,r=!0,a=!0){let o=0;const d=t,h=e;let u=(0,s.f)(0,o,0),p=(0,s.f)(0,o+h,0),f=(0,s.f)(0,-1,0),m=(0,s.f)(0,1,0);i&&(o=h,p=(0,s.f)(0,0,0),u=(0,s.f)(0,o,0),f=(0,s.f)(0,1,0),m=(0,s.f)(0,-1,0));const g=[p,u],v=[f,m],y=n+2,_=Math.sqrt(h*h+d*d);if(i)for(let e=n-1;e>=0;e--){const t=e*(2*Math.PI/n),i=(0,s.f)(Math.cos(t)*d,o,Math.sin(t)*d);g.push(i);const r=(0,s.f)(h*Math.cos(t)/_,-d/_,h*Math.sin(t)/_);v.push(r)}else for(let e=0;e<n;e++){const t=e*(2*Math.PI/n),i=(0,s.f)(Math.cos(t)*d,o,Math.sin(t)*d);g.push(i);const r=(0,s.f)(h*Math.cos(t)/_,d/_,h*Math.sin(t)/_);v.push(r)}const b=new Uint32Array(2*(n+2)*3),x=new Uint32Array(2*(n+2)*3);let S=0,A=0;if(r){for(let e=3;e<g.length;e++)b[S++]=1,b[S++]=e-1,b[S++]=e,x[A++]=0,x[A++]=0,x[A++]=0;b[S++]=g.length-1,b[S++]=2,b[S++]=1,x[A++]=0,x[A++]=0,x[A++]=0}if(a){for(let e=3;e<g.length;e++)b[S++]=e,b[S++]=e-1,b[S++]=0,x[A++]=e,x[A++]=e-1,x[A++]=1;b[S++]=0,b[S++]=2,b[S++]=g.length-1,x[A++]=1,x[A++]=2,x[A++]=v.length-1}const P=new Float32Array(3*y);for(let e=0;e<y;e++)P[3*e]=g[e][0],P[3*e+1]=g[e][1],P[3*e+2]=g[e][2];const O=new Float32Array(3*y);for(let e=0;e<y;e++)O[3*e]=v[e][0],O[3*e+1]=v[e][1],O[3*e+2]=v[e][2];const C={};C[l.Xt.POSITION]=b,C[l.Xt.NORMAL]=x;const w={};return w[l.Xt.POSITION]={size:3,data:P},w[l.Xt.NORMAL]={size:3,data:O},new c.b(w,C)},e.createCylinderGeometry=function(e,t,n,i,r,o){const d=i?(0,s.a)(i):(0,s.f)(1,0,0),h=r?(0,s.a)(r):(0,s.f)(0,0,0),u=void 0===o||o,p=(0,s.c)();(0,a.n)(p,d);const f=(0,s.c)();(0,a.a)(f,p,Math.abs(e));const m=(0,s.c)();(0,a.a)(m,f,-.5),(0,a.b)(m,m,h);const g=(0,s.f)(0,1,0);Math.abs(1-(0,a.d)(p,g))<.2&&(0,a.s)(g,0,0,1);const v=(0,s.c)();(0,a.c)(v,p,g),(0,a.n)(v,v),(0,a.c)(g,v,p);const y=2*n+(u?2:0),_=n+(u?2:0),b=new Float32Array(3*y),x=new Float32Array(3*_),S=new Float32Array(2*y),A=new Uint32Array(3*n*(u?4:2)),P=new Uint32Array(3*n*(u?4:2));u&&(b[3*(y-2)+0]=m[0],b[3*(y-2)+1]=m[1],b[3*(y-2)+2]=m[2],S[2*(y-2)]=0,S[2*(y-2)+1]=0,b[3*(y-1)+0]=b[3*(y-2)+0]+f[0],b[3*(y-1)+1]=b[3*(y-2)+1]+f[1],b[3*(y-1)+2]=b[3*(y-2)+2]+f[2],S[2*(y-1)]=1,S[2*(y-1)+1]=1,x[3*(_-2)+0]=-p[0],x[3*(_-2)+1]=-p[1],x[3*(_-2)+2]=-p[2],x[3*(_-1)+0]=p[0],x[3*(_-1)+1]=p[1],x[3*(_-1)+2]=p[2]);const O=function(e,t,n){A[e]=t,P[e]=n};let C=0;const w=(0,s.c)(),E=(0,s.c)();for(let e=0;e<n;e++){const i=e*(2*Math.PI/n);(0,a.a)(w,g,Math.sin(i)),(0,a.a)(E,v,Math.cos(i)),(0,a.b)(w,w,E),x[3*e+0]=w[0],x[3*e+1]=w[1],x[3*e+2]=w[2],(0,a.a)(w,w,t),(0,a.b)(w,w,m),b[3*e+0]=w[0],b[3*e+1]=w[1],b[3*e+2]=w[2],S[2*e+0]=e/n,S[2*e+1]=0,b[3*(e+n)+0]=b[3*e+0]+f[0],b[3*(e+n)+1]=b[3*e+1]+f[1],b[3*(e+n)+2]=b[3*e+2]+f[2],S[2*(e+n)+0]=e/n,S[2*e+1]=1;const r=(e+1)%n;O(C++,e,e),O(C++,e+n,e),O(C++,r,r),O(C++,r,r),O(C++,e+n,e),O(C++,r+n,r)}if(u){for(let e=0;e<n;e++){const t=(e+1)%n;O(C++,y-2,_-2),O(C++,e,_-2),O(C++,t,_-2)}for(let e=0;e<n;e++){const t=(e+1)%n;O(C++,e+n,_-1),O(C++,y-1,_-1),O(C++,t+n,_-1)}}const D={};D[l.Xt.POSITION]=A,D[l.Xt.NORMAL]=P,D[l.Xt.UV0]=A;const M={};return M[l.Xt.POSITION]={size:3,data:b},M[l.Xt.NORMAL]={size:3,data:x},M[l.Xt.UV0]={size:2,data:S},new c.b(M,D)},e.createTubeGeometry=function(t,n,i,r,a){i=i||10,r=null==r||r,(0,l.hu)(t.length>1);const s=[],o=[];for(let e=0;e<i;e++){s.push([0,-e-1,-(e+1)%i-1]);const t=e/i*2*Math.PI;o.push([Math.cos(t)*n,Math.sin(t)*n])}return e.createPathExtrusionGeometry(o,t,[[0,0,0]],s,r,a)},e.createPathExtrusionGeometry=function(e,t,n,d,h,u=(0,s.f)(0,0,0)){const p=e.length,f=new Float32Array(t.length*p*3+(6*n.length||0)),g=new Float32Array(t.length*p+(2*n.length||0)),v=new Float32Array(t.length*p*3+(n?6:0)),y=(t.length-1)*p*6+3*d.length*2,_=new Uint32Array(y),b=new Uint32Array(y);let x=0,S=0,A=0,P=0,O=0;const C=(0,s.c)(),w=(0,s.c)(),E=(0,s.c)(),D=(0,s.c)(),M=(0,s.c)(),R=(0,s.c)(),I=(0,s.c)(),T=(0,r.c)(),z=(0,s.c)(),V=(0,s.c)(),L=(0,s.c)(),U=(0,s.c)(),N=(0,s.c)(),F=o.yC.create();(0,a.s)(z,0,1,0),(0,a.f)(w,t[1],t[0]),(0,a.n)(w,w),h?((0,a.b)(T,t[0],u),(0,a.n)(E,T)):(0,a.s)(E,0,0,1),i(w,E,z,z,M,E,m),(0,a.g)(D,E),(0,a.g)(U,M);for(let e=0;e<n.length;e++)(0,a.a)(R,M,n[e][0]),(0,a.a)(T,E,n[e][2]),(0,a.b)(R,R,T),(0,a.b)(R,R,t[0]),f[x++]=R[0],f[x++]=R[1],f[x++]=R[2],g[A++]=0;v[S++]=-w[0],v[S++]=-w[1],v[S++]=-w[2];for(let e=0;e<d.length;e++)_[P++]=d[e][0]>0?d[e][0]:-d[e][0]-1+n.length,_[P++]=d[e][1]>0?d[e][1]:-d[e][1]-1+n.length,_[P++]=d[e][2]>0?d[e][2]:-d[e][2]-1+n.length,b[O++]=0,b[O++]=0,b[O++]=0;let j=n.length;const q=n.length-1;for(let n=0;n<t.length;n++){let r=!1;n>0&&((0,a.g)(C,w),n<t.length-1?((0,a.f)(w,t[n+1],t[n]),(0,a.n)(w,w)):r=!0,(0,a.b)(V,C,w),(0,a.n)(V,V),(0,a.b)(L,t[n-1],D),o.yC.fromPositionAndNormal(t[n],V,F),o.yC.intersectRay(F,o.kx.wrap(L,C),T)?((0,a.f)(T,T,t[n]),(0,a.n)(E,T),(0,a.c)(M,V,E),(0,a.n)(M,M)):i(V,D,U,z,M,E,m),(0,a.g)(D,E),(0,a.g)(U,M)),h&&((0,a.b)(T,t[n],u),(0,a.n)(N,T));for(let i=0;i<p;i++)if((0,a.a)(R,M,e[i][0]),(0,a.a)(T,E,e[i][1]),(0,a.b)(R,R,T),(0,a.n)(I,R),v[S++]=I[0],v[S++]=I[1],v[S++]=I[2],g[A++]=h?(0,a.d)(R,N):R[2],(0,a.b)(R,R,t[n]),f[x++]=R[0],f[x++]=R[1],f[x++]=R[2],!r){const e=(i+1)%p;_[P++]=j+i,_[P++]=j+p+i,_[P++]=j+e,_[P++]=j+e,_[P++]=j+p+i,_[P++]=j+p+e;for(let e=0;e<6;e++)b[O++]=_[P-6+e]-q}j+=p}const H=t[t.length-1];for(let e=0;e<n.length;e++)(0,a.a)(R,M,n[e][0]),(0,a.a)(T,E,n[e][1]),(0,a.b)(R,R,T),(0,a.b)(R,R,H),f[x++]=R[0],f[x++]=R[1],f[x++]=R[2],g[A++]=0;const Z=S/3;v[S++]=w[0],v[S++]=w[1],v[S++]=w[2];const X=j-p;for(let e=0;e<d.length;e++)_[P++]=d[e][0]>=0?j+d[e][0]:-d[e][0]-1+X,_[P++]=d[e][2]>=0?j+d[e][2]:-d[e][2]-1+X,_[P++]=d[e][1]>=0?j+d[e][1]:-d[e][1]-1+X,b[O++]=Z,b[O++]=Z,b[O++]=Z;const W={};W[l.Xt.POSITION]=_,W[l.Xt.NORMAL]=b;const B={};return B[l.Xt.POSITION]={size:3,data:f},B.zOffset={size:1,data:g},B[l.Xt.NORMAL]={size:3,data:v},new c.b(B,W)},e.createPolylineGeometry=function(e,t){(0,l.hu)(e.length>1,"createPolylineGeometry(): polyline needs at least 2 points"),(0,l.hu)(3===e[0].length,"createPolylineGeometry(): malformed vertex"),(0,l.hu)(void 0===t||t.length===e.length,"createPolylineGeometry: need same number of points and normals"),(0,l.hu)(void 0===t||3===t[0].length,"createPolylineGeometry(): malformed normal");const n=new Float64Array(3*e.length),i=new Uint32Array(2*(e.length-1));let r=0,a=0;for(let t=0;t<e.length;t++){for(let i=0;i<3;i++)n[r++]=e[t][i];t>0&&(i[a++]=t-1,i[a++]=t)}const s={},o={};if(s[l.Xt.POSITION]=i,o[l.Xt.POSITION]={size:3,data:n},t){const n=new Float32Array(3*t.length);let r=0;for(let i=0;i<e.length;i++)for(let e=0;e<3;e++)n[r++]=t[i][e];s[l.Xt.NORMAL]=i,o[l.Xt.NORMAL]={size:3,data:n}}return new c.b(o,s,"line")},e.createExtrudedTriangle=function(e,t,n,i){const r=new Float32Array(18),a=[[-t,0,i/2],[n,0,i/2],[0,e,i/2],[-t,0,-i/2],[n,0,-i/2],[0,e,-i/2]];for(let e=0;e<6;e++)r[3*e]=a[e][0],r[3*e+1]=a[e][1],r[3*e+2]=a[e][2];const s={[l.Xt.POSITION]:new Uint32Array([0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5])},o={[l.Xt.POSITION]:{size:3,data:r}};return new c.b(o,s)},e.transformInPlace=function(e,t){const n=e.vertexAttributes[l.Xt.POSITION].data;for(let e=0;e<n.length;e+=3){const i=n[e],r=n[e+1],s=n[e+2];(0,a.s)(g,i,r,s),(0,a.i)(g,g,t),n[e]=g[0],n[e+1]=g[1],n[e+2]=g[2]}},e.cgToGIS=function(e,t=e){const n=e.getVertexAttr(),i=n.position.data,r=n.normal.data,a=t.getVertexAttr(),s=a.position.data,o=a.normal.data;if(r)for(let e=0;e<r.length;e+=3){const t=r[e+1];o[e+1]=-r[e+2],o[e+2]=t}if(i)for(let e=0;e<i.length;e+=3){const t=i[e+1];s[e+1]=-i[e+2],s[e+2]=t}return t},e.makeOrthoBasisDirUp=n,e.makeOrthoBasisDirUpFallback=i}(f||(f={}));const m=.99619469809,g=(0,s.c)();const v=f},89852:(e,t,n)=>{"use strict";n.d(t,{Z:()=>L});var i=n(35470),r=n(77625),a=n(15853),s=n(38035),o=n(62698),l=n(17387),c=n(88),d=n(56469);class h{constructor(e,t,n=0){this.center=(0,r.c)(),this.initFrom(e,t,n,0)}init(e){return this.initFrom(e.node,e.center,e.halfSize,e.depth)}initFrom(e=null,t,n=this.halfSize,i=this.depth){return this.node=e||h.createEmptyNode(),t&&(0,l.g)(this.center,t),this.halfSize=n,this.depth=i,this}advance(e){let t=this.node.children[e];t||(t=h.createEmptyNode(),this.node.children[e]=t),this.node=t,this.halfSize/=2,this.depth++;const n=y[e];return this.center[0]+=n[0]*this.halfSize,this.center[1]+=n[1]*this.halfSize,this.center[2]+=n[2]*this.halfSize,this}advanceTo(e,t,n=!1){for(;;){if(this.isTerminalFor(e))return t&&t(this,-1),!0;if(this.isLeaf()&&!n)return t&&t(this,-1),!1;this.isLeaf()&&(this.node.residents=null);const i=this._childIndex(e);t&&t(this,i),this.advance(i)}}isLeaf(){return null!=this.node.residents}isTerminalFor(e){return e.radius>this.halfSize/2}_childIndex(e){const t=e.center,n=this.center;let i=0;for(let e=0;e<3;e++)n[e]<t[e]&&(i|=1<<e);return i}static createEmptyNode(){return{children:[null,null,null,null,null,null,null,null],terminals:new o.Z({shrink:!0}),residents:new o.Z({shrink:!0})}}static acquire(){return h._pool.acquire()}static release(e){h._pool.release(e)}static clearPool(){h._pool.prune()}}function u(e,t,n){e[0]=Math.min(e[0],t[0]-n),e[1]=Math.min(e[1],t[1]-n),e[2]=Math.min(e[2],t[2]-n)}function p(e,t,n){e[0]=Math.max(e[0],t[0]+n),e[1]=Math.max(e[1],t[1]+n),e[2]=Math.max(e[2],t[2]+n)}function f(e,t,n){return(n=n||e)[0]=e[0]+t,n[1]=e[1]+t,n[2]=e[2]+t,n}function m(e,t,n){return!c.oy.intersectsSphere(n.planes,c.Dv.wrap(t,e))}function g(e,t){let n=1/0,i=null;for(let r=0;r<8;++r){const a=v(e,t,_[r]);a<n&&(n=a,i=_[r])}return i}function v(e,t,n){return t*(e[0]*n[0]+e[1]*n[1]+e[2]*n[2])}h._pool=new s.Z(h);const y=[(0,r.f)(-1,-1,-1),(0,r.f)(1,-1,-1),(0,r.f)(-1,1,-1),(0,r.f)(1,1,-1),(0,r.f)(-1,-1,1),(0,r.f)(1,-1,1),(0,r.f)(-1,1,1),(0,r.f)(1,1,1)],_=[(0,r.f)(-1,-1,-1),(0,r.f)(-1,-1,1),(0,r.f)(-1,1,-1),(0,r.f)(-1,1,1),(0,r.f)(1,-1,-1),(0,r.f)(1,-1,1),(0,r.f)(1,1,-1),(0,r.f)(1,1,1)],b=Math.sqrt(3),x=[null];function S(e){return Array.isArray(e)?e:(x[0]=e,x)}const A=(0,r.c)(),P=(0,r.c)(),O=(0,r.c)(),C=(0,r.c)(),w=new o.Z,E={center:(0,r.c)(),radius:0},D={center:(0,r.c)(),radius:0},M={center:(0,r.c)(),radius:0},R={center:(0,r.c)(),radius:0},I=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],T=new o.Z,z=new o.Z;class V extends i.Z{constructor(e,t,n){super(),this._parentStages=new Map,this._objects=new Set,this.id=V._idGen.gen(e),this.apiLayerUid=n,this.name=e,t=t||{},this.group=t.group||"",this.isVisible=null==t.isVisible||t.isVisible,this.isPickable=null==t.isPickable||t.isPickable,this.isSliceable=!1,this.translation=t.translation?(0,r.b)(t.translation):(0,r.c)()}addParentStage(e){if(!this._parentStages.has(e)){const t=this.on("dirty",(t=>{e.notifyDirty(t.origin,t.dirtyType,t.subObject)}));this._parentStages.set(e,t)}}removeParentStage(e){const t=this._parentStages.get(e);t&&(t.remove(),this._parentStages.delete(e)),this.invalidateSpatialQueryAccelerator()}getName(){return this.name}getGroup(){return this.group}getTranslation(){return this.translation}getObjectIds(){return Array.from(this._objects,(e=>e.id))}getObjects(){return[...this._objects]}addObject(e){this._objects.add(e),e.parentLayer=this,this.notifyDirty("layerObjectAdded",e),this._octree&&this._octree.add(e)}hasObject(e){return this._objects.has(e)}removeObject(e){return!!this._objects.delete(e)&&(e.parentLayer=null,this.notifyDirty("layerObjectRemoved",e),this._octree&&this._octree.remove(e),!0)}notifyObjectBBChanged(e,t){this._octree&&this._octree.update(e,t)}getSpatialQueryAccelerator(){return!this._octree&&this._objects.size>50&&this._createOctree(),this._octree}shaderTransformationChanged(){this.notifyDirty("shaderTransformationChanged",null)}invalidateSpatialQueryAccelerator(){this._octree&&(this._octree.destroy(),this._octree=null)}notifyDirty(e,t,n,i){const r={origin:i||this,dirtyType:e,subObject:t};this.emit("dirty",r)}_createOctree(){this._octree=new class{constructor(e,t){this._objectToBoundingSphere=e,this._maximumObjectsPerNode=10,this._maximumDepth=20,this._degenerateObjects=new Set,this._objectCount=0,t&&(void 0!==t.maximumObjectsPerNode&&(this._maximumObjectsPerNode=t.maximumObjectsPerNode),void 0!==t.maximumDepth&&(this._maximumDepth=t.maximumDepth)),this._root=new h(null,(0,r.f)(0,0,0),0)}get center(){return this._root.center}get size(){return 2*this._root.halfSize}get root(){return this._root.node}get maximumObjectsPerNode(){return this._maximumObjectsPerNode}get maximumDepth(){return this._maximumDepth}get objectCount(){return this._objectCount}destroy(){this._degenerateObjects.clear(),this._root=null,h.clearPool(),x[0]=null,w.prune(),T.prune(),z.prune()}add(e,t){const n=S(e);t=null==t?n.length:t,this._objectCount+=t,this._grow(n,t);const i=h.acquire();for(let e=0;e<t;e++){const t=n[e];this._isDegenerate(t)?this._degenerateObjects.add(t):(i.init(this._root),this._add(t,i))}h.release(i)}remove(e,t){const n=S(e);this._objectCount-=n.length;const i=h.acquire();for(const e of n){const n=t||this._boundingSphereFromObject(e,E);this._isValidRadius(n.radius)?(i.init(this._root),this._remove(e,n,i)):this._degenerateObjects.delete(e)}h.release(i),this._shrink()}update(e,t){!this._isValidRadius(t.radius)&&this._isDegenerate(e)||(this.remove(e,t),this.add(e))}forEachAlongRay(e,t,n){const i=c.kx.wrap(e,t);this._forEachNode(this._root,(e=>{if(!this._intersectsNode(i,e))return!1;const t=e.node;return t.terminals.forAll((e=>{this._intersectsObject(i,e)&&n(e)})),null!==t.residents&&t.residents.forAll((e=>{this._intersectsObject(i,e)&&n(e)})),!0}))}forEachAlongRayWithVerticalOffset(e,t,n,i){const r=c.kx.wrap(e,t);this._forEachNode(this._root,(e=>{if(!this._intersectsNodeWithOffset(r,e,i))return!1;const t=e.node;return t.terminals.forAll((e=>{this._intersectsObjectWithOffset(r,e,i)&&n(e)})),null!==t.residents&&t.residents.forAll((e=>{this._intersectsObjectWithOffset(r,e,i)&&n(e)})),!0}))}forEach(e){this._forEachNode(this._root,(t=>{const n=t.node;return n.terminals.forAll(e),null!==n.residents&&n.residents.forAll(e),!0})),this._degenerateObjects.forEach(e)}forEachDegenerateObject(e){this._degenerateObjects.forEach(e)}findClosest(e,t,n,i,r){return this._findClosest(e,"front-to-back"===t?1:-1,n,i,r)}forEachInDepthRange(e,t,n,i,r,a,s,o){this._forEachInDepthRange(e,t,"front-to-back"===n?1:-1,i,r,a,s,o)}forEachNode(e){this._forEachNode(this._root,(t=>e(t.node,t.center,2*t.halfSize)))}_intersectsNode(e,t){return f(t.center,2*-t.halfSize,O),f(t.center,2*t.halfSize,C),(0,d.yK)(e.origin,e.direction,O,C)}_intersectsNodeWithOffset(e,t,n){return f(t.center,2*-t.halfSize,O),f(t.center,2*t.halfSize,C),n.applyToMinMax(O,C),(0,d.yK)(e.origin,e.direction,O,C)}_intersectsObject(e,t){const n=this._objectToBoundingSphere.getRadius(t);return!(n>0)||c.Dv.intersectsRay(c.Dv.wrap(n,this._objectToBoundingSphere.getCenter(t)),e)}_intersectsObjectWithOffset(e,t,n){const i=this._objectToBoundingSphere.getRadius(t);return!(i>0)||c.Dv.intersectsRay(n.applyToBoundingSphere(i,this._objectToBoundingSphere.getCenter(t)),e)}_forEachNode(e,t){let n=h.acquire().init(e);const i=[n];for(;0!==i.length;){if(n=i.pop(),t(n)&&!n.isLeaf())for(let e=0;e<n.node.children.length;e++)n.node.children[e]&&i.push(h.acquire().init(n).advance(e));h.release(n)}}_forEachNodeDepthOrdered(e,t,n,i=1){let r=h.acquire().init(e);const a=[r];for(function(e,t,n){if(!T.length)for(let e=0;e<8;++e)T.push({index:0,distance:0});for(let n=0;n<8;++n){const i=y[n];T.data[n].index=n,T.data[n].distance=v(e,t,i)}T.sort(((e,t)=>e.distance-t.distance)),n.clear();for(let e=0;e<8;++e)n.push(T.data[e].index)}(n,i,z);0!==a.length;){if(r=a.pop(),t(r)&&!r.isLeaf())for(let e=7;e>=0;--e){const t=z.data[e];t>=r.node.children.length||r.node.children[t]&&a.push(h.acquire().init(r).advance(t))}h.release(r)}}_findClosest(e,t,n,i,r){let a=1/0,s=1/0,o=null;const c=g(e,t);let d=0;const h=r=>{if(++d,i&&!i(r))return;const l=this._objectToBoundingSphere.getCenter(r),c=this._objectToBoundingSphere.getRadius(r);if(n&&m(l,c,n))return;const h=v(e,t,l),u=h-c;u<a&&(a=u,s=h+c,o=r)};return this._forEachNodeDepthOrdered(this._root,(i=>{if(null!=r&&d>=r)return!1;if(n&&m(i.center,i.halfSize*b,n))return!1;if((0,l.a)(P,c,i.halfSize),(0,l.b)(P,P,i.center),v(e,t,P)>s)return!1;const a=i.node;return a.terminals.forAll((e=>{h(e)})),null!==a.residents&&a.residents.forAll((e=>{h(e)})),!0}),e,t),o}_forEachInDepthRange(e,t,n,i,r,a,s,o){let c=-1/0,d=1/0;const h={setRange:e=>{1===n?(c=Math.max(c,e.near),d=Math.min(d,e.far)):(c=Math.max(c,-e.far),d=Math.min(d,-e.near))}};h.setRange(i);const u=v(t,n,e),p=g(t,n),f=g(t,-1*n);let y=0;const _=e=>{if(++y,s&&!s(e))return;const i=this._objectToBoundingSphere.getCenter(e),o=this._objectToBoundingSphere.getRadius(e),l=v(t,n,i)-u;l-o>d||l+o<c||a&&m(i,o,a)||r(e,h)};this._forEachNodeDepthOrdered(this._root,(e=>{if(null!=o&&y>=o)return!1;if(a&&m(e.center,e.halfSize*b,a))return!1;if((0,l.a)(P,p,e.halfSize),(0,l.b)(P,P,e.center),v(t,n,P)-u>d)return!1;if((0,l.a)(P,f,e.halfSize),(0,l.b)(P,P,e.center),v(t,n,P)-u<c)return!1;const i=e.node;return i.terminals.forAll((e=>{_(e)})),null!==i.residents&&i.residents.forAll((e=>{_(e)})),!0}),t,n)}_remove(e,t,n){w.clear();const i=n.advanceTo(t,((e,t)=>{w.push(e.node),w.push(t)}))?n.node.terminals:n.node.residents;if(i.removeUnordered(e),0===i.length)for(let e=w.length-2;e>=0;e-=2){const t=w.data[e],n=w.data[e+1];if(!this._purge(t,n))break}}_nodeIsEmpty(e){if(0!==e.terminals.length)return!1;if(null!==e.residents)return 0===e.residents.length;for(let t=0;t<e.children.length;t++)if(e.children[t])return!1;return!0}_purge(e,t){return t>=0&&(e.children[t]=null),!!this._nodeIsEmpty(e)&&(null===e.residents&&(e.residents=new o.Z({shrink:!0})),!0)}_add(e,t){t.advanceTo(this._boundingSphereFromObject(e,E))?t.node.terminals.push(e):(t.node.residents.push(e),t.node.residents.length>this._maximumObjectsPerNode&&t.depth<this._maximumDepth&&this._split(t))}_split(e){const t=e.node.residents;e.node.residents=null;for(let n=0;n<t.length;n++){const i=h.acquire().init(e);this._add(t.data[n],i),h.release(i)}}_grow(e,t){if(0===t)return;const n=this._boundingSphereFromObjects(e,t,((e,t)=>this._boundingSphereFromObject(e,t)),D);if(this._isValidRadius(n.radius)&&!this._fitsInsideTree(n))if(this._nodeIsEmpty(this._root.node))(0,l.g)(this._root.center,n.center),this._root.halfSize=1.25*n.radius;else{const e=h.acquire();this._rootBoundsForRootAsSubNode(n,e),this._placingRootViolatesMaxDepth(e)?this._rebuildTree(n,e):this._growRootAsSubNode(e),h.release(e)}}_rebuildTree(e,t){(0,l.g)(M.center,t.center),M.radius=t.halfSize;const n=this._boundingSphereFromObjects([e,M],2,(e=>e),R),i=h.acquire().init(this._root);this._root.initFrom(null,n.center,1.25*n.radius),this._forEachNode(i,(e=>(this.add(e.node.terminals.data,e.node.terminals.length),null!==e.node.residents&&this.add(e.node.residents.data,e.node.residents.length),!0))),h.release(i)}_placingRootViolatesMaxDepth(e){let t=0;return this._forEachNode(this._root,(e=>(t=Math.max(t,e.depth),!0))),t+Math.log(e.halfSize/this._root.halfSize)*Math.LOG2E>this._maximumDepth}_rootBoundsForRootAsSubNode(e,t){const n=e.radius,i=e.center;let r=-1/0;const a=this._root.center,s=this._root.halfSize;for(let e=0;e<3;e++){const t=a[e]-s-(i[e]-n),o=i[e]+n-(a[e]+s),l=Math.max(0,Math.ceil(t/(2*s))),c=Math.max(0,Math.ceil(o/(2*s)))+1,d=Math.pow(2,Math.ceil(Math.log(l+c)*Math.LOG2E));r=Math.max(r,d),I[e].min=l,I[e].max=c}for(let e=0;e<3;e++){let t=I[e].min,n=I[e].max;const i=(r-(t+n))/2;t+=Math.ceil(i),n+=Math.floor(i);const o=a[e]-s-t*s*2;A[e]=o+(n+t)*s}return t.initFrom(null,A,r*s,0)}_growRootAsSubNode(e){const t=this._root.node;(0,l.g)(D.center,this._root.center),D.radius=this._root.halfSize,this._root.init(e),e.advanceTo(D,null,!0),e.node.children=t.children,e.node.residents=t.residents,e.node.terminals=t.terminals}_shrink(){for(;;){const e=this._findShrinkIndex();if(-1===e)break;this._root.advance(e),this._root.depth=0}}_findShrinkIndex(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;let e=null;const t=this._root.node.children;let n=0,i=0;for(;i<t.length&&null==e;)n=i++,e=t[n];for(;i<t.length;)if(t[i++])return-1;return n}_isDegenerate(e){const t=this._objectToBoundingSphere.getRadius(e);return!this._isValidRadius(t)}_isValidRadius(e){return!isNaN(e)&&e!==-1/0&&e!==1/0&&e>0}_fitsInsideTree(e){const t=this._root.center,n=this._root.halfSize,i=e.center;return e.radius<=n&&i[0]>=t[0]-n&&i[0]<=t[0]+n&&i[1]>=t[1]-n&&i[1]<=t[1]+n&&i[2]>=t[2]-n&&i[2]<=t[2]+n}_boundingSphereFromObject(e,t){return(0,l.g)(t.center,this._objectToBoundingSphere.getCenter(e)),t.radius=this._objectToBoundingSphere.getRadius(e),t}_boundingSphereFromObjects(e,t,n,i){if(1===t){const t=n(e[0],D);(0,l.g)(i.center,t.center),i.radius=t.radius}else{O[0]=1/0,O[1]=1/0,O[2]=1/0,C[0]=-1/0,C[1]=-1/0,C[2]=-1/0;for(let i=0;i<t;i++){const t=n(e[i],D);this._isValidRadius(t.radius)&&(u(O,t.center,t.radius),p(C,t.center,t.radius))}(0,l.e)(i.center,O,C,.5),i.radius=Math.max(C[0]-O[0],C[1]-O[1],C[2]-O[2])/2}return i}}({getRadius:e=>e.getBSRadius(),getCenter:e=>e.getCenter()}),this._octree.add([...this._objects])}}V._idGen=new a.A;const L=V},94589:(e,t,n)=>{"use strict";n.d(t,{E:()=>A});var i=n(26701),r=n(30090),a=n(10762),s=n(66704),o=n(6048),l=n(56140),c=n(23240),d=n(97853),h=n(44801),u=n(11379),p=n(51007),f=n(36904),m=n(89553),g=n(61514),v=n(72023),y=n(38391),_=n(93352);class b extends d.A{initializeProgram(e){const t=b.shader.get(),n=this.configuration,i=t.build({output:n.output,OITEnabled:0===n.transparencyPassType,attributeColor:n.vertexColors,slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:n.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1});return new p.Z(e.rctx,i.generateSource("vertex"),i.generateSource("fragment"),u.i)}bindPass(e,t,n){m.G.bindProjectionMatrix(this.program,n.camera.projectionMatrix),this.program.setUniform4fv("eColor",t.color),4===this.configuration.output&&v.b.bindOutputHighlight(e,this.program,n),1===this.configuration.output&&this.program.setUniform2fv("nearFar",n.camera.nearFar)}bindDraw(e){m.G.bindView(this.program,e),g.p.bindUniformsWithOrigin(this.program,this.configuration,e)}setPipelineState(e,t){const n=this.configuration,i=3===e,r=2===e;return(0,f.sm)({blending:0!==n.output&&7!==n.output||!n.transparent?null:i?s.wu:(0,s.$L)(e),culling:(a=n.cullFace,0!==a&&{face:1===a?1028:1029,mode:2305}),depthTest:{func:(0,s.$x)(e)},depthWrite:i||r?n.writeDepth&&f.LZ:null,colorWrite:f.BK,stencilWrite:n.sceneHasOcludees?y.s3:null,stencilTest:n.sceneHasOcludees?t?y.eD:y.RY:null,polygonOffset:i||r?n.polygonOffset&&x:(0,s.je)(n.enableOffset)});var a}initializePipeline(){return this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e){return e?this._occludeePipelineState:this.pipeline}}b.shader=new c.J(_.C,(()=>n.e(3870).then(n.bind(n,13870))));const x={factor:1,units:1};class S extends h.m{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.sliceHighlightDisabled=!1,this.vertexColors=!1,this.transparent=!1,this.polygonOffset=!1,this.enableOffset=!0,this.writeDepth=!0,this.sceneHasOcludees=!1,this.transparencyPassType=3}}(0,l._)([(0,h.o)({count:8})],S.prototype,"output",void 0),(0,l._)([(0,h.o)({count:3})],S.prototype,"cullFace",void 0),(0,l._)([(0,h.o)()],S.prototype,"slicePlaneEnabled",void 0),(0,l._)([(0,h.o)()],S.prototype,"sliceHighlightDisabled",void 0),(0,l._)([(0,h.o)()],S.prototype,"vertexColors",void 0),(0,l._)([(0,h.o)()],S.prototype,"transparent",void 0),(0,l._)([(0,h.o)()],S.prototype,"polygonOffset",void 0),(0,l._)([(0,h.o)()],S.prototype,"enableOffset",void 0),(0,l._)([(0,h.o)()],S.prototype,"writeDepth",void 0),(0,l._)([(0,h.o)()],S.prototype,"sceneHasOcludees",void 0),(0,l._)([(0,h.o)({count:4})],S.prototype,"transparencyPassType",void 0);class A extends a.F5{constructor(e,t){super(t,e,O),this.supportsEdges=!0,this.techniqueConfig=new S}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.vertexColors=this.params.vertexColors,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.polygonOffset=this.params.polygonOffset,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<s.ve,this.techniqueConfig}getPassParameters(){return this.params}intersect(e,t,n,i,a,s,o){(0,r.Bw)(e,t,i,a,s,void 0,o)}getGLMaterial(e){return 0===e.output||7===e.output||4===e.output||1===e.output&&this.params.writeLinearDepth?new P(e):void 0}createBufferWriter(){return new o.G_(o.IM)}}class P extends i.Z{constructor(e){super(e),this.updateParameters()}updateParameters(e){this.technique=this.techniqueRep.acquireAndReleaseExisting(b,this.material.getTechniqueConfig(this.output,e),this.technique)}beginSlot(e){return 4===this.output?3===e:e===(this.technique.configuration.transparent?this.technique.configuration.writeDepth?5:8:3)}_updateOccludeeState(e){e.hasOccludees!==this.material.params.sceneHasOcludees&&this.material.setParameterValues({sceneHasOcludees:e.hasOccludees})}ensureParameters(e){0!==this.output&&7!==this.output||this._updateOccludeeState(e),this.updateParameters(e)}bind(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.getPassParameters(),t)}getPipelineState(e,t){return this.technique.getPipelineState(t)}}const O={color:[1,1,1,1],transparent:!1,writeDepth:!0,writeLinearDepth:!1,vertexColors:!1,polygonOffset:!1,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1,...a.zh}},57511:(e,t,n)=>{"use strict";n.d(t,{U:()=>A});var i,r=n(59472),a=n(36544),s=n(33655),o=n(96071),l=n(77625),c=n(17387),d=n(14286),h=n(80905),u=n(88),p=n(27898),f=n(56469),m=n(49366),g=n(26701),v=n(10762),y=n(30663),_=n(69236);!function(e){e.Default={vvSizeEnabled:!1,vvSizeMinSize:(0,_.f)(1,1,1),vvSizeMaxSize:(0,_.f)(100,100,100),vvSizeOffset:(0,_.f)(0,0,0),vvSizeFactor:(0,_.f)(1,1,1),vvSizeValue:(0,_.f)(1,1,1),vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],vvOpacityEnabled:!1,vvOpacityValues:[0,0,0,0,0,0,0,0],vvOpacityOpacities:[1,1,1,1,1,1,1,1],vvSymbolAnchor:[0,0,0],vvSymbolRotationMatrix:(0,y.a)()}}(i||(i={}));const b=i;var x=n(43965);const S=a.Z.getLogger("esri.views.3d.webgl-engine.materials.RibbonLineMaterial");class A extends v.F5{constructor(e,t){super(t,e,O),this._vertexAttributeLocations=x.$p,this.techniqueConfig=new x.GP,this.layout=this.createLayout()}isClosed(e,t){return D(this.params,e,t)}dispose(){}getPassParameters(){return this.params}getTechniqueConfig(e,t){this.techniqueConfig.output=e;const n=(0,r.pC)(this.params.stipplePattern);return this.techniqueConfig.stippleEnabled=n,this.techniqueConfig.stippleIntegerRepeatsEnabled=n&&this.params.stippleIntegerRepeats,this.techniqueConfig.stippleOffColorEnabled=n&&(0,r.pC)(this.params.stippleOffColor),this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.roundJoins="round"===this.params.join,this.techniqueConfig.roundCaps="round"===this.params.cap,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.polygonOffset=this.params.polygonOffset,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.vvColor=this.params.vvColorEnabled,this.techniqueConfig.vvOpacity=this.params.vvOpacityEnabled,this.techniqueConfig.vvSize=this.params.vvSizeEnabled,this.techniqueConfig.innerColorEnabled=this.params.innerWidth>0&&(0,r.pC)(this.params.innerColor),this.techniqueConfig.falloffEnabled=this.params.falloff>0,this.techniqueConfig.occluder=8===this.params.renderOccluded,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig}intersect(e,t,n,i,r,a,s,o,l){l?this.intersectDrapedLineGeometry(e,i,a,s):this.intersectLineGeometry(e,t,n,i,this.params.width,s)}intersectDrapedLineGeometry(e,t,n,i){if(!t.options.selectionMode)return;const r=e.getAttribute(x._A.POSITION).data,a=e.getAttribute(x._A.SIZE);let o=this.params.width;if(this.params.vvSizeEnabled){const t=e.getAttribute(x._A.SIZEFEATUREATTRIBUTE).data[0];o*=(0,s.uZ)(this.params.vvSizeOffset[0]+t*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0])}else a&&(o*=a.data[0]);const l=n[0],c=n[1],d=(o/2+4)*e.screenToWorldRatio;let h=Number.MAX_VALUE;for(let e=0;e<r.length-5;e+=3){const t=r[e],n=r[e+1],i=l-t,a=c-n,o=r[e+3]-t,d=r[e+4]-n,u=(0,s.uZ)((o*i+d*a)/(o*o+d*d),0,1),p=o*u-i,f=d*u-a,m=p*p+f*f;m<h&&(h=m)}h<d*d&&i()}intersectLineGeometry(e,t,n,i,r,a){if(!i.options.selectionMode||(0,m.PD)(t))return;if(!(0,f.kG)(n))return void S.error("intersection assumes a translation-only matrix");const o=e.data,l=o.getVertexAttr(),h=l[x._A.POSITION].data;let p=r;if(this.params.vvSizeEnabled){const e=l[x._A.SIZEFEATUREATTRIBUTE].data[0];p*=(0,s.uZ)(this.params.vvSizeOffset[0]+e*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0])}else l[x._A.SIZE]&&(p*=l[x._A.SIZE].data[0]);const g=i.camera,v=L;(0,d.c)(v,i.point);const y=p*g.pixelRatio/2+4*g.pixelRatio;(0,c.s)(B[0],v[0]-y,v[1]+y,0),(0,c.s)(B[1],v[0]+y,v[1]+y,0),(0,c.s)(B[2],v[0]+y,v[1]-y,0),(0,c.s)(B[3],v[0]-y,v[1]-y,0);for(let e=0;e<4;e++)if(!g.unprojectFromRenderScreen(B[e],G[e]))return;u.yC.fromPoints(g.eye,G[0],G[1],k),u.yC.fromPoints(g.eye,G[1],G[2],J),u.yC.fromPoints(g.eye,G[2],G[3],$),u.yC.fromPoints(g.eye,G[3],G[0],Y);let _=Number.MAX_VALUE;const b=E(this.params,l,o.indices)?h.length-2:h.length-5;for(let e=0;e<b;e+=3){I[0]=h[e]+n[12],I[1]=h[e+1]+n[13],I[2]=h[e+2]+n[14];const t=(e+3)%h.length;if(T[0]=h[t]+n[12],T[1]=h[t+1]+n[13],T[2]=h[t+2]+n[14],u.yC.signedDistance(k,I)<0&&u.yC.signedDistance(k,T)<0||u.yC.signedDistance(J,I)<0&&u.yC.signedDistance(J,T)<0||u.yC.signedDistance($,I)<0&&u.yC.signedDistance($,T)<0||u.yC.signedDistance(Y,I)<0&&u.yC.signedDistance(Y,T)<0)continue;if(g.projectToRenderScreen(I,U),g.projectToRenderScreen(T,N),U[2]<0&&N[2]>0){(0,c.f)(z,I,T);const e=g.frustum,t=-u.yC.signedDistance(e.planes[4],I)/(0,c.d)(z,u.yC.normal(e.planes[4]));(0,c.a)(z,z,t),(0,c.b)(I,I,z),g.projectToRenderScreen(I,U)}else if(U[2]>0&&N[2]<0){(0,c.f)(z,T,I);const e=g.frustum,t=-u.yC.signedDistance(e.planes[4],T)/(0,c.d)(z,u.yC.normal(e.planes[4]));(0,c.a)(z,z,t),(0,c.b)(T,T,z),g.projectToRenderScreen(T,N)}else if(U[2]<0&&N[2]<0)continue;U[2]=0,N[2]=0;const i=u.KD.distance2(u.KD.fromPoints(U,N,q),v);i<_&&(_=i,(0,c.g)(F,I),(0,c.g)(j,T))}const A=i.rayBeginPoint,P=i.rayEndPoint;if(_<y*y){let e=Number.MAX_VALUE;if(u.KD.closestLineSegmentPoint(u.KD.fromPoints(F,j,q),u.KD.fromPoints(A,P,H),V)){(0,c.f)(V,V,A);const t=(0,c.l)(V);(0,c.a)(V,V,1/t),e=t/(0,c.k)(A,P)}a(e,V)}}computeAttachmentOrigin(e,t){const n=e.data,i="getVertexAttr"in n?n.getVertexAttr():"vertexAttr"in n?n.vertexAttr:null;if(!i)return null;const r=x._A.POSITION,a="getVertexAttr"in n?n.indices:null,s=i[r];return(0,p.qZ)(s,a?a[r]:null,a&&E(this.params,i,a),t)}createLayout(){const e=(0,h.U$)().vec3f(x._A.POSITION).f32(x._A.SUBDIVISIONFACTOR).vec2f(x._A.UV0).vec3f(x._A.AUXPOS1).vec3f(x._A.AUXPOS2);return this.params.vvSizeEnabled?e.f32(x._A.SIZEFEATUREATTRIBUTE):e.f32(x._A.SIZE),this.params.vvColorEnabled?e.f32(x._A.COLORFEATUREATTRIBUTE):e.vec4f(x._A.COLOR),this.params.vvOpacityEnabled&&e.f32(x._A.OPACITYFEATUREATTRIBUTE),e}createBufferWriter(){return new C(this.layout,this.params)}getGLMaterial(e){return 0===e.output||7===e.output||4===e.output||1===e.output?new P(e):void 0}validateParameterValues(e){"miter"!==e.join&&(e.miterLimit=0),this.requiresTransparent(e)&&(e.transparent=!0)}requiresTransparent(e){return!!((e.color&&e.color[3])<1||e.innerWidth>0&&this.colorRequiresTransparent(e.innerColor)||e.stipplePattern&&this.colorRequiresTransparent(e.stippleOffColor)||e.falloff>0)}colorRequiresTransparent(e){return(0,r.pC)(e)&&e[3]<1&&e[3]>0}}class P extends g.Z{constructor(e){super(e),this.updateParameters()}updateParameters(e){this.technique=this.techniqueRep.acquireAndReleaseExisting(x.Eh,this.material.getTechniqueConfig(this.output,e),this.technique)}beginSlot(e){return this.technique.configuration.occluder?3===e||10===e||11===e:0===this.output||7===this.output?(this.targetSlot=this.technique.configuration.writeDepth?5:8,e===this.targetSlot):3===e}_updateOccludeeState(e){e.hasOccludees!==this.material.params.sceneHasOcludees&&this.material.setParameterValues({sceneHasOcludees:e.hasOccludees})}ensureParameters(e){0!==this.output&&7!==this.output||this._updateOccludeeState(e),this.updateParameters(e)}bind(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.getPassParameters(),t)}getPipelineState(e,t){return this.technique.getPipelineState(e,t)}}const O={width:0,color:[1,1,1,1],join:"miter",cap:"butt",miterLimit:5,writeDepth:!0,polygonOffset:!1,stipplePattern:null,stippleIntegerRepeats:!1,stippleOffColor:null,slicePlaneEnabled:!1,vvFastUpdate:!1,transparent:!1,isClosed:!1,falloff:0,innerWidth:0,innerColor:null,sceneHasOcludees:!1,...v.zh,...b.Default};class C{constructor(e,t){switch(this.params=t,this.numJoinSubdivisions=0,this.vertexBufferLayout=e,this.params.join){case"miter":case"bevel":this.numJoinSubdivisions=t.stipplePattern?1:0;break;case"round":this.numJoinSubdivisions=R}}isClosed(e){return E(this.params,e.vertexAttr,e.indices)}numCapSubdivisions(e){if(this.isClosed(e))return 0;switch(this.params.cap){case"butt":return 0;case"square":return 1;case"round":return M}}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){const t=2*this.numCapSubdivisions(e)+2,n=e.indices[x._A.POSITION].length/2+1,i=this.isClosed(e);let r=i?2:2*t;const a=i?0:1,s=i?n:n-1;if(e.vertexAttr[x._A.SUBDIVISIONS]){const t=e.vertexAttr[x._A.SUBDIVISIONS].data;for(let e=a;e<s;++e)r+=4+2*t[e]}else r+=(s-a)*(2*this.numJoinSubdivisions+4);return r+=2,r}write(e,t,n,i){const r=Z,a=X,s=W,o=t.vertexAttr[x._A.POSITION].data,l=t.indices&&t.indices[x._A.POSITION],d=this.numCapSubdivisions(t);l&&l.length!==2*(o.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");let h=null;t.vertexAttr[x._A.SUBDIVISIONS]&&(h=t.vertexAttr[x._A.SUBDIVISIONS].data);let u=1,p=0;this.params.vvSizeEnabled?p=t.vertexAttr[x._A.SIZEFEATUREATTRIBUTE].data[0]:t.vertexAttr[x._A.SIZE]&&(u=t.vertexAttr[x._A.SIZE].data[0]);let f=[1,1,1,1],m=0;this.params.vvColorEnabled?m=t.vertexAttr[x._A.COLORFEATUREATTRIBUTE].data[0]:t.vertexAttr[x._A.COLOR]&&(f=t.vertexAttr[x._A.COLOR].data);let g=0;this.params.vvOpacityEnabled&&(g=t.vertexAttr[x._A.OPACITYFEATUREATTRIBUTE].data[0]);const v=o.length/3,y=e.transformation,_=new Float32Array(n.buffer),b=this.vertexBufferLayout.stride/4;let S=i*b;const A=S,P=(e,t,n,i,r,a,s)=>{if(_[S++]=t[0],_[S++]=t[1],_[S++]=t[2],_[S++]=i,_[S++]=r,_[S++]=a,_[S++]=e[0],_[S++]=e[1],_[S++]=e[2],_[S++]=n[0],_[S++]=n[1],_[S++]=n[2],this.params.vvSizeEnabled?_[S++]=p:_[S++]=u,this.params.vvColorEnabled)_[S++]=m;else{const e=Math.min(4*s,f.length-4);_[S++]=f[e+0],_[S++]=f[e+1],_[S++]=f[e+2],_[S++]=f[e+3]}this.params.vvOpacityEnabled&&(_[S++]=g)};S+=b,(0,c.s)(a,o[0],o[1],o[2]),y&&(0,c.i)(a,a,y);const O=this.isClosed(t);if(O){const e=o.length-3;(0,c.s)(r,o[e],o[e+1],o[e+2]),y&&(0,c.i)(r,r,y)}else{(0,c.g)(r,a),(0,c.s)(s,o[3],o[4],o[5]),y&&(0,c.i)(s,s,y);for(let e=0;e<d;++e){const t=1-e/d;P(r,a,s,t,1,-4,0),P(r,a,s,t,1,4,0)}P(r,a,s,0,0,-4,0),P(r,a,s,0,0,4,0),(0,c.g)(r,a),(0,c.g)(a,s)}const C=O?v:v-1;for(let e=O?0:1;e<C;e++){const t=(e+1)%v*3;(0,c.s)(s,o[t+0],o[t+1],o[t+2]),y&&(0,c.i)(s,s,y),P(r,a,s,0,1,-1,e),P(r,a,s,0,1,1,e);const n=h?h[e]:this.numJoinSubdivisions;for(let t=0;t<n;++t){const i=(t+1)/(n+1);P(r,a,s,i,1,-2,e),P(r,a,s,i,1,2,e)}P(r,a,s,1,0,-2,e),P(r,a,s,1,0,2,e),(0,c.g)(r,a),(0,c.g)(a,s)}if(O)S=w(_,A+b,_,S,2*b);else{P(r,a,s,0,1,-5,C),P(r,a,s,0,1,5,C);for(let e=0;e<d;++e){const t=(e+1)/d;P(r,a,s,t,1,-5,C),P(r,a,s,t,1,5,C)}}w(_,A+b,_,A,b),S=w(_,S-b,_,S,b)}}function w(e,t,n,i,r){for(let a=0;a<r;a++)n[i++]=e[t++];return i}function E(e,t,n){return D(e,t[x._A.POSITION].data,n?n[x._A.POSITION]:null)}function D(e,t,n){return!!e.isClosed&&(n?n.length>2:t.length>6)}const M=3,R=1,I=(0,l.c)(),T=(0,l.c)(),z=(0,l.c)(),V=(0,l.c)(),L=(0,l.c)(),U=(0,o.J$)(),N=(0,o.J$)(),F=(0,l.c)(),j=(0,l.c)(),q=u.KD.create(),H=u.KD.create(),Z=(0,l.c)(),X=(0,l.c)(),W=(0,l.c)(),B=[(0,o.J$)(),(0,o.J$)(),(0,o.J$)(),(0,o.J$)()],G=[(0,l.c)(),(0,l.c)(),(0,l.c)(),(0,l.c)()],k=u.yC.create(),J=u.yC.create(),$=u.yC.create(),Y=u.yC.create()},6048:(e,t,n)=>{"use strict";n.d(t,{G_:()=>l,IM:()=>o,W1:()=>s});var i=n(80905),r=n(56469),a=n(13405);(0,i.U$)().vec3f(r.Xt.POSITION);const s=(0,i.U$)().vec3f(r.Xt.POSITION).vec2f(r.Xt.UV0),o=(0,i.U$)().vec3f(r.Xt.POSITION).vec4u8(r.Xt.COLOR);(0,i.U$)().vec3f(r.Xt.POSITION).vec4u8(r.Xt.COLOR).vec4f(r.Xt.UVMAPSPACE).vec3f(r.Xt.MEANVERTEXPOSITION),(0,i.U$)().vec3f(r.Xt.POSITION).vec4u8(r.Xt.COLOR).vec4f(r.Xt.UVMAPSPACE).vec3f(r.Xt.BOUND1).vec3f(r.Xt.BOUND2).vec3f(r.Xt.BOUND3);class l{constructor(e){this.vertexBufferLayout=e}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices[r.Xt.POSITION].length}write(e,t,n,i){(0,a.NK)(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,n,i)}}},43965:(e,t,n)=>{"use strict";n.d(t,{Eh:()=>_,GP:()=>x,_A:()=>v,$p:()=>y});var i=n(56140),r=n(59472),a=n(23240),s=n(97853),o=n(44801),l=n(51007),c=n(36904),d=n(89553),h=n(61514),u=n(72023),p=n(8681),f=n(66704),m=n(38391),g=n(81632);const v={POSITION:"position",SUBDIVISIONFACTOR:"subdivisionFactor",UV0:"uv0",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",SUBDIVISIONS:"subdivisions",COLOR:"color",COLORFEATUREATTRIBUTE:"colorFeatureAttribute",SIZE:"size",SIZEFEATUREATTRIBUTE:"sizeFeatureAttribute",OPACITYFEATUREATTRIBUTE:"opacityFeatureAttribute"},y={position:0,subdivisionFactor:1,uv0:2,auxpos1:3,auxpos2:4,size:6,sizeFeatureAttribute:6,color:5,colorFeatureAttribute:5,opacityFeatureAttribute:7};class _ extends s.A{constructor(e,t){super(e,t),this.stipplePattern=null,this.stippleTextureBind=null,this.stippleTextureRepository=e.stippleTextureRepository}initializeProgram(e){const t=_.shader.get(),n=this.configuration,i=t.build({OITEnabled:0===n.transparencyPassType,output:n.output,slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:n.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,stippleEnabled:n.stippleEnabled,stippleOffColorEnabled:n.stippleOffColorEnabled,stippleUVMaxEnabled:n.stippleIntegerRepeatsEnabled,stippleIntegerRepeatsEnabled:n.stippleIntegerRepeatsEnabled,roundCaps:n.roundCaps,roundJoins:n.roundJoins,vvColor:n.vvColor,vvSize:n.vvSize,vvInstancingEnabled:!0,vvOpacity:n.vvOpacity,falloffEnabled:n.falloffEnabled,innerColorEnabled:n.innerColorEnabled});return new l.Z(e.rctx,i.generateSource("vertex"),i.generateSource("fragment"),y)}dispose(){super.dispose(),this.stippleTextureRepository.release(this.stipplePattern),this.stipplePattern=null,this.stippleTextureBind=null}bindPass(e,t,n){if(d.G.bindProjectionMatrix(this.program,n.camera.projectionMatrix),4===this.configuration.output&&u.b.bindOutputHighlight(e,this.program,n),this.program.setUniform1f("intrinsicWidth",t.width),this.program.setUniform4fv("intrinsicColor",t.color),this.program.setUniform1f("miterLimit","miter"!==t.join?0:t.miterLimit),this.program.setUniform2fv("nearFar",n.camera.nearFar),this.program.setUniform1f("pixelRatio",n.camera.pixelRatio),this.program.setUniform2f("screenSize",n.camera.fullViewport[2],n.camera.fullViewport[3]),p.k.bindUniformsWithOpacity(this.program,t),this.stipplePattern!==t.stipplePattern){const e=t.stipplePattern;this.stippleTextureBind=this.stippleTextureRepository.swap(this.stipplePattern,e),this.stipplePattern=e}if(this.configuration.stippleEnabled){const i=(0,r.pC)(this.stippleTextureBind)?this.stippleTextureBind(e,0)*n.camera.pixelRatio:1;if(this.program.setUniform1i("stipplePatternTexture",0),this.program.setUniform1f("stipplePatternPixelSizeInv",1/i),this.configuration.stippleOffColorEnabled){const e=(0,r.Wg)(t.stippleOffColor);this.program.setUniform4f("stippleOffColor",e[0],e[1],e[2],e.length>3?e[3]:1)}}this.configuration.falloffEnabled&&this.program.setUniform1f("falloff",t.falloff),this.configuration.innerColorEnabled&&(this.program.setUniform4fv("innerColor",(0,r.Pt)(t.innerColor,t.color)),this.program.setUniform1f("innerWidth",t.innerWidth*n.camera.pixelRatio))}bindDraw(e){d.G.bindView(this.program,e),h.p.bindUniformsWithOrigin(this.program,this.configuration,e)}setPipelineState(e,t){const n=this.configuration,i=3===e,r=2===e;return(0,c.sm)({blending:0===n.output||7===n.output?i?f.wu:(0,f.$L)(e):null,depthTest:{func:(0,f.$x)(e)},depthWrite:i?!n.transparent&&n.writeDepth&&c.LZ:(0,f.Vc)(e),colorWrite:c.BK,stencilWrite:n.sceneHasOcludees?m.s3:null,stencilTest:n.sceneHasOcludees?t?m.eD:m.RY:null,polygonOffset:i||r?n.polygonOffset&&b:f.E0})}initializePipeline(){const e=this.configuration,t=e.polygonOffset&&b;return e.occluder&&(this._occluderPipelineTransparent=(0,c.sm)({blending:f.wu,polygonOffset:t,depthTest:m.zV,depthWrite:null,colorWrite:c.BK,stencilWrite:null,stencilTest:m.YD}),this._occluderPipelineOpaque=(0,c.sm)({blending:f.wu,polygonOffset:t,depthTest:m.zV,depthWrite:null,colorWrite:c.BK,stencilWrite:m.P7,stencilTest:m.ii}),this._occluderPipelineMaskWrite=(0,c.sm)({blending:null,polygonOffset:t,depthTest:m.JN,depthWrite:null,colorWrite:null,stencilWrite:m.s3,stencilTest:m.eD})),this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}get primitiveType(){return 5}getPipelineState(e,t){return t?this._occludeePipelineState:this.configuration.occluder?11===e?this._occluderPipelineTransparent:10===e?this._occluderPipelineOpaque:this._occluderPipelineMaskWrite:this.pipeline}}_.shader=new a.J(g.R,(()=>n.e(4271).then(n.bind(n,14271))));const b={factor:0,units:-4};class x extends o.m{constructor(){super(...arguments),this.output=0,this.occluder=!1,this.slicePlaneEnabled=!1,this.sliceHighlightDisabled=!1,this.vertexColors=!1,this.transparent=!1,this.polygonOffset=!1,this.writeDepth=!1,this.stippleEnabled=!1,this.stippleOffColorEnabled=!1,this.stippleIntegerRepeatsEnabled=!1,this.roundCaps=!1,this.roundJoins=!1,this.vvSize=!1,this.vvColor=!1,this.vvOpacity=!1,this.falloffEnabled=!1,this.innerColorEnabled=!1,this.sceneHasOcludees=!1,this.transparencyPassType=3}}(0,i._)([(0,o.o)({count:8})],x.prototype,"output",void 0),(0,i._)([(0,o.o)()],x.prototype,"occluder",void 0),(0,i._)([(0,o.o)()],x.prototype,"slicePlaneEnabled",void 0),(0,i._)([(0,o.o)()],x.prototype,"sliceHighlightDisabled",void 0),(0,i._)([(0,o.o)()],x.prototype,"vertexColors",void 0),(0,i._)([(0,o.o)()],x.prototype,"transparent",void 0),(0,i._)([(0,o.o)()],x.prototype,"polygonOffset",void 0),(0,i._)([(0,o.o)()],x.prototype,"writeDepth",void 0),(0,i._)([(0,o.o)()],x.prototype,"stippleEnabled",void 0),(0,i._)([(0,o.o)()],x.prototype,"stippleOffColorEnabled",void 0),(0,i._)([(0,o.o)()],x.prototype,"stippleIntegerRepeatsEnabled",void 0),(0,i._)([(0,o.o)()],x.prototype,"roundCaps",void 0),(0,i._)([(0,o.o)()],x.prototype,"roundJoins",void 0),(0,i._)([(0,o.o)()],x.prototype,"vvSize",void 0),(0,i._)([(0,o.o)()],x.prototype,"vvColor",void 0),(0,i._)([(0,o.o)()],x.prototype,"vvOpacity",void 0),(0,i._)([(0,o.o)()],x.prototype,"falloffEnabled",void 0),(0,i._)([(0,o.o)()],x.prototype,"innerColorEnabled",void 0),(0,i._)([(0,o.o)()],x.prototype,"sceneHasOcludees",void 0),(0,i._)([(0,o.o)({count:4})],x.prototype,"transparencyPassType",void 0)},70778:(e,t,n)=>{"use strict";n.d(t,{e7:()=>o,cM:()=>d,Ru:()=>c,pB:()=>s,bA:()=>l});var i=n(92232),r=n(6513),a=n(50897);function s(e,t,n,r){if(null==r||e.hasZ||(r=void 0),"point"===e.type)return e.x+=t,e.y+=n,e.hasZ&&null!=r&&(e.z+=r),e;if("multipoint"===e.type){const i=e.points;for(let e=0;e<i.length;e++)i[e]=h(i[e],t,n,r);return e}if("extent"===e.type)return e.xmin+=t,e.xmax+=t,e.ymin+=n,e.ymax+=n,null!=r&&(e.zmin+=r,e.zmax+=r),e;const a=(0,i.nA)(e),s="polyline"===e.type?e.paths:e.rings;for(let e=0;e<a.length;e++){const i=a[e];for(let e=0;e<i.length;e++)i[e]=h(i[e],t,n,r)}return"paths"in e?e.paths=s:e.rings=s,e}function o(e,t,n,r,a){const o=e.clone(),l=r.resolution;if("point"===o.type){if(a)s(o,t*l,-n*l);else{const e=r.state.transform,i=r.state.inverseTransform,a=e[0]*o.x+e[2]*o.y+e[4],s=e[1]*o.x+e[3]*o.y+e[5];o.x=i[0]*(a+t)+i[2]*(s+n)+i[4],o.y=i[1]*(a+t)+i[3]*(s+n)+i[5]}return o}if("multipoint"===o.type){if(a)s(o,t*l,-n*l);else{const e=o.points,i=r.state.transform,a=r.state.inverseTransform;for(let r=0;r<e.length;r++){const s=e[r],o=i[0]*s[0]+i[2]*s[1]+i[4],l=i[1]*s[0]+i[3]*s[1]+i[5],c=a[0]*(o+t)+a[2]*(l+n)+a[4],d=a[1]*(o+t)+a[3]*(l+n)+a[5];e[r]=u(s,c,d,void 0)}}return o}if("extent"===o.type){if(a)s(o,t*l,-n*l);else{const e=r.state.transform,i=r.state.inverseTransform,a=e[0]*o.xmin+e[2]*o.ymin+e[4],s=e[1]*o.xmin+e[3]*o.ymin+e[5],l=e[0]*o.xmax+e[2]*o.ymax+e[4],c=e[1]*o.xmax+e[3]*o.ymax+e[5];o.xmin=i[0]*(a+t)+i[2]*(s+n)+i[4],o.ymin=i[1]*(a+t)+i[3]*(s+n)+i[5],o.xmax=i[0]*(l+t)+i[2]*(c+n)+i[4],o.ymax=i[1]*(l+t)+i[3]*(c+n)+i[5]}return o}if(a)s(o,t*l,-n*l);else{const e=(0,i.nA)(o),a="polyline"===o.type?o.paths:o.rings,s=r.state.transform,l=r.state.inverseTransform;for(let i=0;i<e.length;i++){const r=e[i];for(let e=0;e<r.length;e++){const i=r[e],a=s[0]*i[0]+s[2]*i[1]+s[4],o=s[1]*i[0]+s[3]*i[1]+s[5],c=l[0]*(a+t)+l[2]*(o+n)+l[4],d=l[1]*(a+t)+l[3]*(o+n)+l[5];r[e]=u(i,c,d,void 0)}}"paths"in o?o.paths=a:o.rings=a}return o}function l(e,t,n,s){if("point"===e.type){const{x:i,y:r}=e,a=s?s[0]:i,o=s?s[1]:r,l=e.clone(),c=(i-a)*t+a,d=(r-o)*n+o;return l.x=c,l.y=d,l}if("multipoint"===e.type){const o=(0,i.nA)(e),l=(0,a.Ue)(),[c,d,h,p]=(0,r.C6)(l,[o]),f=s?s[0]:(c+h)/2,m=s?s[1]:(p+d)/2,g=e.clone(),v=g.points;for(let e=0;e<v.length;e++){const i=v[e],[r,a]=i,s=(r-f)*t+f,o=(a-m)*n+m;v[e]=u(i,s,o,void 0)}return g}if("extent"===e.type){const{xmin:i,xmax:r,ymin:a,ymax:o}=e,l=s?s[0]:(i+r)/2,c=s?s[1]:(o+a)/2,d=e.clone();if(d.xmin=(i-l)*t+l,d.ymax=(o-c)*n+c,d.xmax=(r-l)*t+l,d.ymin=(a-c)*n+c,d.xmin>d.xmax){const e=d.xmin,t=d.xmax;d.xmin=t,d.xmax=e}if(d.ymin>d.ymax){const e=d.ymin,t=d.ymax;d.ymin=t,d.ymax=e}return d}const o=(0,i.nA)(e),l=(0,a.Ue)(),[c,d,h,p]=(0,r.C6)(l,o),f=s?s[0]:(c+h)/2,m=s?s[1]:(p+d)/2,g=e.clone(),v="polyline"===g.type?g.paths:g.rings;for(let e=0;e<o.length;e++){const i=o[e];for(let r=0;r<i.length;r++){const a=i[r],[s,o]=a,l=(s-f)*t+f,c=(o-m)*n+m;v[e][r]=u(a,l,c,void 0)}}return"paths"in g?g.paths=v:g.rings=v,g}function c(e,t,n,i,r,a){const s=Math.sqrt((n-e)*(n-e)+(i-t)*(i-t));return Math.sqrt((r-e)*(r-e)+(a-t)*(a-t))/s}function d(e,t,n,i,r,a){const s=180*Math.atan2(t-i,e-n)/Math.PI;return 180*Math.atan2(t-a,e-r)/Math.PI-s}function h(e,t,n,i){return u(e,e[0]+t,e[1]+n,null!=e[2]&&null!=i?e[2]+i:void 0)}function u(e,t,n,i){const r=[t,n];return e.length>2&&r.push(null!=i?i:e[2]),e.length>3&&r.push(e[3]),r}},76916:(e,t,n)=>{"use strict";n.d(t,{m:()=>d});var i=n(56140),r=(n(95830),n(36544),n(68055),n(79881)),a=n(87566),s=(n(10923),n(57002),n(86035),n(39105)),o=n(82677),l=n(17519),c=n(73103);let d=class extends o.default{constructor(e){super(e),this.attached=!1,this.created=!1,this.completed=!1,this.manipulators=new c.D,this.deferCreation=!1,this._editableFlags=new Array,this._creationResolver=(0,s.createResolver)()}get active(){return null!=this.view&&this.view.activeTool===this}get isSupported(){return!0}set visible(e){this._set("visible",e),e||(0,l.Iv)(this,!1),this.attached&&(e?this._show():this._hide())}get editable(){return this.hasEditableFlag(0)}set editable(e){this.setEditableFlag(0,e)}attach(){!this.attached&&this.isSupported&&(this.manipulators.attach(),this.onAttach(),this.visible&&this.onShow(),this._set("attached",!0))}detach(){this.attached&&(this.onHide(),this.onDetach(),this.manipulators.detach(),this._set("attached",!1))}handleInputEvent(e){this.attached&&this.onInputEvent(e)}handleInputEventAfter(e){this.attached&&this.onInputEventAfter(e)}destroy(){this.manipulators.destroy(),this._set("view",null)}setEditableFlag(e,t){this._editableFlags[e]=t,this.manipulators.isToolEditable=this._editableFlags.every((e=>null==e||e)),this._updateManipulatorAttachment(),0===e&&this.notifyChange("editable"),this.onEditableChange()}hasEditableFlag(e){const t=this._editableFlags[e];return null==t||t}when(){return this._creationResolver.promise}rejectCreation(e){this._creationResolver.reject(e)}initialize(){this.deferCreation||this.complete()}onAttach(){}onDetach(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(e){}onInputEventAfter(e){}get internallyEditable(){return this.hasEditableFlag(0)&&this.hasEditableFlag(1)}create(){this.created||(this._set("created",!0),this._creationResolver(this))}complete(){this.create(),this._set("completed",!0)}_show(){this._updateManipulatorAttachment(),this.onShow()}_hide(){this._updateManipulatorAttachment(),this.onHide()}_updateManipulatorAttachment(){this.attached&&this.visible?this.manipulators.attach():this.manipulators.detach()}};(0,i._)([(0,r.Cb)({constructOnly:!0})],d.prototype,"view",void 0),(0,i._)([(0,r.Cb)({dependsOn:["view.activeTool"],readOnly:!0})],d.prototype,"active",null),(0,i._)([(0,r.Cb)({value:!0})],d.prototype,"visible",null),(0,i._)([(0,r.Cb)({value:!0})],d.prototype,"editable",null),(0,i._)([(0,r.Cb)({readOnly:!0})],d.prototype,"attached",void 0),(0,i._)([(0,r.Cb)({readOnly:!0})],d.prototype,"created",void 0),(0,i._)([(0,r.Cb)({readOnly:!0})],d.prototype,"completed",void 0),(0,i._)([(0,r.Cb)({readOnly:!0})],d.prototype,"manipulators",void 0),(0,i._)([(0,r.Cb)({constructOnly:!0})],d.prototype,"deferCreation",void 0),d=(0,i._)([(0,a.j)("esri.views.interactive.InteractiveToolBase")],d)},73103:(e,t,n)=>{"use strict";n.d(t,{D:()=>a});var i=n(59472),r=n(83477);class a{constructor(){this._isToolEditable=!0,this._manipulators=new r.Z,this._nextManipulatorId=0,this._resourceContexts={manipulator3D:{}},this._attached=!1}set isToolEditable(e){this._isToolEditable=e}get length(){return this._manipulators.length}add(e,t=0){return this.addMany([e],t)[0]}addMany(e,t=0){return e.map((e=>{const n=this._nextManipulatorId++,i={id:n,manipulator:e,visibilityPredicate:t,attached:!1};return this._manipulators.add(i),this._attached&&this._updateManipulatorAttachment(i),n}))}remove(e){if("number"==typeof e){const t=e;for(let e=0;e<this._manipulators.length;e++)if(this._manipulators.getItemAt(e).id===t){const t=this._manipulators.splice(e,1)[0];return this._detachManipulator(t),t.id}return null}const t=e;for(let e=0;e<this._manipulators.length;e++)if(this._manipulators.getItemAt(e).manipulator===t){const t=this._manipulators.splice(e,1)[0];return this._detachManipulator(t),t.id}return null}removeAll(){this._manipulators.forEach((e=>{this._detachManipulator(e)})),this._manipulators.removeAll()}attach(){this._manipulators.forEach((e=>{this._updateManipulatorAttachment(e)})),this._attached=!0}detach(){this._manipulators.forEach((e=>{this._detachManipulator(e)})),this._attached=!1}destroy(){this._manipulators.forEach((({manipulator:e})=>{e.destroy&&e.destroy()})),this._manipulators.destroy(),this._resourceContexts=null}on(e,t){return this._manipulators.on(e,(e=>{t(e)}))}forEach(e){for(const t of this._manipulators.items)e(t)}some(e){return this._manipulators.items.some(e)}toArray(){const e=[];return this.forEach((t=>e.push(t.manipulator))),e}intersect(e,t){let n=null,r=Number.MAX_VALUE;return this._manipulators.forEach((({id:a,manipulator:s,attached:o})=>{if(!o||!s.interactive)return;const l=s.intersectionDistance(e,t);(0,i.pC)(l)&&l<r&&(r=l,n=a)})),n}findById(e){if((0,i.Wi)(e))return null;for(const t of this._manipulators.items)if(e===t.id)return t.manipulator;return null}_updateManipulatorAttachment(e){this._isManipulatorItemVisible(e)?this._attachManipulator(e):this._detachManipulator(e)}_attachManipulator(e){e.attached||(e.manipulator.attach&&e.manipulator.attach(this._resourceContexts),e.attached=!0)}_detachManipulator(e){if(!e.attached)return;const t=e.manipulator;t.grabbing=!1,t.dragging=!1,t.hovering=!1,t.selected=!1,t.detach&&t.detach(this._resourceContexts),e.attached=!1}_isManipulatorItemVisible(e){return 2===e.visibilityPredicate||(this._isToolEditable?0===e.visibilityPredicate:1===e.visibilityPredicate)}}},53640:(e,t,n)=>{"use strict";n.d(t,{hM:()=>x,AN:()=>y,zh:()=>_,M2:()=>d,Xd:()=>c,kY:()=>b,a9:()=>h,oq:()=>p,bD:()=>m,QY:()=>g,di:()=>f,nh:()=>v,Cf:()=>u});var i=n(82550),r=n(59472),a=n(41241),s=n(33655),o=n(96071),l=n(70778);function c(e,t){return e.events.on("drag",function(e,t){let n=null,i=null;return a=>{if("cancel"===a.action)return void((0,r.pC)(i)&&(i.execute({action:"cancel"}),n=null,i=null));const s={action:a.action,screenStart:a.start,screenEnd:a.screenPoint};"start"===a.action&&(0,r.Wi)(n)&&(n=new x,i=new x,t(e,n,i,a.pointerType,s)),(0,r.pC)(n)&&n.execute(s),"end"===a.action&&(0,r.pC)(n)&&(n=null,i=null)}}(e,t))}function d(e,t){const n=[e.x,e.y,e.z],i=t,r=[Math.cos(i),Math.sin(i)],a=Math.sqrt(r[0]*r[0]+r[1]*r[1]);if(0===a)return null;r[0]/=a,r[1]/=a;const s=e=>{const t=(e.x-n[0])*r[0]+(e.y-n[1])*r[1];e.x=n[0]+t*r[0],e.y=n[1]+t*r[1]};return e=>(s(e.mapStart),s(e.mapEnd),e)}function h(e){return function(e,t){let n=null;const i=(0,r.pC)(e[t])?e[t].spatialReference:null;return s=>{var o,c;if("start"===s.action&&(0,r.pC)(e[t])&&(o=e[t],c=s.mapStart.spatialReference,n=(0,r.Wi)(o)||"mesh"===o.type?null:o.spatialReference.equals(c)?o.clone():(0,a.Q8)(o,c)?(0,a.iV)(o,c):null),(0,r.Wi)(n))return null;const d=s.mapEnd.x-s.mapStart.x,h=s.mapEnd.y-s.mapStart.y,u=s.mapEnd.z-s.mapStart.z,p=(0,l.pB)(n.clone(),d,h,u);return p.spatialReference.equals(i)?e[t]=p:e[t]=(0,a.iV)(p,i),{...s,translationX:d,translationY:h,translationZ:u}}}(e,"geometry")}function u(e,t=null,n){let i=null;const s=(0,r.pC)(t)&&!e.spatialReference.equals(t)?e=>(0,r.pC)(e)?(0,a.iV)(e,t):e:e=>e,o={exclude:[],...n};return t=>{if("start"===t.action&&(i=s(e.toMap(t.screenStart,o))),(0,r.Wi)(i))return null;const n=s(e.toMap(t.screenEnd,o));return(0,r.pC)(n)?{...t,mapStart:i,mapEnd:n}:null}}function p(e){const t=e.map((e=>(0,r.Wg)(h(e)))).filter((e=>(0,r.pC)(e)));return e=>{const n=e.mapEnd.x-e.mapStart.x,i=e.mapEnd.y-e.mapStart.y,r=e.mapEnd.z-e.mapStart.z;return t.forEach((t=>t(e))),{...e,translationX:n,translationY:i,translationZ:r}}}function f(e,t){const n=new Map;for(const r of t)n.set(r,(0,i.d9)(e[r]));return t=>(n.forEach(((t,n)=>{e[n]=t})),t)}function m(e){return f(e,["geometry"])}function g(e){const t=e.map((e=>(0,r.Wg)(m(e)))).filter((e=>(0,r.pC)(e)));return e=>(t.forEach((t=>t(e))),e)}function v(e){const t=(0,r.pC)(e.symbol)?e.symbol.clone():null;return n=>(e.symbol=t,n)}function y(){let e=0,t=0,n=0;return i=>{"start"===i.action&&(e=i.mapStart.x,t=i.mapStart.y,n=i.mapStart.z);const r=i.mapEnd.x-e,a=i.mapEnd.y-t,s=i.mapEnd.z-n;return e=i.mapEnd.x,t=i.mapEnd.y,n=i.mapEnd.z,{...i,mapDeltaX:r,mapDeltaY:a,mapDeltaZ:s,mapDeltaSpatialReference:i.mapStart.spatialReference}}}function _(){let e=0,t=0;return n=>{"start"===n.action&&(e=n.screenStart.x,t=n.screenStart.y);const i=n.screenEnd.x-e,r=n.screenEnd.y-t;return e=n.screenEnd.x,t=n.screenEnd.y,{...n,screenDeltaX:i,screenDeltaY:r}}}function b(e,t){let n=null,i=0,r=0;return a=>{if("start"===a.action&&(n=e.toScreen(t),n.x<0||n.x>e.width||n.y<0||n.y>e.height?n=null:(i=a.screenStart.x-n.x,r=a.screenStart.y-n.y)),null==n)return null;const l=(0,s.uZ)(a.screenEnd.x-i,0,e.width),c=(0,s.uZ)(a.screenEnd.y-r,0,e.height),d=(0,o.vW)(l,c);return a.screenStart=n,a.screenEnd=d,a}}class x{constructor(){this.execute=()=>{}}next(e,t=new x){return(0,r.pC)(e)&&(this.execute=n=>{const i=e(n);(0,r.pC)(i)&&t.execute(i)}),t}}},45671:(e,t,n)=>{"use strict";n.d(t,{t:()=>u});var i=n(56140),r=n(95844),a=n(79881),s=n(87566),o=n(74386),l=n(3059),c=n(82677),d=n(59691),h=n(80621);let u=class extends c.default{constructor(){super(...arguments),this.updating=!1,this.handleId=0,this.handles=new d.Z,this.scheduleHandleId=0,this.pendingPromises=new Set}destroy(){this.removeAll(),this.handles.destroy()}add(e,t,n,i=0){const r=0!=(1&i),a=++this.handleId;r||this.installSyncUpdatingWatch(e,t,a);const s=0!=(2&i)?(0,h.init)(e,t,n,r):e.watch(t,n,r);return this.handles.add(s,a),{remove:()=>{this.handles.remove(a)}}}addOnCollectionPropertyChange(e,t,n,i=0){const r=0!=(2&i),a=++this.handleId;return this.handles.add([(0,h.on)(e,t,"after-changes",this.createSyncUpdatingCallback()),(0,h.on)(e,t,"change",n,r?e=>{n({added:e.items,removed:[],moved:[],target:e})}:void 0)],a),{remove:()=>{this.handles.remove(a)}}}addOnCollectionChange(e,t,n=0){const i=0!=(2&n),r=++this.handleId;return this.handles.add([e.on("after-changes",this.createSyncUpdatingCallback()),e.on("change",t)],r),i&&t({added:e.items,removed:[],moved:[],target:e}),{remove:()=>{this.handles.remove(r)}}}addPromise(e){if(!e)return e;const t=++this.handleId;this.handles.add({remove:()=>{this.pendingPromises.delete(e)&&(0!==this.pendingPromises.size||this.handles.has(p)||this._set("updating",!1))}},t),this.pendingPromises.add(e),this._set("updating",!0);const n=()=>this.handles.remove(t);return e.then(n,n),e}removeAll(){this.pendingPromises.clear(),this.handles.removeAll(),this._set("updating",!1)}installSyncUpdatingWatch(e,t,n){const i=this.createSyncUpdatingCallback(),a=(0,l.QU)((()=>(0,r.$z)(e,t)),i);return this.handles.add(a,n),a}createSyncUpdatingCallback(){return()=>{this.handles.remove(p),++this.scheduleHandleId;const e=this.scheduleHandleId;this._get("updating")||this._set("updating",!0),this.handles.add((0,o.Os)((()=>{e===this.scheduleHandleId&&(this._set("updating",this.pendingPromises.size>0),this.handles.remove(p))})),p)}}};(0,i._)([(0,a.Cb)({readOnly:!0})],u.prototype,"updating",void 0),u=(0,i._)([(0,s.j)("esri.views.support.WatchUpdatingTracking")],u);const p=-42}}]);
//# sourceMappingURL=5062.js.map