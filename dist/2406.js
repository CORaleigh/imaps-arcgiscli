(self.webpackChunkimaps=self.webpackChunkimaps||[]).push([[2406],{69065:(e,t,n)=>{"use strict";function r(e,t,n,r){let i=null,s=1e3;"number"==typeof t?(s=t,r=n):(i=null!=t?t:null,s=n);let a,o=0;const l=()=>{o=0,e.apply(r,a)},c=(...e)=>{i&&i.apply(r,e),a=e,s?o||(o=setTimeout(l,s)):l()};return c.remove=()=>{o&&(clearTimeout(o),o=0)},c.forceUpdate=()=>{o&&(clearTimeout(o),l())},c.hasPendingUpdates=()=>!!o,c}n.d(t,{P:()=>r})},56888:(e,t,n)=>{"use strict";n.d(t,{Bs:()=>p,VG:()=>o,sS:()=>g,yc:()=>f,Ud:()=>d,Zv:()=>u,ld:()=>h,Rd:()=>l,Wv:()=>c});var r=n(88263),i=n(17427),s=n(33655),a=n(93533);function o(e,t,n,r=2,s="abbr"){return`${(0,i.uf)(t,{minimumFractionDigits:r,maximumFractionDigits:r})} ${function(e,t,n){return e.units[t][n]}(e,n,s)}`}function l(e,t,n,r=2,i="abbr"){const s=(0,a.KU)(t,n);return o(e,(0,a.En)(t,n,s),s,r,i)}function c(e,t,n,r=2,i="abbr"){const s=(0,a.OG)(t,n);return o(e,(0,a.En)(t,n,s),s,r,i)}function d(e,t,n,r=2,i="abbr"){const s=(0,a.FN)(t,n);return o(e,(0,a.En)(t,n,s),s,r,i)}function u(e,t,n,r=2,i="abbr"){const s=(0,a.qv)(t,n);return o(e,(0,a.En)(t,n,s),s,r,i)}function h(e,t,n,r=2,i="abbr"){const s=(0,a.tQ)(t,n);return o(e,(0,a.En)(t,n,s),s,r,i)}function f(e,t,n,r=2,i="abbr"){const s=(0,a.Yl)(t,n);return o(e,(0,a.En)(t,n,s),s,r,i)}function p(e,t,n=2){let r=(0,a.En)(e,t,"degrees"),i=r-Math.floor(r);r-=i,i*=60;let s=i-Math.floor(i);return i-=s,s*=60,`${r.toFixed()}Â° ${i.toFixed()}' ${s.toFixed(n)}"`}const m=["B","kB","MB","GB","TB"];function g(e,t){let n=0===t?0:Math.floor(Math.log(t)/Math.log(1024));n=(0,s.uZ)(n,0,m.length-1);const a=(0,i.uf)(t/Math.pow(1024,n),{maximumFractionDigits:2});return(0,r.gx)(e.units.bytes[m[n]],{fileSize:a})}},44195:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});class r{constructor(e=null,t={},n,r){this.displayId=0,this.geohashIndexed=!1,this.geohashX=0,this.geohashY=0,this.geometry=e,t&&(this.attributes=t),n&&(this.centroid=n),null!=r&&(this.objectId=r)}get hasGeometry(){return!(!this.geometry||!this.geometry.coords||!this.geometry.coords.length)}weakClone(){const e=new r(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e.geohashIndexed=this.geohashIndexed,e.geohashX=this.geohashX,e.geohashY=this.geohashY,e}}const i=r},60151:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});class r{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new r;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}const i=r},73127:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});class r{constructor(e=[],t=[],n=!1){this.lengths=null!=e?e:[],this.coords=null!=t?t:[],this.hasIndeterminateRingOrder=n}get isPoint(){return 0===this.lengths.length}forEachVertex(e){let t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let n=0;n<this.lengths.length;n++){const r=this.lengths[n];for(let n=0;n<r;n++)e(this.coords[2*(n+t)],this.coords[2*(n+t)+1]);t+=r}}clone(){return new r(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}const i=r},31036:(e,t,n)=>{"use strict";n.d(t,{XA:()=>V,h_:()=>Q,Yn:()=>U,GH:()=>H,E7:()=>D,ks:()=>G,Uy:()=>q,u0:()=>P,EI:()=>W,cn:()=>K,di:()=>Y,Iv:()=>L,fQ:()=>w,eG:()=>O,J6:()=>N,oB:()=>ce,zj:()=>te,$:()=>ie,lz:()=>le,RZ:()=>J,Nh:()=>ee,Jd:()=>y,IN:()=>b,hY:()=>ae,$g:()=>se});var r=n(36544),i=n(32656),s=n(56885),a=n(44195),o=n(60151),l=n(73127);function c(e,t){return e?t?4:3:t?3:2}const d=r.Z.getLogger("esri.tasks.support.optimizedFeatureSet"),u={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},h=(e,t,n,r,i,s)=>{e[n]=i,e[n+1]=s},f=(e,t,n,r,i,s)=>{e[n]=i,e[n+1]=s,e[n+2]=t[r+2]},p=(e,t,n,r,i,s)=>{e[n]=i,e[n+1]=s,e[n+2]=t[r+3]},m=(e,t,n,r,i,s)=>{e[n]=i,e[n+1]=s,e[n+2]=t[r+2],e[n+3]=t[r+3]};function g(e,t,n,r){if(e){if(n)return t&&r?m:f;if(t&&r)return p}else if(t&&r)return f;return h}function y({scale:e,translate:t},n){return Math.round((n-t[0])/e[0])}function b({scale:e,translate:t},n){return Math.round((t[1]-n)/e[1])}function v({scale:e,translate:t},n){return n*e[0]+t[0]}function _({scale:e,translate:t},n){return t[1]-n*e[1]}function w(e,t,n){return e?t?n?x(e):C(e):n?F(e):I(e):null}function I(e){const t=e.coords;return{x:t[0],y:t[1]}}function M(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function C(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function A(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function F(e){const t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function T(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function x(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function j(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function k(e,t){return e&&t?j:e?A:t?T:M}function Z(e,t,n,r,i){const s=k(n,r);for(const n of t){const{geometry:t,attributes:r}=n;let o;t&&(o=s(new l.Z,t)),e.push(new a.Z(o,r,null,r[i]))}return e}function L(e,t,n){if(!e)return null;const r=c(t,n),i=[];for(let t=0;t<e.coords.length;t+=r){const n=[];for(let i=0;i<r;i++)n.push(e.coords[t+i]);i.push(n)}return t?n?{points:i,hasZ:t,hasM:n}:{points:i,hasZ:t}:n?{points:i,hasM:n}:{points:i}}function E(e,t,n,r,i){const s=c(n,r);for(const n of t){const t=n.geometry,r=n.attributes;let o;t&&(o=$(new l.Z,t,s)),e.push(new a.Z(o,r,null,r[i]))}return e}function $(e,t,n=c(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;const r=e.coords;let i=0;for(const e of t.points)for(let t=0;t<n;t++)r[i++]=e[t];return e}function N(e,t,n){if(!e)return null;const r=c(t,n),{coords:i,lengths:s}=e,a=[];let o=0;for(const e of s){const t=[];for(let n=0;n<e;n++){const e=[];for(let t=0;t<r;t++)e.push(i[o++]);t.push(e)}a.push(t)}return t?n?{paths:a,hasZ:t,hasM:n}:{paths:a,hasZ:t}:n?{paths:a,hasM:n}:{paths:a}}function R(e,t,n,r,i){const s=c(n,r);for(const n of t){const t=n.geometry,r=n.attributes;let o;t&&(o=P(new l.Z,t,s)),e.push(new a.Z(o,r,null,r[i]))}return e}function P(e,t,n=c(t.hasZ,t.hasM)){const{lengths:r,coords:i}=e;let s=0;for(const e of t.paths){for(const t of e)for(let e=0;e<n;e++)i[s++]=t[e];r.push(e.length)}return e}function O(e,t,n){if(!e)return null;const r=c(t,n),{coords:i,lengths:s}=e,a=[];let o=0;for(const e of s){const t=[];for(let n=0;n<e;n++){const e=[];for(let t=0;t<r;t++)e.push(i[o++]);t.push(e)}a.push(t)}return t?n?{rings:a,hasZ:t,hasM:n}:{rings:a,hasZ:t}:n?{rings:a,hasM:n}:{rings:a}}function S(e,t,n,r,i){for(const s of t){const t=s.geometry,o=s.centroid,c=s.attributes;let d;t&&(d=q(new l.Z,t,n,r)),o?e.push(new a.Z(d,c,M(new l.Z,o),c[i])):e.push(new a.Z(d,c,null,c[i]))}return e}function q(e,t,n=t.hasZ,r=t.hasM){return G(e,t.rings,n,r),e}function G(e,t,n,r){const i=c(n,r),{lengths:s,coords:a}=e;let o=0;s.length=a.length=0;for(const e of t){for(const t of e)for(let e=0;e<i;e++)a[o++]=t[e];s.push(e.length)}return e}const z=[],B=[];function V(e,t,n,r,i){z[0]=e;const[s]=U(B,z,t,n,r,i);return z.length=B.length=0,s}function U(e,t,n,r,s,o){if(e.length=0,!n){for(const n of t){const t=n.attributes[o];e.push(new a.Z(null,n.attributes,null,t))}return e}switch(n){case"esriGeometryPoint":return Z(e,t,r,s,o);case"esriGeometryMultipoint":return E(e,t,r,s,o);case"esriGeometryPolyline":return R(e,t,r,s,o);case"esriGeometryPolygon":return S(e,t,r,s,o);default:d.error("convertToFeatureSet:unknown-geometry",new i.Z(`Unable to parse unknown geometry type '${n}'`)),e.length=0}return e}function D(e,t,n,r,s,a){const o=e.length;switch(n){case"esriGeometryPoint":Z(e,t,r,s,a);break;case"esriGeometryMultipoint":E(e,t,r,s,a);break;case"esriGeometryPolyline":R(e,t,r,s,a);break;case"esriGeometryPolygon":S(e,t,r,s,a);break;default:d.error("convertToFeatureSet:unknown-geometry",new i.Z(`Unable to parse unknown geometry type '${n}'`))}for(let r=0;r<t.length;r++)e[r+o].geometryType=n,e[r+o].insertAfter=t[r].insertAfter,e[r+o].groupId=t[r].groupId;return e}function W(e,t,n,r){B[0]=e,X(z,B,t,n,r);const i=z[0];return z.length=B.length=0,i}function H(e,t,n){if(!e)return null;const r=new l.Z;return"hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==n&&(n=e.hasM),(0,s.wp)(e)?k(null!=t?t:null!=e.z,null!=n?n:null!=e.m)(r,e):(0,s.oU)(e)?q(r,e,t,n):(0,s.l9)(e)?P(r,e,c(t,n)):(0,s.aW)(e)?$(r,e,c(t,n)):void d.error("convertFromGeometry:unknown-geometry",new i.Z(`Unable to parse unknown geometry type '${e}'`))}function Y(e,t,n,r){const s=e&&("coords"in e?e:e.geometry);if(!s)return null;switch(t){case"esriGeometryPoint":{let e=I;return n&&r?e=x:n?e=C:r&&(e=F),e(s)}case"esriGeometryMultipoint":return L(s,n,r);case"esriGeometryPolyline":return N(s,n,r);case"esriGeometryPolygon":return O(s,n,r);default:return void d.error("convertToGeometry:unknown-geometry",new i.Z(`Unable to parse unknown geometry type '${t}'`))}}function X(e,t,n,r,s){switch(e.length=0,n){case"esriGeometryPoint":return function(e,t,n,r){let i=I;n&&r?i=x:n?i=C:r&&(i=F);for(const n of t){const{geometry:t,attributes:r}=n,s=t?i(t):null;e.push({attributes:r,geometry:s})}return e}(e,t,r,s);case"esriGeometryMultipoint":return function(e,t,n,r){for(const i of t){const{geometry:t,attributes:s}=i;let a;t&&(a=L(t,n,r)),e.push({attributes:s,geometry:a})}return e}(e,t,r,s);case"esriGeometryPolyline":return function(e,t,n,r){for(const i of t){const{geometry:t,attributes:s}=i;let a;t&&(a=N(t,n,r)),e.push({attributes:s,geometry:a})}return e}(e,t,r,s);case"esriGeometryPolygon":return function(e,t,n,r){for(const i of t){const{geometry:t,attributes:s,centroid:a}=i;let o;if(t&&(o=O(t,n,r)),a){const t=I(a);e.push({attributes:s,centroid:t,geometry:o})}else e.push({attributes:s,geometry:o})}return e}(e,t,r,s);default:d.error("convertToFeatureSet:unknown-geometry",new i.Z(`Unable to parse unknown geometry type '${n}'`))}return e}function K(e){const{objectIdFieldName:t,spatialReference:n,transform:r,fields:i,hasM:s,hasZ:a,features:o,geometryType:l,exceededTransferLimit:c,uniqueIdField:d,queryGeometry:u,queryGeometryType:h}=e,f={features:X([],o,l,a,s),fields:i,geometryType:l,objectIdFieldName:t,spatialReference:n,uniqueIdField:d,queryGeometry:Y(u,h,!1,!1)};return r&&(f.transform=r),c&&(f.exceededTransferLimit=c),s&&(f.hasM=s),a&&(f.hasZ=a),f}function Q(e,t){const n=new o.Z,{hasM:r,hasZ:s,features:a,objectIdFieldName:l,spatialReference:c,geometryType:u,exceededTransferLimit:h,transform:f,fields:p}=e;return p&&(n.fields=p),n.geometryType=u,n.objectIdFieldName=l||t,n.spatialReference=c,n.objectIdFieldName?(a&&U(n.features,a,u,s,r,n.objectIdFieldName),h&&(n.exceededTransferLimit=h),r&&(n.hasM=r),s&&(n.hasZ=s),f&&(n.transform=f),n):(d.error(new i.Z("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),n)}function J(e,t){const{geometryType:n,features:r,hasM:i,hasZ:s}=t;if(!e)return t;for(let t=0;t<r.length;t++){const a=r[t],o=a.weakClone();o.geometry=new l.Z,ee(o.geometry,a.geometry,i,s,n,e),a.centroid&&(o.centroid=new l.Z,ee(o.centroid,a.centroid,i,s,"esriGeometryPoint",e)),r[t]=o}return t.transform=e,t}function ee(e,t,n,r,i,s,a=n,o=r){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;const l=u[i],{coords:d,lengths:h}=t,f=c(n,r),p=c(n&&a,r&&o),m=g(n,r,a,o);if(!h.length)return m(e.coords,d,0,0,y(s,d[0]),b(s,d[1])),e.lengths.length&&(e.lengths.length=0),e.coords.length=f,e;let v,_,w,I,M=0,C=0,A=C;for(const t of h){if(t<l)continue;let n=0;C=A,w=v=y(s,d[M]),I=_=b(s,d[M+1]),m(e.coords,d,C,M,w,I),n++,M+=f,C+=p;for(let r=1;r<t;r++,M+=f)w=y(s,d[M]),I=b(s,d[M+1]),w===v&&I===_||(m(e.coords,d,C,M,w-v,I-_),C+=p,n++,v=w,_=I);n>=l&&(e.lengths.push(n),A=C)}return e.coords.length=A,e.coords.length?e:null}function te(e,t,n,r,i,s,a=n,o=r){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;const l=u[i],{coords:d,lengths:h}=t,f=c(n,r),p=c(n&&a,r&&o),m=g(n,r,a,o);if(!h.length)return m(e.coords,d,0,0,d[0],d[1]),e.lengths.length&&(e.lengths.length=0),e.coords.length=f,e;let y=0;const b=s*s;for(const t of h){if(t<l){y+=t*f;continue}const n=e.coords.length/p,r=y,i=y+(t-1)*f;m(e.coords,d,e.coords.length,r,d[r],d[r+1]),re(e.coords,d,f,b,m,r,i),m(e.coords,d,e.coords.length,i,d[i],d[i+1]);const s=e.coords.length/p-n;s>=l?e.lengths.push(s):e.coords.length=n*p,y+=t*f}return e.coords.length?e:null}function ne(e,t,n,r){const i=e[t],s=e[t+1],a=e[n],o=e[n+1],l=e[r],c=e[r+1];let d=a,u=o,h=l-d,f=c-u;if(0!==h||0!==f){const e=((i-d)*h+(s-u)*f)/(h*h+f*f);e>1?(d=l,u=c):e>0&&(d+=h*e,u+=f*e)}return h=i-d,f=s-u,h*h+f*f}function re(e,t,n,r,i,s,a){let o,l=r,c=0;for(let e=s+n;e<a;e+=n)o=ne(t,e,s,a),o>l&&(c=e,l=o);l>r&&(c-s>n&&re(e,t,n,r,i,s,c),i(e,t,e.length,c,t[c],t[c+1]),a-c>n&&re(e,t,n,r,i,c,a))}function ie(e,t,n,r){if(!t||!t.coords||!t.coords.length)return null;const i=c(n,r);let s=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;if(t&&t.coords){const e=t.coords;for(let t=0;t<e.length;t+=i){const n=e[t],r=e[t+1];s=Math.min(s,n),o=Math.max(o,n),a=Math.min(a,r),l=Math.max(l,r)}}return e[0]=s,e[1]=a,e[2]=o,e[3]=l,e}function se(e,t,n,r,i){const{coords:s,lengths:a}=t,o=n?r?m:f:r?f:h,l=c(n,r);if(!s.length)return e!==t&&(e.lengths.length=0,e.coords.length=0),e;if(!a.length)return o(e.coords,s,0,0,v(i,s[0]),_(i,s[1])),e!==t&&(e.lengths.length=0,e.coords.length=l),e;const[d,u]=i.scale;let p=0;for(let t=0;t<a.length;t++){const n=a[t];e.lengths[t]=n;let r=v(i,s[p]),c=_(i,s[p+1]);o(e.coords,s,p,p,r,c),p+=l;for(let t=1;t<n;t++,p+=l)r+=s[p]*d,c-=s[p+1]*u,o(e.coords,s,p,p,r,c)}return e!==t&&(e.lengths.length=a.length,e.coords.length=s.length),e}function ae(e,t,n,r,i,s){const a=c(n,r),o=g(n,r,i,s),l=t.coords;e.coords.length=0,e.lengths.length=0,e.lengths.push(...t.lengths);for(let t=0;t<l.length;t+=a)o(e.coords,l,e.coords.length,t,l[t],l[t+1]);return e}function oe(e,t,n,r){let i=0,s=e[r*t],a=e[r*(t+1)];for(let o=1;o<n;o++){const n=s+e[r*(t+o)],l=a+e[r*(t+o)+1],c=(n-s)*(l+a);s=n,a=l,i+=c}return.5*i}function le(e,t){const{coords:n,lengths:r}=e;let i=0,s=0;for(let e=0;e<r.length;e++)s+=oe(n,i,r[e],t),i+=e;return Math.abs(s)}function ce(e,t){const n=e.clone(),r=e.coords,i=e.lengths;let s=0;for(let e=0;e<i.length;e++){const a=i[e];let o=r[t*s],l=r[t*s+1];for(let e=1;e<a;e++){const i=o+r[t*(s+e)],a=l+r[t*(s+e)+1];n.coords[t*(s+e)]=i,n.coords[t*(s+e)+1]=a,o=i,l=a}s+=a}return n}},89867:(e,t,n)=>{"use strict";n.d(t,{p:()=>i});var r=n(72094);function i(e,t,n){if(!n||!n.features||!n.hasZ)return;const i=(0,r.k)(n.geometryType,t,e.outSpatialReference);if(i)for(const e of n.features)i(e.geometry)}},72094:(e,t,n)=>{"use strict";n.d(t,{k:()=>a,P:()=>l});var r=n(59472),i=n(27780),s=n(93533);function a(e,t,n){if((0,r.Wi)(t)||(0,r.Wi)(n)||n.vcsWkid||(0,i.fS)(t,n))return null;const a=(0,s._R)(t)/(0,s._R)(n);if(1===a)return null;switch(e){case"point":case"esriGeometryPoint":return e=>{return n=a,void((t=e)&&null!=t.z&&(t.z*=n));var t,n};case"polyline":case"esriGeometryPolyline":return e=>function(e,t){if(e)for(const n of e.paths)for(const e of n)e.length>2&&(e[2]*=t)}(e,a);case"polygon":case"esriGeometryPolygon":return e=>function(e,t){if(e)for(const n of e.rings)for(const e of n)e.length>2&&(e[2]*=t)}(e,a);case"multipoint":case"esriGeometryMultipoint":return e=>function(e,t){if(e)for(const n of e.points)n.length>2&&(n[2]*=t)}(e,a);default:return null}}function o(e,t,n){if(null==e.hasM||e.hasZ)for(const e of t)for(const t of e)t.length>2&&(t[2]*=n)}function l(e,t,n){if(!e&&!t||!n)return;const r=(0,s._R)(n);c(e,n,r),c(t,n,r)}function c(e,t,n){if(e)for(const r of e)d(r.geometry,t,n)}function d(e,t,n){if(!e||!e.spatialReference||(0,i.fS)(e.spatialReference,t))return;const r=(0,s._R)(e.spatialReference)/n;if(1!==r)if("x"in e)null!=e.z&&(e.z*=r);else if("rings"in e)o(e,e.rings,r);else if("paths"in e)o(e,e.paths,r);else if("points"in e&&(null==e.hasM||e.hasZ))for(const t of e.points)t.length>2&&(t[2]*=r)}},69829:(e,t,n)=>{"use strict";function r(e){return e&&"function"==typeof e.highlight}n.d(t,{tl:()=>r})},95627:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var r=n(56140),i=(n(95830),n(59472)),s=(n(36544),n(79881)),a=n(60263),o=n(87566),l=n(32656),c=(n(10923),n(57002),n(86035),n(83477)),d=n(15988),u=n(80621),h=n(7354),f=n(82905),p=n(77204),m=n(29209);const g={editing:!1,operations:{add:!0,update:!0,delete:!0}},y=c.Z.ofType(f.Z);let b=class extends p.r{constructor(e){super(e),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...g},this.activeAttachmentInfo=null,this.attachmentInfos=new y,this.graphic=null,this.mode="view",this.handles.add([(0,u.init)(this,"graphic",(()=>this._graphicChanged()))])}destroy(){this._attachmentLayer=null,this.graphic=null}castAbilities(e){return{...g,...e}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){return this.get("graphic.layer.capabilities.operations.supportsResizeAttachments")||!1}async getAttachments(){const{_attachmentLayer:e,attachmentInfos:t}=this;if(!e||"function"!=typeof e.queryAttachments)throw new l.Z("invalid-layer","getAttachments(): A valid layer is required.");const n=this._getFeatureId(),r=new h.Z({objectIds:[n],returnMetadata:!0}),i=[],s=e.queryAttachments(r).then((e=>e[n]||i)).catch((()=>i));this._getAttachmentsPromise=s,this.notifyChange("state");const a=await s;return t.removeAll(),a.length&&t.addMany(a),this._getAttachmentsPromise=null,this.notifyChange("state"),a}async addAttachment(e){const{_attachmentLayer:t,attachmentInfos:n,graphic:r,abilities:i}=this;if(!e)throw new l.Z("invalid-attachment","addAttachment(): An attachment is required.",{attachment:e});if(!i.operations.add)throw new l.Z("invalid-abilities","addAttachment(): add abilities are required.");if(!t||"function"!=typeof t.addAttachment)throw new l.Z("invalid-layer","addAttachment(): A valid layer is required.");const s=t.addAttachment(r,e).then((e=>this._queryAttachment(e.objectId))),a=await s;return n.add(a),a}async deleteAttachment(e){const{_attachmentLayer:t,attachmentInfos:n,graphic:r,abilities:i}=this;if(!e)throw new l.Z("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!i.operations.delete)throw new l.Z("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!t||"function"!=typeof t.deleteAttachments)throw new l.Z("invalid-layer","deleteAttachment(): A valid layer is required.");const s=t.deleteAttachments(r,[e.id]).then((()=>e)),a=await s;return n.remove(a),a}async updateAttachment(e,t=this.activeAttachmentInfo){const{_attachmentLayer:n,attachmentInfos:r,graphic:i,abilities:s}=this;if(!e)throw new l.Z("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!t)throw new l.Z("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!s.operations.update)throw new l.Z("invalid-abilities","updateAttachment(): Update abilities are required.");const a=r.findIndex((e=>e===t));if(!n||"function"!=typeof n.updateAttachment)throw new l.Z("invalid-layer","updateAttachment(): A valid layer is required.");const o=n.updateAttachment(i,t.id,e).then((e=>this._queryAttachment(e.objectId))),c=await o;return r.splice(a,1,c),c}async _queryAttachment(e){if(!e)throw new l.Z("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:t}=this,n=this._getFeatureId(),r=new h.Z({objectIds:[n],attachmentsWhere:`AttachmentId=${e}`,returnMetadata:!0});return t.queryAttachments(r).then((e=>e[n][0]))}_getFeatureId(){const{_attachmentLayer:e,graphic:t}=this;if(!e||!t)return null;const{objectIdField:n}=e,{attributes:r}=t;return r&&r[n]}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((()=>{})))}_setAttachmentLayer(){const{graphic:e}=this,t=(0,m.l$)(e);this._attachmentLayer=t?"scene"===t.type&&(0,i.pC)(t.associatedLayer)?t.associatedLayer:t:null}};(0,r._)([(0,s.Cb)()],b.prototype,"abilities",void 0),(0,r._)([(0,a.p)("abilities")],b.prototype,"castAbilities",null),(0,r._)([(0,s.Cb)()],b.prototype,"activeAttachmentInfo",void 0),(0,r._)([(0,s.Cb)({readOnly:!0,type:y})],b.prototype,"attachmentInfos",void 0),(0,r._)([(0,s.Cb)({type:d.Z})],b.prototype,"graphic",void 0),(0,r._)([(0,s.Cb)()],b.prototype,"mode",void 0),(0,r._)([(0,s.Cb)({dependsOn:["graphic"],readOnly:!0})],b.prototype,"state",null),(0,r._)([(0,s.Cb)({readOnly:!0,dependsOn:["graphic","graphic.layer","graphic.layer.loaded","graphic.layer.capabilities.operations.supportsResizeAttachments"]})],b.prototype,"supportsResizeAttachments",null),b=(0,r._)([(0,o.j)("esri.widgets.Attachments.AttachmentsViewModel")],b);const v=b},22292:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ye});var r=n(56140),i=(n(95830),n(36544),n(79881)),s=n(51894),a=n(60263),o=n(87566),l=(n(10923),n(57002),n(86035),n(61398)),c=(n(89771),n(80621)),d=n(40450),u=n(9200),h=n(90846),f=n(19401),p=n(90806),m=n(32656),g=n(56888),y=n(95627);const b=(0,n(12973).V)("esri/themes/base/images/files/");function v(e){return e?"text/plain"===e?`${b}text-32.svg`:"application/pdf"===e?`${b}pdf-32.svg`:"text/csv"===e?`${b}csv-32.svg`:"application/gpx+xml"===e?`${b}gpx-32.svg`:"application/x-dwf"===e?`${b}cad-32.svg`:"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?`${b}code-32.svg`:"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?`${b}zip-32.svg`:-1!==e.indexOf("image/")?`${b}image-32.svg`:-1!==e.indexOf("audio/")?`${b}sound-32.svg`:-1!==e.indexOf("video/")?`${b}video-32.svg`:-1!==e.indexOf("msexcel")||-1!==e.indexOf("ms-excel")||-1!==e.indexOf("spreadsheetml")?`${b}excel-32.svg`:-1!==e.indexOf("msword")||-1!==e.indexOf("ms-word")||-1!==e.indexOf("wordprocessingml")?`${b}word-32.svg`:-1!==e.indexOf("powerpoint")||-1!==e.indexOf("presentationml")?`${b}report-32.svg`:`${b}generic-32.svg`:`${b}generic-32.svg`}const _={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},w="esri-attachments__item-button",I="esri-attachments__form-node",M="esri-attachments__file-fieldset",C="esri-attachments__file-label",A="esri-attachments__file-name",F="esri-attachments__file-input",T="esri-attachments__metadata-fieldset",x="esri-button",j="esri-button--disabled",k="esri-button--secondary",Z="esri-button--tertiary",L="esri-button--third",E="esri-button--small",$="esri-button--half",N=window.CSS;let R=class extends p.default{constructor(e,t){super(e,t),this.abilities=null,this.displayType="list",this.graphic=null,this.label=void 0,this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new y.Z,this.visibleElements={..._},this._supportsImageOrientation=N&&N.supports&&N.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}initialize(){this.own((0,c.on)(this,"viewModel.attachmentInfos","change",(()=>this.scheduleRender())),(0,c.init)(this,"viewModel.mode",(()=>this._modeChanged())))}castVisibleElements(e){return{..._,...e}}addAttachment(){const{_addAttachmentForm:e,viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.addAttachment(e).then((e=>(this._set("submitting",!1),this._set("error",null),t.mode="view",e))).catch((e=>{throw this._set("submitting",!1),this._set("error",new m.Z("attachments:add-attachment",this.messages.addErrorMessage,e)),e}))}deleteAttachment(e){const{viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.deleteAttachment(e).then((e=>(this._set("submitting",!1),this._set("error",null),t.mode="view",e))).catch((e=>{throw this._set("submitting",!1),this._set("error",new m.Z("attachments:delete-attachment",this.messages.deleteErrorMessage,e)),e}))}updateAttachment(){const{viewModel:e}=this,{_updateAttachmentForm:t}=this;return this._set("submitting",!0),this._set("error",null),e.updateAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),e.mode="view",t))).catch((e=>{throw this._set("submitting",!1),this._set("error",new m.Z("attachments:update-attachment",this.messages.updateErrorMessage,e)),e}))}render(){const{submitting:e,viewModel:t}=this,{state:n}=t;return(0,f.j)("div",{class:this.classes("esri-attachments","esri-widget")},e?this.renderProgressBar():null,"loading"===n?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:e,visibleElements:t}=this;return e&&t.errorMessage?(0,f.j)("div",{key:"error-message",class:"esri-attachments__error-message"},e.message):null}renderAttachments(){const{mode:e,activeAttachmentInfo:t}=this.viewModel;return"add"===e?this.renderAddForm():"edit"===e?this.renderDetailsForm(t):this.renderAttachmentContainer()}renderLoading(){return(0,f.j)("div",{class:"esri-attachments__loader-container",key:"loader"},(0,f.j)("div",{class:"esri-attachments__loader"}))}renderProgressBar(){return this.visibleElements.progressBar?(0,f.j)("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null}renderAddForm(){const{submitting:e,selectedFile:t}=this,n=e||!t,r=this.visibleElements.cancelAddButton?(0,f.j)("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(x,Z,E,$,e&&j)},this.messages.cancel):null,i=this.visibleElements.addSubmitButton?(0,f.j)("button",{type:"submit",disabled:n,class:this.classes(x,k,E,$,{[j]:n})},this.messages.add):null,s=t?(0,f.j)("span",{key:"file-name",class:A},t.name):null,a=(0,f.j)("form",{bind:this,afterCreate:d.Se,afterRemoved:d.pV,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},(0,f.j)("fieldset",{class:M},s,(0,f.j)("label",{class:this.classes(C,x,k)},t?this.messages.changeFile:this.messages.selectFile,(0,f.j)("input",{class:F,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),i,r);return(0,f.j)("div",{key:"add-form-container",class:I},a)}renderDetailsForm(e){const{visibleElements:t,viewModel:n,selectedFile:r,submitting:i}=this,{contentType:s,size:a,url:o}=e,{abilities:l}=n,c=i||!r,u=l.editing&&l.operations.delete&&t.deleteButton?(0,f.j)("button",{key:"delete-button",type:"button",disabled:i,bind:this,onclick:t=>this._submitDeleteAttachment(t,e),class:this.classes(x,E,Z,"esri-attachments__delete-button",{[j]:i})},this.messages.delete):null,h=l.editing&&l.operations.update&&t.updateButton?(0,f.j)("button",{disabled:c,key:"update-button",type:"submit",class:this.classes(x,E,L,{[j]:c})},this.messages.update):null,p=this.visibleElements.cancelUpdateButton?(0,f.j)("button",{disabled:i,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(x,E,Z,L,{[j]:i})},this.messages.cancel):null,m=r?(0,f.j)("span",{key:"file-name",class:A},r.name):null,y=l.editing&&l.operations.update?(0,f.j)("fieldset",{key:"file",class:M},m,(0,f.j)("label",{class:this.classes(C,x,k)},this.messages.changeFile,(0,f.j)("input",{class:F,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):null,b=(0,f.j)("fieldset",{key:"size",class:T},(0,f.j)("label",null,(0,g.sS)(this.messagesUnits,a))),v=(0,f.j)("fieldset",{key:"content-type",class:T},(0,f.j)("label",null,s)),_=(0,f.j)("form",{bind:this,afterCreate:d.Se,afterRemoved:d.pV,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},(0,f.j)("div",{class:"esri-attachments__metadata"},b,v),y,(0,f.j)("div",{class:"esri-attachments__actions"},u,p,h));return(0,f.j)("div",{key:"edit-form-container",class:I},(0,f.j)("a",{class:"esri-attachments__item-link",href:o,rel:"noreferrer",target:"_blank",alt:name},this.renderImageMask({attachmentInfo:e,size:400}),(0,f.j)("div",{class:"esri-attachments__item-link-overlay"},(0,f.j)("span",{class:"esri-attachments__item-link-overlay-icon"},(0,f.j)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},(0,f.j)("path",{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),(0,f.j)("path",{fill:"none",d:"M0 0h32v32H0z"}))))),_)}renderImageMask({attachmentInfo:e,size:t}){const{supportsResizeAttachments:n}=this.viewModel,{contentType:r,url:i}=e,s=n&&function(e){const t=e.toLowerCase();return"image/bmp"===t||"image/emf"===t||"image/exif"===t||"image/gif"===t||"image/x-icon"===t||"image/jpeg"===t||"image/png"===t||"image/tiff"===t||"image/x-wmf"===t}(r),a=this._getCSSTransform(e,s),o=a?{transform:a,"image-orientation":"none"}:{},l=-1===i.indexOf("?")?"?":"&",c=s?`${i}${l}w=${t}`:v(r),d={"esri-attachments__item-mask--icon":!s},u={"esri-attachments__image--resizable":n};return(0,f.j)("div",{class:this.classes(d,"esri-attachments__item-mask")},(0,f.j)("img",{styles:o,alt:"",src:c,class:this.classes(u,"esri-attachments__image")}))}renderAttachmentInfo({attachmentInfo:e,displayType:t}){const{viewModel:n}=this,{abilities:r}=n,{name:i,url:s}=e,a=this.renderImageMask({attachmentInfo:e,size:"list"===t?48:400}),o=r.editing?(0,f.j)("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",(0,d.dZ)()?"esri-icon-left":"esri-icon-right")}):null,l=[a,(0,f.j)("label",{class:"esri-attachments__label"},(0,f.j)("span",{class:"esri-attachments__filename"},i||this.messages.noTitle),o)],c=r.editing?(0,f.j)("button",{key:"details-button",bind:this,class:w,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":e.id,onclick:()=>this._startEditAttachment(e),type:"button"},l):(0,f.j)("a",{key:"details-link",class:w,href:s,target:"_blank"},l);return(0,f.j)("li",{class:"esri-attachments__item",key:e},c)}renderAttachmentContainer(){const{displayType:e,viewModel:t,visibleElements:n}=this,{attachmentInfos:r,abilities:i}=t,s=r&&r.length,a={"esri-attachments__container--list":"preview"!==e,"esri-attachments__container--preview":"preview"===e},o=i.editing&&i.operations.add&&n.addButton?(0,f.j)("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(x,Z,"esri-attachments__add-attachment-button"),type:"button"},(0,f.j)("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon","esri-icon-plus")}),this.messages.add):null,l=s?(0,f.j)("ul",{class:"esri-attachments__items"},r.toArray().map((t=>this.renderAttachmentInfo({attachmentInfo:t,displayType:e})))):(0,f.j)("div",{class:"esri-widget__content--empty"},this.messages.noAttachments);return(0,f.j)("div",{key:"attachments-container",class:this.classes("esri-attachments__container",a)},l,o)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(e){const t=e.target,n=t&&t.files&&t.files.item(0);this._set("selectedFile",n)}_submitDeleteAttachment(e,t){e.preventDefault(),this.deleteAttachment(t)}_submitAddAttachment(e){e.preventDefault(),this.addAttachment()}_submitUpdateAttachment(e){e.preventDefault(),this.updateAttachment()}_startEditAttachment(e){const{viewModel:t}=this;t.activeAttachmentInfo=e,t.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(e,t){const{orientationInfo:n}=e;return!this._supportsImageOrientation&&t&&n?[n.rotation?`rotate(${n.rotation}deg)`:"",n.mirrored?"scaleX(-1)":""].join(" "):""}};(0,r._)([(0,s.B)("viewModel.abilities")],R.prototype,"abilities",void 0),(0,r._)([(0,i.Cb)(),(0,h.G)()],R.prototype,"displayType",void 0),(0,r._)([(0,s.B)("viewModel.graphic")],R.prototype,"graphic",void 0),(0,r._)([(0,i.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],R.prototype,"label",void 0),(0,r._)([(0,i.Cb)(),(0,h.G)(),(0,u.H)("esri/widgets/Attachments/t9n/Attachments")],R.prototype,"messages",void 0),(0,r._)([(0,i.Cb)(),(0,h.G)(),(0,u.H)("esri/core/t9n/Units")],R.prototype,"messagesUnits",void 0),(0,r._)([(0,i.Cb)({readOnly:!0})],R.prototype,"selectedFile",void 0),(0,r._)([(0,h.G)(),(0,i.Cb)({readOnly:!0})],R.prototype,"submitting",void 0),(0,r._)([(0,h.G)(),(0,i.Cb)({readOnly:!0})],R.prototype,"error",void 0),(0,r._)([(0,i.Cb)({type:y.Z}),(0,h.G)(["viewModel.activeAttachmentInfo","viewModel.mode","viewModel.state","viewModel.supportsResizeAttachments","viewModel.attachmentInfos","viewModel.graphic","viewModel.abilities","viewModel.abilities.editing","viewModel.abilities.operations"])],R.prototype,"viewModel",void 0),(0,r._)([(0,i.Cb)(),(0,h.G)()],R.prototype,"visibleElements",void 0),(0,r._)([(0,a.p)("visibleElements")],R.prototype,"castVisibleElements",null),R=(0,r._)([(0,o.j)("esri.widgets.Attachments")],R);const P=R;n(68055);var O=n(73502),S=n(29209),q=n(39498);let G=class extends p.default{constructor(e,t){super(e,t),this.creator=null,this.graphic=null,this.viewModel=null,this._addTargetToAnchors=e=>{Array.from(e.querySelectorAll("a")).forEach((e=>{(0,S.or)(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank")}))}}renderLoading(){return(0,f.j)("div",{class:"esri-feature-content__loader-container",key:"loader"},(0,f.j)("div",{class:"esri-feature-content__loader"}))}renderCreated(){var e;const t=null==(e=this.viewModel)?void 0:e.created;return t?t instanceof HTMLElement?(0,f.j)("div",{key:t,bind:t,afterCreate:this._attachToNode}):(0,O.isWidget)(t)?(0,f.j)("div",{key:t},!t.destroyed&&t.render()):(0,f.j)("div",{key:t,innerHTML:t,afterCreate:this._addTargetToAnchors}):null}render(){var e;const t=null==(e=this.viewModel)?void 0:e.state;return(0,f.j)("div",{class:"esri-feature-content"},"loading"===t?this.renderLoading():this.renderCreated())}_attachToNode(e){e.appendChild(this)}};(0,r._)([(0,s.B)("viewModel.creator")],G.prototype,"creator",void 0),(0,r._)([(0,s.B)("viewModel.graphic")],G.prototype,"graphic",void 0),(0,r._)([(0,h.G)(["viewModel.created","viewModel.state"]),(0,i.Cb)({type:q.Z})],G.prototype,"viewModel",void 0),G=(0,r._)([(0,o.j)("esri.widgets.Feature.FeatureContent")],G);const z=G;var B=n(54881),V=n(88263);const U=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function D(e,t){if("string"!=typeof t||!t)return t;const n=function(e){let t=null;return U.some((n=>(n.pattern.test(e)&&(t=n),!!t))),t}(t);if(!n)return t;const r=t.match(n.pattern),i=r&&r[2],s=(0,V.gx)((0,V.gx)(n.label,{messages:e,hierPart:i}),{appName:n.appName}),a=n.target?` target="${n.target}"`:"",o="_blank"===n.target?' rel="noreferrer"':"";return t.replace(n.pattern,`<a${a} href="$1"${o}>${s}</a>`)}let W=class extends p.default{constructor(e,t){super(e,t),this.attributes=null,this.expressionInfos=null,this.fieldInfos=null,this.viewModel=new B.Z,this.messages=null,this.messagesURIUtils=null}renderFieldInfo(e,t){const{attributes:n}=this.viewModel,r=e.fieldName,i=e.label||r,s=n?null==n[r]?"":n[r]:"",a=!(!e.format||!e.format.dateFormat),o="number"!=typeof s||a?D(this.messagesURIUtils,s):this._forceLTR(s),l={"esri-feature-fields__field-data--date":a};return(0,f.j)("tr",{key:`fields-element-info-row-${r}-${t}`},(0,f.j)("th",{key:`fields-element-info-row-header-${r}-${t}`,class:"esri-feature-fields__field-header",innerHTML:i}),(0,f.j)("td",{key:`fields-element-info-row-data-${r}-${t}`,class:this.classes("esri-feature-fields__field-data",l),innerHTML:o}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e.length?(0,f.j)("table",{class:"esri-widget__table",summary:this.messages.fieldsSummary},(0,f.j)("tbody",null,e.map(((e,t)=>this.renderFieldInfo(e,t))))):null}render(){return(0,f.j)("div",{class:"esri-feature-fields"},this.renderFields())}_forceLTR(e){return`&lrm;${e}`}};(0,r._)([(0,s.B)("viewModel.attributes")],W.prototype,"attributes",void 0),(0,r._)([(0,s.B)("viewModel.expressionInfos")],W.prototype,"expressionInfos",void 0),(0,r._)([(0,s.B)("viewModel.fieldInfos")],W.prototype,"fieldInfos",void 0),(0,r._)([(0,i.Cb)({type:B.Z}),(0,h.G)(["viewModel.attributes","viewModel.formattedFieldInfos"])],W.prototype,"viewModel",void 0),(0,r._)([(0,i.Cb)(),(0,h.G)(),(0,u.H)("esri/widgets/Feature/t9n/Feature")],W.prototype,"messages",void 0),(0,r._)([(0,i.Cb)(),(0,h.G)(),(0,u.H)("esri/widgets/support/t9n/uriUtils")],W.prototype,"messagesURIUtils",void 0),W=(0,r._)([(0,o.j)("esri.widgets.Feature.FeatureFields")],W);const H=W;var Y=n(10180),X=n(36861),K=n(39105),Q=n(3766),J=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],ee=[].concat(J.slice(30,39),J.slice(28,30).reverse()),te=[{name:"default",colors:ee},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}];const ne=new Map([["ar",()=>n.e(5740).then(n.bind(n,75740)).then((function(e){return e.a}))],["bs-ba",()=>n.e(2094).then(n.bind(n,2094)).then((function(e){return e.b}))],["ca-es",()=>n.e(8340).then(n.bind(n,98340)).then((function(e){return e.c}))],["cs-cz",()=>n.e(4562).then(n.bind(n,44562)).then((function(e){return e.c}))],["da-dk",()=>n.e(6983).then(n.bind(n,76983)).then((function(e){return e.d}))],["de-de",()=>n.e(8973).then(n.bind(n,28973)).then((function(e){return e.d}))],["de-ch",()=>n.e(9645).then(n.bind(n,59645)).then((function(e){return e.d}))],["el-gr",()=>n.e(965).then(n.bind(n,50965)).then((function(e){return e.e}))],["en-us",()=>n.e(8724).then(n.bind(n,8724)).then((function(e){return e.e}))],["en-ca",()=>n.e(4488).then(n.bind(n,14488)).then((function(e){return e.e}))],["es-es",()=>n.e(699).then(n.bind(n,699)).then((function(e){return e.e}))],["et-ee",()=>n.e(8093).then(n.bind(n,48093)).then((function(e){return e.e}))],["fi-fi",()=>n.e(4894).then(n.bind(n,74894)).then((function(e){return e.f}))],["fr-fr",()=>n.e(7467).then(n.bind(n,47467)).then((function(e){return e.f}))],["he-il",()=>n.e(3824).then(n.bind(n,73824)).then((function(e){return e.h}))],["hr-hr",()=>n.e(3058).then(n.bind(n,83058)).then((function(e){return e.h}))],["hu-hu",()=>n.e(3952).then(n.bind(n,33952)).then((function(e){return e.h}))],["id-id",()=>n.e(4840).then(n.bind(n,94840)).then((function(e){return e.i}))],["it-it",()=>n.e(613).then(n.bind(n,20613)).then((function(e){return e.i}))],["ja-jp",()=>n.e(8613).then(n.bind(n,88613)).then((function(e){return e.j}))],["ko-kr",()=>n.e(152).then(n.bind(n,80152)).then((function(e){return e.k}))],["lt-lt",()=>n.e(9713).then(n.bind(n,99713)).then((function(e){return e.l}))],["lv-lv",()=>n.e(58).then(n.bind(n,58)).then((function(e){return e.l}))],["nb-no",()=>n.e(8745).then(n.bind(n,70169)).then((function(e){return e.n}))],["nl-nl",()=>n.e(6734).then(n.bind(n,46734)).then((function(e){return e.n}))],["pl-pl",()=>n.e(86).then(n.bind(n,70086)).then((function(e){return e.p}))],["pt-br",()=>n.e(3973).then(n.bind(n,13973)).then((function(e){return e.p}))],["pt-pt",()=>n.e(3566).then(n.bind(n,23566)).then((function(e){return e.p}))],["ro-ro",()=>n.e(885).then(n.bind(n,30885)).then((function(e){return e.r}))],["ru-ru",()=>n.e(2907).then(n.bind(n,22907)).then((function(e){return e.r}))],["sl-sl",()=>n.e(4294).then(n.bind(n,94294)).then((function(e){return e.s}))],["sr-rs",()=>n.e(8899).then(n.bind(n,78899)).then((function(e){return e.s}))],["sv-se",()=>n.e(3528).then(n.bind(n,33528)).then((function(e){return e.s}))],["th-th",()=>n.e(6311).then(n.bind(n,66311)).then((function(e){return e.t}))],["tr-tr",()=>n.e(8817).then(n.bind(n,8817)).then((function(e){return e.t}))],["uk-ua",()=>n.e(7863).then(n.bind(n,97863)).then((function(e){return e.u}))],["vi-vn",()=>n.e(4658).then(n.bind(n,74658)).then((function(e){return e.v}))],["zh-cn",()=>n.e(7892).then(n.bind(n,77892)).then((function(e){return e.z}))],["zh-hk",()=>n.e(5541).then(n.bind(n,45541)).then((function(e){return e.z}))],["zh-tw",()=>n.e(5541).then(n.bind(n,45541)).then((function(e){return e.z}))]]);let re,ie;async function se(e=(0,Q.Kd)()){if(e=function(e){return e?ne.has(e.toLowerCase())?e.toLowerCase():function(e){const t=e.split("-")[0].toLowerCase();let n=null;for(const e of ne.keys())if(e.startsWith(t)){n=e;break}return n}(e)||"en-us":"en-us"}(e),re&&e===ie)return re;re=n.e(5959).then(n.bind(n,95959)).then((function(e){return e.i})),ie=e;try{const[t,n]=await(0,K.all)([re,ne.get(ie)()]);ie===e&&(t.am4core.options.defaultLocale=n.default),t.am4core.options.suppressWarnings=!0,t.am4core.options.autoDispose=!0}catch{return re=null,ie=null,null}return re}const ae="esri-feature-media__button",oe="esri-feature-media__icon",le="esri-icon-left-triangle-arrow",ce="esri-icon-right-triangle-arrow";let de=class extends p.default{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this.attributes=null,this.activeMediaInfoIndex=null,this.fieldInfoMap=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.viewModel=new X.Z,this.messages=null}initialize(){this.own((0,c.init)(this,["viewModel.activeMediaInfo","viewModel.activeMediaInfoIndex"],(()=>this._setupMediaRefreshTimer())))}destroy(){this._clearMediaRefreshTimer()}render(){return(0,f.j)("div",{bind:this,class:"esri-feature-media",onkeyup:this._handleMediaKeyup},this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?(0,f.j)("div",{key:"media-element-container",class:"esri-feature-media__container"},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:n,formattedMediaInfoCount:r}=this.viewModel,{value:i,refreshInterval:s,altText:a,title:o,type:l}=e,{sourceURL:c,linkURL:d}=i,u=(0,S.or)(d)?"_blank":"_self",h="_blank"===u?"noreferrer":"",p=s?t:null,m=p?p.timestamp:0,g=p?p.sourceURL:c,y=(0,f.j)("img",{alt:a||o,key:`media-${l}-${n}-${r}-${m}`,src:g});return(d?(0,f.j)("a",{title:o,href:d,rel:h,target:u},y):null)||y}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:n}=this.viewModel;return(0,f.j)("div",{key:`media-${e.type}-${t}-${n}`,bind:this,class:"esri-feature-media__chart",afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?"image"===e.type?this.renderImageMediaInfo(e):-1!==e.type.indexOf("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel,t=e.title?(0,f.j)("div",{key:"media-title",class:"esri-feature-media__item-title",innerHTML:e.title}):null,n=e.caption?(0,f.j)("div",{key:"media-caption",class:"esri-feature-media__item-caption",innerHTML:e.caption}):null;return(0,f.j)("div",{key:"media-container",class:"esri-feature-media__item-container"},t,n,(0,f.j)("div",{key:"media-item-container",class:"esri-feature-media__item"},this.renderMediaInfoType()))}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t="previous"===e,n=t?this.messages.previous:this.messages.next,r=t?this.classes(ae,"esri-feature-media__previous"):this.classes(ae,"esri-feature-media__next"),i=t?this.classes(oe,"esri-feature-media__previous-icon",le):this.classes(oe,"esri-feature-media__next-icon",ce),s=t?this.classes(oe,"esri-feature-media__previous-icon--rtl",ce):this.classes(oe,"esri-feature-media__next-icon--rtl",le),a=t?"media-previous":"media-next",o=t?this._previous:this._next;return(0,f.j)("button",{type:"button",key:a,title:n,"aria-label":n,tabIndex:0,class:r,bind:this,onclick:o},(0,f.j)("span",{"aria-hidden":"true",class:i}),(0,f.j)("span",{"aria-hidden":"true",class:s}))}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}async _getChartDependencies(e){const t=await se(),{activeMediaInfo:n}=this.viewModel;this._renderChart({chartDiv:e,mediaInfo:n,chartsModule:t})}_handleMediaKeyup(e){const t=(0,Y.kK)(e);"ArrowLeft"===t&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.viewModel.next())}_renderChart(e){const{chartsModule:t,chartDiv:n,mediaInfo:r}=e,{value:i,type:s}=r,{am4core:a}=t,o=function(e,t="default"){const n=te.find((e=>e.name===t));return n?n.colors.map((t=>e.color(t))):null}(a);(0,d.$o)()&&a.useTheme(t.am4themes_dark),a.useTheme(t.am4themes_animated),a.useTheme((function(e){e instanceof a.ColorSet&&o&&(e.list=o)}));const l="pie-chart"===s?this._createPieChart(e):this._createXYChart(e);n.setAttribute("aria-label",r.altText||r.title),l.data=i.series.map((e=>({tooltip:e.tooltip,value:e.value}))).filter((e=>"pie-chart"!==s||e.value>0))}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7})}_createPieChart(e){const{chartDiv:t,chartsModule:n}=e,{am4core:r,am4charts:i}=n,s=r.create(t,i.PieChart);s.rtl=(0,d.dZ)();const a=s.series.push(new i.PieSeries);return a.labels.template.disabled=!0,a.ticks.template.disabled=!0,a.dataFields.value="value",a.dataFields.category="tooltip",this._customizeChartTooltip(a.tooltip,r),s}_getMinSeriesValue(e){let t=0;return e.forEach((e=>t=Math.min(e.value,t))),t}_createColumnChart(e,t){const{chartsModule:n,mediaInfo:r}=t,{value:i}=r,{am4core:s,am4charts:a}=n,o=e.xAxes.push(new a.CategoryAxis);o.dataFields.category="tooltip",o.renderer.labels.template.disabled=!0,this._customizeChartTooltip(o.tooltip,s),o.tooltip.events.on("sizechanged",(()=>{o.tooltip.dy=-o.tooltip.contentHeight}));const l=e.yAxes.push(new a.ValueAxis),c=l.renderer.labels.template;l.renderer.minLabelPosition=.05,l.renderer.maxLabelPosition=.95,l.min=this._getMinSeriesValue(i.series),this._customizeChartTooltip(l.tooltip,s),c.wrap=!0;const d=e.series.push(new a.ColumnSeries);d.dataFields.valueY="value",d.dataFields.categoryX="tooltip",e.cursor=new a.XYCursor,i.series.length>15&&(e.scrollbarX=new s.Scrollbar)}_createBarChart(e,t){const{chartsModule:n,mediaInfo:r}=t,{value:i}=r,{am4core:s,am4charts:a}=n,o=e.yAxes.push(new a.CategoryAxis);o.dataFields.category="tooltip",o.renderer.inversed=!0,o.renderer.labels.template.disabled=!0,this._customizeChartTooltip(o.tooltip,s),o.tooltip.events.on("sizechanged",(()=>{o.tooltip.dx=o.tooltip.contentWidth}));const l=e.xAxes.push(new a.ValueAxis),c=l.renderer.labels.template;l.renderer.minLabelPosition=.05,l.renderer.maxLabelPosition=.95,l.min=this._getMinSeriesValue(i.series),this._customizeChartTooltip(l.tooltip,s),c.wrap=!0;const d=e.series.push(new a.ColumnSeries);d.dataFields.valueX="value",d.dataFields.categoryY="tooltip",e.cursor=new a.XYCursor,i.series.length>15&&(e.scrollbarY=new s.Scrollbar)}_createLineChart(e,t){const{chartsModule:n,mediaInfo:r}=t,{value:i}=r,{am4core:s,am4charts:a}=n,o=e.xAxes.push(new a.CategoryAxis);o.dataFields.category="tooltip",o.renderer.labels.template.disabled=!0,this._customizeChartTooltip(o.tooltip,s),o.tooltip.events.on("sizechanged",(()=>{o.tooltip.dy=-o.tooltip.contentHeight}));const l=e.yAxes.push(new a.ValueAxis),c=l.renderer.labels.template;l.renderer.minLabelPosition=.05,l.renderer.maxLabelPosition=.95,l.min=this._getMinSeriesValue(i.series),this._customizeChartTooltip(l.tooltip,s),c.wrap=!0;const d=e.series.push(new a.LineSeries);d.dataFields.categoryX="tooltip",d.dataFields.valueY="value",e.cursor=new a.XYCursor,i.series.length>15&&(e.scrollbarX=new s.Scrollbar)}_createXYChart(e){const{chartDiv:t,chartsModule:n,mediaInfo:r}=e,{type:i}=r,{am4core:s,am4charts:a}=n,o=s.create(t,a.XYChart);return o.rtl=(0,d.dZ)(),"column-chart"===i&&this._createColumnChart(o,e),"bar-chart"===i&&this._createBarChart(o,e),"line-chart"===i&&this._createLineChart(o,e),o}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender()}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const{refreshInterval:t,value:n}=e;if(!t)return;const r=6e4*t;this._updateMediaInfoTimestamp(n.sourceURL);const i=setInterval((()=>{this._updateMediaInfoTimestamp(n.sourceURL)}),r);this._refreshTimer=i}_getImageSource(e,t){const n=-1!==e.indexOf("?")?"&":"?",[r,i=""]=e.split("#");return`${r}${n}timestamp=${t}${i?"#":""}${i}`}};(0,r._)([(0,s.B)("viewModel.attributes")],de.prototype,"attributes",void 0),(0,r._)([(0,s.B)("viewModel.activeMediaInfoIndex")],de.prototype,"activeMediaInfoIndex",void 0),(0,r._)([(0,s.B)("viewModel.fieldInfoMap")],de.prototype,"fieldInfoMap",void 0),(0,r._)([(0,s.B)("viewModel.layer")],de.prototype,"layer",void 0),(0,r._)([(0,s.B)("viewModel.mediaInfos")],de.prototype,"mediaInfos",void 0),(0,r._)([(0,s.B)("viewModel.popupTemplate")],de.prototype,"popupTemplate",void 0),(0,r._)([(0,s.B)("viewModel.relatedInfos")],de.prototype,"relatedInfos",void 0),(0,r._)([(0,i.Cb)({type:X.Z}),(0,h.G)(["viewModel.formattedMediaInfos","viewModel.activeMediaInfoIndex","viewModel.activeMediaInfo"])],de.prototype,"viewModel",void 0),(0,r._)([(0,i.Cb)(),(0,h.G)(),(0,u.H)("esri/widgets/Feature/t9n/Feature")],de.prototype,"messages",void 0),de=(0,r._)([(0,o.j)("esri.widgets.Feature.FeatureMedia")],de);const ue=de;var he=n(45598),fe=n(22020);const pe="esri-feature__content-element",me={title:!0,content:!0,lastEditedInfo:!0};let ge=class extends((0,fe.q)(p.default)){constructor(e,t){super(e,t),this._contentWidgets=[],this.graphic=null,this.defaultPopupTemplateEnabled=!1,this.label=void 0,this.messages=null,this.messagesURIUtils=null,this.spatialReference=null,this.title=null,this.visibleElements={...me},this.map=null,this.view=null,this.viewModel=new he.Z}initialize(){this.own((0,c.init)(this,"viewModel.contentViewModels",(()=>this._setupContentWidgets())))}destroy(){this._destroyContentWidgets()}castVisibleElements(e){return{...me,...e}}render(){const{waitingForContent:e}=this.viewModel;return(0,f.j)("div",{class:this.classes("esri-feature","esri-widget")},(0,f.j)("div",{class:"esri-feature__size-container"},this.renderTitle(),e?this.renderLoading():this.renderContentContainer()))}setActiveMedia(e,t){this.viewModel.setActiveMedia(e,t)}nextMedia(e){this.viewModel.nextMedia(e)}previousMedia(e){this.viewModel.previousMedia(e)}renderLoading(){return(0,f.j)("div",{key:"loading-container",class:"esri-feature__loading-container"},(0,f.j)("span",{class:this.classes("esri-icon-loading-indicator esri-rotating","esri-feature__loading-spinner")}))}renderContentContainer(){const{visibleElements:e}=this;return e.content?(0,f.j)("div",{class:"esri-feature__main-container"},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:e,title:t}=this;return e.title?(0,f.j)("h4",{class:"esri-feature__title",innerHTML:t}):null}renderContent(){const e=this.viewModel.content;if(!e)return null;if(Array.isArray(e))return e.length?(0,f.j)("div",{key:"content-content-elements"},e.map(this.renderContentElement,this)):null;if("string"==typeof e){const e=this._contentWidgets[0];return!e||e.destroyed?null:(0,f.j)("div",{key:"content-content"},e.render())}return this.renderNodeContent(e)}renderContentElement(e,t){const{visibleElements:n}=this;if("boolean"!=typeof n.content&&!n.content[e.type])return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);default:return null}}renderAttachments(e){const t=this._contentWidgets[e];if(!t||t.destroyed)return null;const{state:n,attachmentInfos:r}=t.viewModel;return"loading"===n||r.length>0?(0,f.j)("div",{key:this._buildKey("attachments-element",e),class:this.classes("esri-feature__attachments",pe)},(0,f.j)("h2",null,this.messages.attach),t.render()):null}renderCustom(e,t){const{creator:n}=e,r=this._contentWidgets[t];return!r||r.destroyed?null:n?(0,f.j)("div",{key:this._buildKey("custom-element",t),class:pe},r.render()):null}renderFields(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:(0,f.j)("div",{key:this._buildKey("fields-element",e),class:pe},t.render())}renderMedia(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:(0,f.j)("div",{key:this._buildKey("media-element",e),class:pe},t.render())}renderLastEditInfo(){const{visibleElements:e,messages:t}=this,{lastEditInfo:n}=this.viewModel;if(!n||!e.lastEditedInfo)return null;const{date:r,user:i}=n,s="edit"===n.type?i?t.lastEditedByUser:t.lastEdited:i?t.lastCreatedByUser:t.lastCreated,a=(0,l.n)(s,{date:r,user:i});return(0,f.j)("div",{key:"edit-info-element",class:this.classes("esri-feature__last-edited-info",pe)},a)}renderText(e,t){const n=e.text,r=this._contentWidgets[t];return!r||r.destroyed?null:n?(0,f.j)("div",{key:this._buildKey("text-element",t),class:this.classes(pe,"esri-feature__text")},r.render()):null}_buildKey(e,...t){return`${e}__${this.get("viewModel.graphic.uid")||"0"}-${t.join("-")}`}_destroyContentWidgets(){this._contentWidgets.forEach((e=>{e.viewModel=null,e&&!e.destroyed&&e.destroy()})),this._contentWidgets=[]}_setupContentWidgets(){this._destroyContentWidgets();const e=this.get("viewModel.content"),{contentViewModels:t}=this.viewModel;if(Array.isArray(e))e.forEach(((e,n)=>{"attachments"===e.type&&(this._contentWidgets[n]=new P({displayType:e.displayType,viewModel:t[n]})),"fields"===e.type&&(this._contentWidgets[n]=new H({viewModel:t[n]})),"media"===e.type&&(this._contentWidgets[n]=new ue({viewModel:t[n]})),"text"===e.type&&(this._contentWidgets[n]=new z({viewModel:t[n]})),"custom"===e.type&&(this._contentWidgets[n]=new z({viewModel:t[n]}))}),this);else{const e=t[0];e&&!e.destroyed&&(this._contentWidgets[0]=new z({viewModel:e}))}this.scheduleRender()}};(0,r._)([(0,s.B)("viewModel.graphic")],ge.prototype,"graphic",void 0),(0,r._)([(0,s.B)("viewModel.defaultPopupTemplateEnabled")],ge.prototype,"defaultPopupTemplateEnabled",void 0),(0,r._)([(0,i.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],ge.prototype,"label",void 0),(0,r._)([(0,i.Cb)(),(0,h.G)(),(0,u.H)("esri/widgets/Feature/t9n/Feature")],ge.prototype,"messages",void 0),(0,r._)([(0,i.Cb)(),(0,h.G)(),(0,u.H)("esri/widgets/support/t9n/uriUtils")],ge.prototype,"messagesURIUtils",void 0),(0,r._)([(0,s.B)("viewModel.spatialReference")],ge.prototype,"spatialReference",void 0),(0,r._)([(0,s.B)("viewModel.title")],ge.prototype,"title",void 0),(0,r._)([(0,i.Cb)(),(0,h.G)()],ge.prototype,"visibleElements",void 0),(0,r._)([(0,a.p)("visibleElements")],ge.prototype,"castVisibleElements",null),(0,r._)([(0,s.B)("viewModel.map")],ge.prototype,"map",void 0),(0,r._)([(0,s.B)("viewModel.view")],ge.prototype,"view",void 0),(0,r._)([(0,i.Cb)({type:he.Z}),(0,h.G)(["viewModel.waitingForContent","viewModel.content","viewModel.lastEditInfo","viewModel.contentViewModels"])],ge.prototype,"viewModel",void 0),ge=(0,r._)([(0,o.j)("esri.widgets.Feature")],ge);const ye=ge},39498:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var r=n(56140),i=(n(95830),n(36544),n(68055),n(79881)),s=n(87566),a=(n(10923),n(57002),n(86035),n(82677)),o=n(15988),l=n(80621),c=n(77204),d=n(29209);let u=class extends((0,c.p)(a.default)){constructor(e){super(e),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add((0,l.init)(this,"creator",(e=>{this._destroyContent(),this._createContent(e)})))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:e,graphic:t,destroyer:n}=this;e&&((0,d.vD)(n,{graphic:t}).catch((()=>null)),this._set("created",null))}async _createContent(e){const{graphic:t}=this,n=(0,d.vD)(e,{graphic:t}).catch((()=>null));this._loadingPromise=n,this.notifyChange("state");const r=await n;n===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",r))}};(0,r._)([(0,i.Cb)({readOnly:!0})],u.prototype,"created",void 0),(0,r._)([(0,i.Cb)()],u.prototype,"creator",void 0),(0,r._)([(0,i.Cb)()],u.prototype,"destroyer",void 0),(0,r._)([(0,i.Cb)({type:o.Z})],u.prototype,"graphic",void 0),(0,r._)([(0,i.Cb)({readOnly:!0})],u.prototype,"state",null),u=(0,r._)([(0,s.j)("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],u);const h=u},54881:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(56140),i=(n(95830),n(36544),n(68055),n(79881)),s=n(87566),a=(n(10923),n(57002),n(86035),n(82677)),o=n(20628),l=n(7417),c=n(29209);let d=class extends a.default{constructor(e){super(e),this.attributes=null,this.expressionInfos=null,this.fieldInfos=null}get formattedFieldInfos(){const{expressionInfos:e,fieldInfos:t}=this,n=[];return null==t||t.forEach((t=>{if(t.hasOwnProperty("visible")&&!t.visible)return;const r=t.clone();r.label=(0,c.JD)(r,e),n.push(r)})),n}};(0,r._)([(0,i.Cb)()],d.prototype,"attributes",void 0),(0,r._)([(0,i.Cb)({type:[l.Z]})],d.prototype,"expressionInfos",void 0),(0,r._)([(0,i.Cb)({type:[o.default]})],d.prototype,"fieldInfos",void 0),(0,r._)([(0,i.Cb)({readOnly:!0,dependsOn:["expressionInfos","fieldInfos"]})],d.prototype,"formattedFieldInfos",null),d=(0,r._)([(0,s.j)("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],d);const u=d},36861:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var r=n(56140),i=(n(95830),n(36544),n(68055),n(79881)),s=n(87566),a=(n(10923),n(57002),n(86035),n(82677)),o=n(20628),l=n(62813),c=n(29209),d=n(47873);let u=class extends a.default{constructor(e){super(e),this.activeMediaInfoIndex=0,this.attributes=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(e){this._setContentElementMedia(e)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(e){const{formattedMediaInfoCount:t}=this,n=(e+t)%t;this.activeMediaInfoIndex=n}_pageContentElementMedia(e){const{activeMediaInfoIndex:t}=this,n=t+e;this._setContentElementMedia(n)}_formatMediaInfos(){const{attributes:e,mediaInfos:t,formattedAttributes:n,fieldInfoMap:r,layer:i}=this,s={...n,...e};return null==t?void 0:t.map((t=>{if(!t)return null;const a=t.title?(0,c.f5)(t.title,s,i):"";t.title=a?(0,c.ar)({formattedAttributes:n,template:a,fieldInfoMap:r}):"";const o=t.caption?(0,c.f5)(t.caption,s,i):"";t.caption=o?(0,c.ar)({formattedAttributes:n,template:o,fieldInfoMap:r}):"";const l=t.altText?(0,c.f5)(t.altText,s,i):"";if(t.altText=l?(0,c.ar)({formattedAttributes:n,template:l,fieldInfoMap:r}):"","image"===t.type){const{value:e}=t;return this._setImageValue({value:e,formattedAttributes:n,layer:i}),t.value.sourceURL?t:void 0}if("pie-chart"===t.type||"line-chart"===t.type||"column-chart"===t.type||"bar-chart"===t.type){const{value:r}=t;return this._setChartValue({value:r,chartType:t.type,attributes:e,formattedAttributes:n,layer:i}),t}return null})).filter(Boolean)}_setImageValue(e){const{fieldInfoMap:t}=this,{value:n,formattedAttributes:r,layer:i}=e,{linkURL:s,sourceURL:a}=n;if(a){const e=(0,c.Qu)(a,i);n.sourceURL=(0,c.ar)({formattedAttributes:r,template:e,fieldInfoMap:t})}if(s){const e=(0,c.Qu)(s,i);n.linkURL=(0,c.ar)({formattedAttributes:r,template:e,fieldInfoMap:t})}}_setChartValue(e){const{value:t,attributes:n,formattedAttributes:r,chartType:i,layer:s}=e,{popupTemplate:a,relatedInfos:o}=this,{fields:l,normalizeField:d}=t;if(t.fields=(0,c.iJ)(l,s),d&&(t.normalizeField=(0,c.k6)(d,s)),!l.some((e=>!!(null!=r[e]||(0,c.oM)(e)&&o.size))))return;const u=null==a?void 0:a.fieldInfos;l.forEach((e=>{if((0,c.oM)(e))return void(t.series=[...t.series,...this._getRelatedChartInfos({fieldInfos:u,fieldName:e,formattedAttributes:r,chartType:i,value:t})]);const s=this._getChartOption({value:t,attributes:n,chartType:i,formattedAttributes:r,fieldName:e,fieldInfos:u});t.series.push(s)}))}_getRelatedChartInfos(e){var t;const{fieldInfos:n,fieldName:r,formattedAttributes:i,chartType:s,value:a}=e,o=[],l=(0,d.Bt)(r),{layerId:c,fieldName:u}=l,h=null==(t=this.relatedInfos)?void 0:t.get(c.toString());if(!h)return o;const{relatedFeatures:f,relation:p}=h;if(!p||!f)return o;const{cardinality:m}=p;return f.forEach((e=>{const{attributes:t}=e;t&&Object.keys(t).forEach((e=>{e===u&&o.push(this._getChartOption({value:a,attributes:t,formattedAttributes:i,fieldName:r,chartType:s,relatedFieldName:e,fieldInfos:n}))}))})),"one-to-many"===m||"many-to-many"===m?o:[o[0]]}_getTooltip({label:e,value:t,chartType:n}){return"pie-chart"===n?e:`${e}: ${t}`}_getChartOption(e){var t;const{value:n,attributes:r,formattedAttributes:i,fieldName:s,relatedFieldName:a,fieldInfos:u,chartType:h}=e,{layer:f}=this,{normalizeField:p,tooltipField:m}=n,g=p?(0,c.oM)(p)?r[(0,d.Bt)(p).fieldName]:r[p]:null,y=a&&void 0!==r[a]?r[a]:void 0!==r[s]?r[s]:i[s],b=void 0===y?null:y&&g?y/g:y,v=new l.Z({value:b});if((0,c.oM)(s)){const e=(0,d.Bt)(s),t=(0,d.Bt)(m),n=t?t.fieldName:null,i=(0,c.P_)(b,{fieldInfos:u,fieldName:a,layer:f,preventPlacesFormatting:!!g}),o=e?e.label||e.fieldName:a,l=n&&void 0!==r[n]?r[n]:o;return v.tooltip=this._getTooltip({label:l,value:i,chartType:h}),v}const _=(0,c._R)(u,s),w=(0,c.k6)(s,f),I=m&&void 0!==i[m]?i[m]:(0,c.JD)(_||new o.default({fieldName:w}),null==(t=this.popupTemplate)?void 0:t.expressionInfos),M=i[w];return v.tooltip=this._getTooltip({label:I,value:M,chartType:h}),v}};(0,r._)([(0,i.Cb)()],u.prototype,"activeMediaInfoIndex",void 0),(0,r._)([(0,i.Cb)({readOnly:!0,dependsOn:["formattedMediaInfos","activeMediaInfoIndex"]})],u.prototype,"activeMediaInfo",null),(0,r._)([(0,i.Cb)()],u.prototype,"attributes",void 0),(0,r._)([(0,i.Cb)()],u.prototype,"fieldInfoMap",void 0),(0,r._)([(0,i.Cb)()],u.prototype,"formattedAttributes",void 0),(0,r._)([(0,i.Cb)({readOnly:!0,dependsOn:["attributes","fieldInfoMap","formattedAttributes","mediaInfos","popupTemplate","layer","relatedInfos"]})],u.prototype,"formattedMediaInfos",null),(0,r._)([(0,i.Cb)()],u.prototype,"layer",void 0),(0,r._)([(0,i.Cb)({readOnly:!0,dependsOn:["formattedMediaInfos"]})],u.prototype,"formattedMediaInfoCount",null),(0,r._)([(0,i.Cb)()],u.prototype,"mediaInfos",void 0),(0,r._)([(0,i.Cb)()],u.prototype,"popupTemplate",void 0),(0,r._)([(0,i.Cb)()],u.prototype,"relatedInfos",void 0),u=(0,r._)([(0,s.j)("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],u);const h=u},45598:(e,t,n)=>{"use strict";n.d(t,{Z:()=>T});var r=n(56140),i=(n(95830),n(59472)),s=n(36544),a=(n(68055),n(79881)),o=n(87566),l=(n(10923),n(57002),n(86035),n(39105)),c=n(82677),d=n(75107),u=n(15988),h=n(59691),f=n(80621),p=n(69065),m=n(29209),g=n(95627),y=n(39498),b=n(54881),v=n(47873),_=n(36861);const w=["$datastore","$map","$layer"],I=s.Z.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");async function M({expressionAttributes:e,info:t,arcadeUtils:n,spatialReference:r,map:i,graphic:s}){const a=`expression/${t.name}`,o=n.createSyntaxTree(t.expression),l=w.filter((e=>n.hasVariable(o,e)));await n.loadScriptDependencies(o,!0,l);const c=n.getViewInfo({spatialReference:r}),d=n.createExecContext(s,c);d.useAsync=!0,function({arcadeUtils:e,featureSetVars:t,context:n,viewInfo:r,map:i,graphic:s}){t.forEach((t=>{const a=t.toLowerCase(),o={map:i,spatialReference:r.sr};"$map"===a&&(n.vars[a]=e.convertMapToFeatureSetCollection(o)),"$layer"===a&&(n.vars[a]=e.convertFeatureLayerToFeatureSet(s.sourceLayer,r.sr)),"$datastore"===a&&(n.vars[a]=e.convertServiceUrlToWorkspace(s.sourceLayer.url,r.sr))}))}({arcadeUtils:n,featureSetVars:l,context:d,viewInfo:c,map:i,graphic:s});const u=n.createFunction(o,d),h=await n.executeAsyncFunction(u,d).catch((e=>I.error("arcade-execution-error",{error:e,graphic:s,expressionInfo:t})));var f;e[a]="string"==typeof h?(0,m.qD)((0,m.M3)(h)):Array.isArray(h)?function(e){return`<ul class="esri-widget__list">${e.map((e=>`<li>${"string"==typeof e?(0,m.qD)((0,m.M3)(e)):e}</li>`)).join("")}</ul>`}(h):h&&"esri.arcade.Dictionary"===h.declaredClass?`<table class="esri-widget__table">${(f=h).keys().map((e=>{const t=f.field(e);return`<tr><th>${e}</th><td>${"string"==typeof t?(0,m.qD)((0,m.M3)(t)):t}</td></tr>`})).join("")}</table>`:h}async function C({popupTemplate:e,spatialReference:t,graphic:r,map:i}){const s=e.expressionInfos,a=[],o={};if(!s||!s.length)return o;const c=await n.e(7299).then(n.bind(n,67299));for(const e of s)a.push(M({expressionAttributes:o,info:e,arcadeUtils:c,spatialReference:t,map:i,graphic:r}));return await(0,l.eachAlways)(a),o}const A=s.Z.getLogger("esri.widgets.FeatureViewModel");let F=class extends c.default{constructor(e){super(e),this._handles=new h.Z,this._featureAbortController=null,this.graphicChangedThrottled=(0,p.P)(this.graphicChanged,1,this),this.content=null,this.contentViewModels=[],this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._handles.add((0,f.init)(this,["graphic","_effectivePopupTemplate"],(()=>this.graphicChangedThrottled())))}destroy(){this._clear(),this._cancelFeatureQuery(),this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return(0,i.pC)(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return(0,m.cT)((0,m.Hs)(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return(0,m.l$)(this.graphic)}set graphic(e){this._set("graphic",e?e.clone():null)}get spatialReference(){return this.get("view.spatialReference")||null}set spatialReference(e){void 0!==e?this._override("spatialReference",e):this._clearOverride("spatialReference")}get map(){return this.get("view.map")||null}set map(e){void 0!==e?this._override("map",e):this._clearOverride("map")}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(e,t){const n=this.contentViewModels[e];n instanceof _.Z&&n.setActiveMedia(t)}nextMedia(e){const t=this.contentViewModels[e];t instanceof _.Z&&t.next()}previousMedia(e){const t=this.contentViewModels[e];t instanceof _.Z&&t.previous()}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}async graphicChanged(){this._cancelFeatureQuery(),this._clear();const{graphic:e}=this;if(!e)return;const t=(0,l.createAbortController)();this._featureAbortController=t;try{await this._queryFeature({signal:t.signal})}catch(t){A.error("error","error loading popupTemplate for graphic",{error:t,graphic:e})}this._featureAbortController===t&&(this._featureAbortController=null)}_cancelFeatureQuery(){const{_featureAbortController:e}=this;e&&e.abort(),this._featureAbortController=null}_compileContent(e){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.map(((e,t)=>"attachments"===e.type?this._compileAttachments(e,t):"custom"===e.type?this._compileCustom(e,t):"fields"===e.type?this._compileFields(e,t):"media"===e.type?this._compileMedia(e,t):"text"===e.type?this._compileText(e,t):void 0)):"string"==typeof e?this._compileText(new d.Z({text:e}),0).text:e}_destroyContentViewModels(){this.contentViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("contentViewModels",[])}_compileAttachments(e,t){const{graphic:n}=this;return this.contentViewModels[t]=new g.Z({graphic:n}),e}_compileCustom(e,t){const{graphic:n}=this,{creator:r,destroyer:i}=e;return this.contentViewModels[t]=new y.Z({graphic:n,creator:r,destroyer:i}),e}_compileFields(e,t){const{_effectivePopupTemplate:n,formattedAttributes:r}=this,i=e.clone(),s=(null==e?void 0:e.fieldInfos)||(null==n?void 0:n.fieldInfos),a=null==n?void 0:n.expressionInfos,o={...r.global,...r.content[t]},l=new b.Z({attributes:o,expressionInfos:a,fieldInfos:s});return this.contentViewModels[t]=l,i.fieldInfos=l.formattedFieldInfos.slice(0),i}_compileMedia(e,t){const{graphic:n,_fieldInfoMap:r,_effectivePopupTemplate:i,relatedInfos:s,_sourceLayer:a}=this,{attributes:o}=n,l=this.formattedAttributes.global,c=e.clone(),{mediaInfos:d}=c,u=new _.Z({activeMediaInfoIndex:c.activeMediaInfoIndex||0,attributes:o,layer:a,fieldInfoMap:r,formattedAttributes:l,mediaInfos:d,popupTemplate:i,relatedInfos:s});return c.mediaInfos=u.formattedMediaInfos.slice(0),this.contentViewModels[t]=u,c}_compileText(e,t){const n=e.clone(),{graphic:r,_fieldInfoMap:i,_sourceLayer:s}=this;if(n&&n.text){const{attributes:e}=r,t=this.formattedAttributes.global,a=(0,m.f5)(n.text,{...t,...e},s);n.text=(0,m.ar)({formattedAttributes:t,template:a,fieldInfoMap:i})}return this.contentViewModels[t]=new y.Z({graphic:r,creator:n.text}),n}_compileLastEditInfo(){const{_effectivePopupTemplate:e,_sourceLayer:t,graphic:n}=this;if(!e)return;const{lastEditInfoEnabled:r}=e,i=null==t?void 0:t.editFieldsInfo;return r&&i?(0,m.Tj)(i,n.attributes):void 0}_compileTitle(e){const{_fieldInfoMap:t,_sourceLayer:n,graphic:r}=this,{attributes:i}=r,s=this.formattedAttributes.global;if(e){const r=(0,m.f5)(e,{...s,...i},n);return(0,m.ar)({formattedAttributes:s,template:r,fieldInfoMap:t})}return""}async _getTitle(){const{_effectivePopupTemplate:e,graphic:t}=this,n=null==e?void 0:e.title;return(0,m.vD)(n,{graphic:t})}async _getContent(){const{_effectivePopupTemplate:e,graphic:t}=this,n=null==e?void 0:e.content;return(0,m.vD)(n,{graphic:t})}async _queryFeature(e){const{_featureAbortController:t,_sourceLayer:n,graphic:r,_effectivePopupTemplate:i,spatialReference:s,map:a}=this,{content:{value:o},title:{value:c}}=await(0,l.eachAlways)({content:this._getContent(),title:this._getTitle()});if(t!==this._featureAbortController||!r)return;const{expressionAttributes:{value:d}}=await(0,l.eachAlways)({checkForRelatedFeatures:this._checkForRelatedFeatures(e),expressionAttributes:C({popupTemplate:this._effectivePopupTemplate,spatialReference:s,graphic:r,map:a}),queryUpdatedFeature:(0,m.Xh)({graphic:r,popupTemplate:i,layer:n},e)});t===this._featureAbortController&&r&&(this._set("formattedAttributes",this._createFormattedAttributes(o,d)),this._set("title",this._compileTitle(c)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(o)||null))}_createFormattedAttributes(e,t){const{_effectivePopupTemplate:n,graphic:r,relatedInfos:i,_sourceLayer:s,_fieldInfoMap:a}=this,o=null==n?void 0:n.fieldInfos,l={...r.attributes,...t},c={global:(0,m.uI)({fieldInfos:o,graphic:r,attributes:l,layer:s,fieldInfoMap:a,relatedInfos:i}),content:[]};return Array.isArray(e)&&e.forEach(((e,t)=>{"fields"===e.type&&e.fieldInfos&&(c.content[t]=(0,m.uI)({fieldInfos:e.fieldInfos,graphic:r,attributes:l,layer:s,fieldInfoMap:a,relatedInfos:i}))})),c}_checkForRelatedFeatures(e){const{graphic:t,_effectivePopupTemplate:n}=this;return this._queryRelatedInfos(t,(0,m.Hs)(n),e)}async _queryRelatedInfos(e,t,n){const{relatedInfos:r,_sourceLayer:s}=this;r.clear();const a=(0,i.pC)(s.associatedLayer)?await s.associatedLayer.load(n):s;if(!a)return;const o=t.filter((e=>e&&(0,m.oM)(e.fieldName)));if(!o||!o.length)return;t.forEach((e=>this._configureRelatedInfo(e,a)));const l=await(0,v.Vb)({relatedInfos:r,layer:a},n);Object.keys(l).forEach((e=>{var t;const n=r.get(e.toString()),i=null==(t=l[e])?void 0:t.value;n&&i&&(n.layerInfo=i.data)}));const c=await(0,v.kp)({graphic:e,relatedInfos:r,layer:a},n);Object.keys(c).forEach((e=>{var t;(0,v.lg)(null==(t=c[e])?void 0:t.value,r.get(e.toString()))}))}_configureRelatedInfo(e,t){const{relatedInfos:n}=this,r=(0,v.Bt)(e.fieldName);if(!r)return;const{layerId:i,fieldName:s}=r;if(!i)return;const a=n.get(i.toString())||(0,v.uc)(i,t);a&&((0,v.NF)({relatedInfo:a,fieldName:s,fieldInfo:e}),this.relatedInfos.set(i,a))}};(0,r._)([(0,a.Cb)()],F.prototype,"_featureAbortController",void 0),(0,r._)([(0,a.Cb)({readOnly:!0,dependsOn:["graphic","graphic.sourceLayer.popupTemplate.title","graphic.sourceLayer.popupTemplate.content","graphic.sourceLayer.popupTemplate.expressionInfos","graphic.sourceLayer.popupTemplate.fieldInfos","graphic.sourceLayer.popupTemplate.lastEditInfoEnabled","graphic.sourceLayer.popupTemplate.outFields","graphic.sourceLayer.popupTemplate.relatedRecordsInfo","graphic.popupTemplate.title","graphic.popupTemplate.content","graphic.popupTemplate.expressionInfos","graphic.popupTemplate.fieldInfos","graphic.popupTemplate.lastEditInfoEnabled","graphic.popupTemplate.outFields","graphic.popupTemplate.relatedRecordsInfo","defaultPopupTemplateEnabled"]})],F.prototype,"_effectivePopupTemplate",null),(0,r._)([(0,a.Cb)({readOnly:!0,dependsOn:["_effectivePopupTemplate","_sourceLayer"]})],F.prototype,"_fieldInfoMap",null),(0,r._)([(0,a.Cb)({readOnly:!0,dependsOn:["graphic.layer","graphic.sourceLayer"]})],F.prototype,"_sourceLayer",null),(0,r._)([(0,a.Cb)({readOnly:!0})],F.prototype,"content",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],F.prototype,"contentViewModels",void 0),(0,r._)([(0,a.Cb)({type:Boolean})],F.prototype,"defaultPopupTemplateEnabled",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],F.prototype,"formattedAttributes",void 0),(0,r._)([(0,a.Cb)({type:u.Z,value:null})],F.prototype,"graphic",null),(0,r._)([(0,a.Cb)({readOnly:!0})],F.prototype,"lastEditInfo",void 0),(0,r._)([(0,a.Cb)()],F.prototype,"relatedInfos",void 0),(0,r._)([(0,a.Cb)({dependsOn:["view"]})],F.prototype,"spatialReference",null),(0,r._)([(0,a.Cb)({readOnly:!0})],F.prototype,"title",void 0),(0,r._)([(0,a.Cb)({dependsOn:["view"]})],F.prototype,"map",null),(0,r._)([(0,a.Cb)({readOnly:!0,dependsOn:["_featureAbortController"]})],F.prototype,"waitingForContent",null),(0,r._)([(0,a.Cb)()],F.prototype,"view",void 0),F=(0,r._)([(0,o.j)("esri.widgets.FeatureViewModel")],F);const T=F},22020:(e,t,n)=>{"use strict";n.d(t,{q:()=>o});var r=n(56140),i=(n(95830),n(36544),n(68055),n(79881),n(87566)),s=(n(10923),n(57002),n(86035),n(19401)),a=n(73502);const o=e=>{let t=class extends e{constructor(){super(...arguments),this.renderNodeContent=e=>(0,a.isWidget)(e)&&!e.destroyed?(0,s.j)("div",{key:e},e.render()):e instanceof HTMLElement?(0,s.j)("div",{key:e,bind:e,afterCreate:this._attachToNode}):(0,a.hasDomNode)(e)?(0,s.j)("div",{key:e,bind:e.domNode,afterCreate:this._attachToNode}):null}_attachToNode(e){e.appendChild(this)}};return t=(0,r._)([(0,i.j)("esri.widgets.Feature.ContentMixin")],t),t}},29209:(e,t,n)=>{"use strict";n.d(t,{qD:()=>O,cT:()=>N,Qu:()=>k,uI:()=>S,Tj:()=>$,P_:()=>L,Hs:()=>R,_R:()=>E,JD:()=>C,k6:()=>A,iJ:()=>F,l$:()=>w,vD:()=>I,M3:()=>P,oM:()=>G,f5:()=>Z,Xh:()=>q,or:()=>M,ar:()=>j});var r=n(59472),i=n(88263),s=n(36544),a=n(32656),o=n(4665),l=n(21979),c=n(17427),d=n(52117);n(89771);const u=s.Z.getLogger("esri.widgets.Feature.support.featureUtils"),h=/href=(""|'')/gi,f=/(\{([^\{\r\n]+)\})/g,p=/\'/g,m=/^\s*expression\//i,g=/(\n)/gi,y=/[\u00A0-\u9999<>\&]/gim,b=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,v=/^(?:mailto:|tel:)/,_=(0,l.Ze)("short-date-short-time");function w(e){if(!(0,r.Wi)(e))return e.get("sourceLayer")||e.get("layer")}async function I(e,t){return"function"==typeof e?e.call(null,t):e}function M(e=""){if(e)return!v.test(e.trim().toLowerCase())}function C(e,t){const n=function(e,t){if(!function(e){return m.test(e)}(t)||!e)return null;const n=t.replace(m,"").toLowerCase();let r;return e.some((e=>e.name.toLowerCase()===n&&(r=e,!0))),r}(t,null==e?void 0:e.fieldName);return n?n.title||null:e?e.label||e.fieldName:null}function A(e,t){const n=T(t,e);return n?n.name:e}function F(e,t){return e&&e.map((e=>A(e,t)))}function T(e,t){return e&&"function"==typeof e.getField?e.getField(t):null}function x(e){return`${e}`.trim()}function j({formattedAttributes:e,template:t,fieldInfoMap:n}){return x((0,i.gx)((0,i.gx)(t,(e=>function(e,t){const n=t.get(e.toLowerCase());return`{${n&&n.fieldName||e}}`}(e,n))),e).replace(h,""))}function k(e,t){return e.replace(f,((e,n,r)=>{const i=T(t,r);return i?`{${i.name}}`:n}))}function Z(e,t,n){const r=k(e,n);return r?r.replace(b,((e,n,r)=>function(e,t,n){const r=(t=x(t))&&"{"!==t[0];return(0,i.gx)(e,function(e,t=!1){const n={...e};return Object.keys(n).forEach((e=>function(e,t,n=!1){const r=t[e];if("string"==typeof r){const i="%27",s=(n?encodeURIComponent(r):r).replace(p,i);t[e]=s}}(e,n,t))),n}(n,r))}(e,n||r,t))):r}function L(e,t){const n=t.fieldInfos,r=t.fieldName,i=E(n,r),s=null==i?void 0:i.clone(),a=t.preventPlacesFormatting,o=T(t.layer,r);if(s&&o&&"date"===o.type){const e=s.format||new d.Z;e.dateFormat=e.dateFormat||"short-date-short-time",s.format=e}const l=s&&s.format;return"string"==typeof(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){const t=Number(e);if(!isNaN(t))return t}return e}(e,l))||null==e||null==l?e:a?(0,c.uf)(e,{...(0,c.sh)(l),minimumFractionDigits:0,maximumFractionDigits:20}):l.format(e)}function E(e,t){if(!e||!e.length||!t)return;const n=t.toLowerCase();let r;return e.some((e=>!(!e.fieldName||e.fieldName.toLowerCase()!==n||(r=e,0)))),r}function $(e,t){const{creatorField:n,creationDateField:r,editorField:i,editDateField:s}=e;if(!t)return;const a=t[s];if("number"==typeof a){const e=t[i];return{type:"edit",date:(0,l.p6)(a,_),user:e}}const o=t[r];if("number"==typeof o){const e=t[n];return{type:"create",date:(0,l.p6)(o,_),user:e}}return null}function N(e,t){const n=new Map;return e&&e.forEach((e=>{const r=A(e.fieldName,t);e.fieldName=r,n.set(r.toLowerCase(),e)})),n}function R(e){const t=[];if(!e)return t;const{fieldInfos:n,content:r}=e;return n&&t.push(...n),r&&Array.isArray(r)?(r.forEach((e=>{if("fields"===e.type){const n=e&&e.fieldInfos;n&&t.push(...n)}})),t):t}function P(e){return e.replace(y,(e=>`&#${e.charCodeAt(0)};`))}function O(e){return"string"==typeof e?e.replace(g,'<br class="esri-text-new-line" />'):e}function S({fieldInfos:e,attributes:t,layer:n,graphic:r,fieldInfoMap:i,relatedInfos:s}){const a={...t};return null==s||s.forEach((e=>function(e,t){e&&t&&(t.relatedFeatures&&t.relatedFeatures&&t.relatedFeatures.forEach((n=>z({attributes:e,graphic:n,relatedInfo:t}))),t.relatedStatsFeatures&&t.relatedStatsFeatures&&t.relatedStatsFeatures.forEach((n=>z({attributes:e,graphic:n,relatedInfo:t}))))}(a,e))),Object.keys(a).forEach((t=>{const s=a[t];a[t]=function(e){const{value:t,fieldName:n,fieldInfos:r,fieldInfoMap:i,layer:s,graphic:a}=e;if(null==t)return"";const o=function({fieldName:e,value:t,graphic:n,layer:r}){if(G(e))return null;if(!r||"function"!=typeof r.getFieldDomain)return null;const i=r.getFieldDomain(e,{feature:n});return i&&"coded-value"===i.type?i.getName(t):null}({fieldName:n,value:t,graphic:a,layer:s});if(o)return o;const c=function({fieldName:e,graphic:t,layer:n}){if(G(e))return null;if(!n||"function"!=typeof n.getFeatureType)return null;const{typeIdField:r}=n;if(!r||e!==r)return null;const i=n.getFeatureType(t);return i?i.name:null}({fieldName:n,graphic:a,layer:s});if(c)return c;if(i.get(n.toLowerCase()))return L(t,{fieldInfos:r,fieldName:n,layer:s});const d=s&&s.fieldsIndex;return d&&d.isDateField(n)?(0,l.p6)(t,_):O(t)}({fieldName:t,fieldInfos:e,fieldInfoMap:i,layer:n,value:s,graphic:r})})),a}async function q({graphic:e,popupTemplate:t,layer:n},r){if(!n||!t)return;const{returnGeometry:i}=t;"function"==typeof n.load&&await n.load(r);const s=e.attributes[n.objectIdField];if(null==s)return;const l=[s],c=await t.getRequiredFields(n.fields),d=(0,o.R9)(c,e),h=d?[]:c;if(d&&!i)return;const f=await async function(e,t){const{layer:n,graphic:r,outFields:i,objectIds:s,returnGeometry:o}=e,l=s[0];if("number"!=typeof l){const e="Could not query required fields for the specified feature. The feature's ID is invalid.",t={layer:n,graphic:r,objectId:l,requiredFields:i},s=new a.Z("layer-query-features-invalid-objectid",e,t);throw u.warn(e,t),s}if("function"!=typeof n.queryFeatures){const e="The specified layer does not support the method 'queryFeatures'. The following fields will not be available.",t={layer:n,graphic:r,requiredFields:i},s=new a.Z("layer-query-features-unsupported",e,t);throw u.warn(e,t),s}const c=n.createQuery();return c.objectIds=s,c.outFields=i,c.returnGeometry=!!o,(await n.queryFeatures(c,t)).features[0]}({layer:n,graphic:e,outFields:h,objectIds:l,returnGeometry:i},r);f&&(f.geometry&&(e.geometry=f.geometry),f.attributes&&(e.attributes={...e.attributes,...f.attributes}))}function G(e=""){return!!e&&-1!==e.indexOf("relationships/")}function z({attributes:e,graphic:t,relatedInfo:n}){e&&t&&n&&Object.keys(t.attributes).forEach((r=>{const i=(s={layerId:n.relation.id.toString(),fieldName:r})?`relationships/${s.layerId}/${s.fieldName}`:"";var s;e[i]=t.attributes[r]}))}},47873:(e,t,n)=>{"use strict";n.d(t,{uc:()=>m,Bt:()=>p,Vb:()=>y,kp:()=>b,lg:()=>g,NF:()=>v});var r=n(36544),i=n(32656),s=n(39105),a=n(4665),o=n(54721),l=n(20624),c=n(31518),d=n(92551),u=n(29209);const h=r.Z.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),f=new Map;function p(e){if(!(0,u.oM)(e))return null;const[t,n]=e.split("/").slice(1);return{layerId:t,fieldName:n}}function m(e,t){const n=function(e,t){if(!t.relationships)return null;let n=null;const{relationships:r}=t;return r.some((t=>t.id===parseInt(e,10)&&(n=t,!0))),n}(e,t);if(!n)return;const r=`${t.url}/${n.relatedTableId}`;return{url:r,queryTask:new d.Z({url:r,sourceSpatialReference:t.spatialReference}),relation:n,relatedFields:[],outStatistics:[]}}function g(e,t){if(!t)return;if(!e)return;const{features:n,statsFeatures:r}=e,i=n&&n.value;t.relatedFeatures=i?i.features:[];const s=r&&r.value;t.relatedStatsFeatures=s?s.features:[]}function y({relatedInfos:e,layer:t},n){const r={};return e.forEach(((e,s)=>{const{relation:a}=e;if(!a){const e=new i.Z("relation-required","A relation is required on a layer to retrieve related records.");throw h.error(e),e}const{relatedTableId:l}=a;if("number"!=typeof l){const e=new i.Z("A related table ID is required on a layer to retrieve related records.");throw h.error(e),e}const c=`${t.url}/${l}`,d=f.get(c),u=d||function(e,t){return(0,o.default)(e,{query:{f:"json"},signal:t&&t.signal})}(c,n);d||f.set(c,u),r[s]=u})),(0,s.eachAlways)(r)}function b({graphic:e,relatedInfos:t,layer:n},r){const i={};return t.forEach(((t,o)=>{t.layerInfo&&(i[o]=async function(e,t,n,r){var i;const o=n.layerId.toString(),{layerInfo:l,queryTask:d,relation:u}=t,h=null==(i=function({originRelationship:e,relationships:t,layerId:n}){let r;return t&&t.some((t=>(`${t.relatedTableId}`===n&&t.id===e.id&&(r=t),!!r))),r}({originRelationship:u,relationships:l.relationships,layerId:o}))?void 0:i.keyField;if(h){const n=(0,a.H7)((0,a.rz)(l.fields,h)),i=function(e,t){const n=t.toLowerCase();for(const t in e)if(t.toLowerCase()===n)return e[t];return null}(e.attributes,u.keyField),o=n?`${h}=${i}`:`${h}='${i}'`,f=d.execute(new c.Z({where:o,outFields:t.relatedFields}),r),p=t.outStatistics&&t.outStatistics.length>0&&l.supportsStatistics?d.execute(new c.Z({where:o,outFields:t.relatedFields,outStatistics:t.outStatistics}),r):null,m={features:f};return p&&(m.statsFeatures=p),(0,s.eachAlways)(m)}return null}(e,t,n,r))})),(0,s.eachAlways)(i)}function v({relatedInfo:e,fieldName:t,fieldInfo:n}){if(e.relatedFields.push(t),n.statisticType){const r=new l.Z({statisticType:n.statisticType,onStatisticField:t,outStatisticFieldName:t});e.outStatistics.push(r)}}}}]);
//# sourceMappingURL=2406.js.map